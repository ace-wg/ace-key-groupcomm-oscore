<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Key Management for Group Object Security for Constrained RESTful Environments (Group OSCORE) Using Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Marco Tiloca" name="author">
<meta content="Francesca Palombini" name="author">
<meta content="
       This document defines an application profile of the Authentication and Authorization for Constrained Environments (ACE) framework, to request and provision keying material in group communication scenarios that are based on the Constrained Application Protocol (CoAP) and are secured with Group Object Security for Constrained RESTful Environments (Group OSCORE). This application profile delegates the authentication and authorization of Clients, which join an OSCORE group through a Resource Server acting as Group Manager for that group. This application profile leverages protocol-specific transport profiles of ACE to achieve communication security, server authentication, and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 access token. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-key-groupcomm-oscore-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-ace-key-groupcomm-oscore.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Key Management for Group OSCORE Using AC</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca &amp; Palombini</td>
<td class="center">Expires 25 May 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-key-groupcomm-oscore-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11-21" class="published">21 November 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-05-25">25 May 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Key Management for Group Object Security for Constrained RESTful Environments (Group OSCORE) Using Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an application profile of the Authentication and Authorization for Constrained Environments (ACE) framework, to request and provision keying material in group communication scenarios that are based on the Constrained Application Protocol (CoAP) and are secured with Group Object Security for Constrained RESTful Environments (Group OSCORE). This application profile delegates the authentication and authorization of Clients, which join an OSCORE group through a Resource Server acting as Group Manager for that group. This application profile leverages protocol-specific transport profiles of ACE to achieve communication security, server authentication, and proof-of-possession for a key owned by the Client and bound to an OAuth 2.0 access token.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 May 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-format-of-scope" class="internal xref">Format of Scope</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-authentication-credentials" class="internal xref">Authentication Credentials</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-authorization-to-join-a-gro" class="internal xref">Authorization to Join a Group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-authorization-response" class="internal xref">Authorization Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-token-transferring" class="internal xref">Token Transferring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-ecdh_info-parameter" class="internal xref">'ecdh_info' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-kdc_dh_creds-parameter" class="internal xref">'kdc_dh_creds' Parameter</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-group-joining" class="internal xref">Group Joining</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-send-the-join-request" class="internal xref">Send the Join Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-value-of-the-n_s-challenge" class="internal xref">Value of the N_S Challenge</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-receive-the-join-request" class="internal xref">Receive the Join Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-follow-up-to-a-400-bad-requ" class="internal xref">Follow-up to a 4.00 (Bad Request) Error Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-send-the-join-response" class="internal xref">Send the Join Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-receive-the-join-response" class="internal xref">Receive the Join Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-overview-of-the-group-rekey" class="internal xref">Overview of the Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-stale-oscore-sender-ids" class="internal xref">Stale OSCORE Sender IDs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-interface-at-the-group-mana" class="internal xref">Interface at the Group Manager</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-ace-group-groupname-kdc-cre" class="internal xref">/ace-group/GROUPNAME/kdc-cred</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-fetch-handler" class="internal xref">FETCH Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-ace-group-groupname-active" class="internal xref">/ace-group/GROUPNAME/active</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-get-handler" class="internal xref">GET Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-ace-group-groupname-verif-d" class="internal xref">/ace-group/GROUPNAME/verif-data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-get-handler-2" class="internal xref">GET Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-ace-group-groupname-stale-s" class="internal xref">/ace-group/GROUPNAME/stale-sids</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-fetch-handler-2" class="internal xref">FETCH Handler</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-admitted-methods" class="internal xref">Admitted Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-signature-verifiers" class="internal xref">Signature Verifiers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-operations-supported-by-cli" class="internal xref">Operations Supported by Clients</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-additional-interactions-wit" class="internal xref">Additional Interactions with the Group Manager</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-retrieve-updated-keying-mat" class="internal xref">Retrieve Updated Keying Material</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-get-group-keying-material" class="internal xref">Get Group Keying Material</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-get-group-keying-material-a" class="internal xref">Get Group Keying Material and OSCORE Sender ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-request-to-change-individua" class="internal xref">Request to Change Individual Keying Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-retrieve-authentication-cre" class="internal xref">Retrieve Authentication Credentials of Group Members</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-upload-a-new-authentication" class="internal xref">Upload a New Authentication Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-retrieve-the-group-managers" class="internal xref">Retrieve the Group Manager's Authentication Credential</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.1">
                    <p id="section-toc.1-1.9.2.5.2.1.1"><a href="#section-9.5.1" class="auto internal xref">9.5.1</a>.  <a href="#name-retrieval-for-group-members" class="internal xref">Retrieval for Group Members</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.2">
                    <p id="section-toc.1-1.9.2.5.2.2.1"><a href="#section-9.5.2" class="auto internal xref">9.5.2</a>.  <a href="#name-retrieval-for-signature-ver" class="internal xref">Retrieval for Signature Verifiers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-retrieve-signature-verifica" class="internal xref">Retrieve Signature Verification Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-retrieve-the-group-policies" class="internal xref">Retrieve the Group Policies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="auto internal xref">9.8</a>.  <a href="#name-retrieve-the-keying-materia" class="internal xref">Retrieve the Keying Material Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-9.9" class="auto internal xref">9.9</a>.  <a href="#name-retrieve-the-group-status" class="internal xref">Retrieve the Group Status</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10">
                <p id="section-toc.1-1.9.2.10.1"><a href="#section-9.10" class="auto internal xref">9.10</a>. <a href="#name-retrieve-group-names" class="internal xref">Retrieve Group Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11">
                <p id="section-toc.1-1.9.2.11.1"><a href="#section-9.11" class="auto internal xref">9.11</a>. <a href="#name-leave-the-group" class="internal xref">Leave the Group</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-removal-of-a-group-member" class="internal xref">Removal of a Group Member</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-group-rekeying-process" class="internal xref">Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-sending-rekeying-messages" class="internal xref">Sending Rekeying Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-receiving-rekeying-messages" class="internal xref">Receiving Rekeying Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-missed-rekeying-instances" class="internal xref">Missed Rekeying Instances</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-retrieve-stale-sender-ids" class="internal xref">Retrieve Stale Sender IDs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-ace-groupcomm-parameters" class="internal xref">ACE Groupcomm Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-ace-groupcomm-error-identif" class="internal xref">ACE Groupcomm Error Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-default-values-for-group-co" class="internal xref">Default Values for Group Configuration Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-common" class="internal xref">Common</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-group-mode" class="internal xref">Group Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-pairwise-mode" class="internal xref">Pairwise Mode</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-management-of-oscore-groups" class="internal xref">Management of OSCORE Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-size-of-nonces-as-proof-of-" class="internal xref">Size of Nonces as Proof-of-Possesion Challenge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-reusage-of-nonces-for-proof" class="internal xref">Reusage of Nonces for Proof-of-Possession Input</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-oauth-parameters" class="internal xref">OAuth Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="auto internal xref">16.2</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3">
                <p id="section-toc.1-1.16.2.3.1"><a href="#section-16.3" class="auto internal xref">16.3</a>.  <a href="#name-ace-groupcomm-parameters-3" class="internal xref">ACE Groupcomm Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4">
                <p id="section-toc.1-1.16.2.4.1"><a href="#section-16.4" class="auto internal xref">16.4</a>.  <a href="#name-ace-groupcomm-key-types" class="internal xref">ACE Groupcomm Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5">
                <p id="section-toc.1-1.16.2.5.1"><a href="#section-16.5" class="auto internal xref">16.5</a>.  <a href="#name-ace-groupcomm-profiles" class="internal xref">ACE Groupcomm Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6">
                <p id="section-toc.1-1.16.2.6.1"><a href="#section-16.6" class="auto internal xref">16.6</a>.  <a href="#name-oscore-security-context-par" class="internal xref">OSCORE Security Context Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.7">
                <p id="section-toc.1-1.16.2.7.1"><a href="#section-16.7" class="auto internal xref">16.7</a>.  <a href="#name-tls-exporter-labels" class="internal xref">TLS Exporter Labels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.8">
                <p id="section-toc.1-1.16.2.8.1"><a href="#section-16.8" class="auto internal xref">16.8</a>.  <a href="#name-aif-media-type-sub-paramete" class="internal xref">AIF Media-Type Sub-Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.9">
                <p id="section-toc.1-1.16.2.9.1"><a href="#section-16.9" class="auto internal xref">16.9</a>.  <a href="#name-coap-content-formats" class="internal xref">CoAP Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.10">
                <p id="section-toc.1-1.16.2.10.1"><a href="#section-16.10" class="auto internal xref">16.10</a>. <a href="#name-core-resource-type" class="internal xref">CoRE Resource Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.11">
                <p id="section-toc.1-1.16.2.11.1"><a href="#section-16.11" class="auto internal xref">16.11</a>. <a href="#name-ace-groupcomm-errors" class="internal xref">ACE Groupcomm Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.12">
                <p id="section-toc.1-1.16.2.12.1"><a href="#section-16.12" class="auto internal xref">16.12</a>. <a href="#name-group-oscore-roles" class="internal xref">Group OSCORE Roles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.13">
                <p id="section-toc.1-1.16.2.13.1"><a href="#section-16.13" class="auto internal xref">16.13</a>. <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref">17.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref">17.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-profile-requirements" class="internal xref">Profile Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-mandatory-to-address-requir" class="internal xref">Mandatory-to-Address Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-optional-to-address-require" class="internal xref">Optional-to-Address Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-extensibility-for-future-co" class="internal xref">Extensibility for Future COSE Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-format-of-ecdh_info_entry" class="internal xref">Format of 'ecdh_info_entry'</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-format-of-key" class="internal xref">Format of 'key'</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-cddl-model" class="internal xref">CDDL Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-version-16-to-17" class="internal xref">Version -16 to -17</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-version-15-to-16" class="internal xref">Version -15 to -16</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.3">
                <p id="section-toc.1-1.21.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-version-14-to-15" class="internal xref">Version -14 to -15</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.4">
                <p id="section-toc.1-1.21.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-version-13-to-14" class="internal xref">Version -13 to -14</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.5">
                <p id="section-toc.1-1.21.2.5.1"><a href="#appendix-D.5" class="auto internal xref">D.5</a>.  <a href="#name-version-12-to-13" class="internal xref">Version -12 to -13</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.6">
                <p id="section-toc.1-1.21.2.6.1"><a href="#appendix-D.6" class="auto internal xref">D.6</a>.  <a href="#name-version-11-to-12" class="internal xref">Version -11 to -12</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.7">
                <p id="section-toc.1-1.21.2.7.1"><a href="#appendix-D.7" class="auto internal xref">D.7</a>.  <a href="#name-version-10-to-11" class="internal xref">Version -10 to -11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.8">
                <p id="section-toc.1-1.21.2.8.1"><a href="#appendix-D.8" class="auto internal xref">D.8</a>.  <a href="#name-version-09-to-10" class="internal xref">Version -09 to -10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.9">
                <p id="section-toc.1-1.21.2.9.1"><a href="#appendix-D.9" class="auto internal xref">D.9</a>.  <a href="#name-version-08-to-09" class="internal xref">Version -08 to -09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.10">
                <p id="section-toc.1-1.21.2.10.1"><a href="#appendix-D.10" class="auto internal xref">D.10</a>. <a href="#name-version-07-to-08" class="internal xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.11">
                <p id="section-toc.1-1.21.2.11.1"><a href="#appendix-D.11" class="auto internal xref">D.11</a>. <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.12">
                <p id="section-toc.1-1.21.2.12.1"><a href="#appendix-D.12" class="auto internal xref">D.12</a>. <a href="#name-version-05-to-06" class="internal xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.13">
                <p id="section-toc.1-1.21.2.13.1"><a href="#appendix-D.13" class="auto internal xref">D.13</a>. <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.14">
                <p id="section-toc.1-1.21.2.14.1"><a href="#appendix-D.14" class="auto internal xref">D.14</a>. <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.15">
                <p id="section-toc.1-1.21.2.15.1"><a href="#appendix-D.15" class="auto internal xref">D.15</a>. <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.16">
                <p id="section-toc.1-1.21.2.16.1"><a href="#appendix-D.16" class="auto internal xref">D.16</a>. <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.17">
                <p id="section-toc.1-1.21.2.17.1"><a href="#appendix-D.17" class="auto internal xref">D.17</a>. <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The secure communication protocol Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> provides application-layer protection for the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, using CBOR Object Signing and Encryption (COSE) <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> and enabling end-to-end security of CoAP messages.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">As defined in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, Group Object Security for Constrained RESTful Environments (Group OSCORE) enables end-to-end security for CoAP group communication <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>, which can employ, for example, IP multicast as underlying data transport.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Group OSCORE relies on an entity called Group Manager, which is responsible for managing an OSCORE group and enables the group members to exchange CoAP messages secured with Group OSCORE. The Group Manager can be responsible for multiple groups, coordinates the joining process of new group members, and is entrusted with the distribution and renewal of group keying material.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document is an application profile of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, which itself builds on the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Message exchanges among the participants as well as message formats and processing follow what is specified in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and enable the provisioning and renewing of keying material in group communication scenarios, where Group OSCORE is used to protect CoAP group communication.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="ssec-terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">The terms and concepts described in the ACE framework for authentication and authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and in the Authorization Information Format (AIF) <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> to express authorization information. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. This includes Client (C), Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">The terms and concepts related to the message formats and processing specified in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, for provisioning and renewing keying material in group communication scenarios. These include the abbreviations REQx and OPTx denoting the numbered mandatory-to-address and optional-to-address requirements, respectively.<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">The terms and concepts related to Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, and COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">The terms and concepts related to CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and group communication for CoAP <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>. Unless otherwise indicated, the term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.5">
            <p id="section-1.1-3.5.1">The terms and concepts for protection and processing of CoAP messages through OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and through Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> in group communication scenarios. These especially include:<a href="#section-1.1-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.5.2.1">
                <p id="section-1.1-3.5.2.1.1">Group Manager, as the entity responsible for a set of groups where communications are secured with Group OSCORE. In this document, the Group Manager acts as Resource Server.<a href="#section-1.1-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.1-3.5.2.2">
                <p id="section-1.1-3.5.2.2.1">Authentication credential, as the set of information associated with an entity, including that entity's public key and parameters associated with the public key. Examples of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-1.1-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.1-4">Additionally, this document makes use of the following terminology:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">Requester: member of an OSCORE group that sends request messages to other members of the group.<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">Responder: member of an OSCORE group that receives request messages from other members of the group. A responder may reply back, by sending a response message to the requester which has sent the request message.<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.3">
            <p id="section-1.1-5.3.1">Monitor: member of an OSCORE group that is configured as responder and never sends response messages protected with Group OSCORE. This corresponds to the term "silent server" used in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.4">
            <p id="section-1.1-5.4.1">Signature verifier: entity external to the OSCORE group, and intended to verify the signature of messages exchanged in the group that are protected with the group mode (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.3" class="relref">12.3</a>, <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7" class="relref">7</a>, and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7.5" class="relref">7.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-5.4.1" class="pilcrow">¶</a></p>
<p id="section-1.1-5.4.2">
An authorized signature verifier does not join the OSCORE group as an actual member. However, it can interact with the Group Manager in order to retrieve what is needed to perform signature verifications, e.g., the authentication credentials of the current group members and of the Group Manager.<a href="#section-1.1-5.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.5">
            <p id="section-1.1-5.5.1">Signature-only group: an OSCORE group that uses only the group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.6">
            <p id="section-1.1-5.6.1">Pairwise-only group: an OSCORE group that uses only the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-5.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-6">Throughout this document, examples for CBOR data items are expressed in CBOR extended diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> ("diagnostic notation"). Diagnostic notation comments are often used to provide a textual representation of the parameters' keys and values.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">In the CBOR diagnostic notation used in this document, constructs of the form e'SOME_NAME' are replaced by the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 12</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. For example, {e'gp_enc_alg': 10, e'sign_alg': -8} stands for {9: 10, 10: -8}.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">Note to RFC Editor: Please delete the paragraph immediately preceding this note. Also, in the CBOR diagnostic notation used in this document, please replace the constructs of the form e'SOME_NAME' with the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 12</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. Finally, please delete this note.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">Group communication for CoAP has been enabled in <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span> and can be secured by using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. A network node can join an OSCORE group by interacting with the responsible Group Manager. Once registered in the group, the new node can securely exchange messages with other group members.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document describes how to use <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> to perform a number of authentication, authorization, and key distribution actions as overviewed in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-2" class="relref">Section 2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, when the considered group is specifically an OSCORE group.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">With reference to <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1">The node wishing to join the OSCORE group, i.e., the joining node, is the Client.<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1">The Group Manager is the Key Distribution Center (KDC), acting as a Resource Server.<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.3">
          <p id="section-2-4.3.1">The Authorization Server associated with the Group Manager is the AS.<a href="#section-2-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">A node performs the steps described in Sections <a href="https://rfc-editor.org/rfc/rfc9594#section-3" class="relref">3</a> and <a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1.1" class="relref">4.3.1.1</a> of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> in order to obtain an authorization for joining an OSCORE group and then to join that group. The format and processing of messages exchanged during such steps are further specified in <a href="#sec-joining-node-to-AS" class="auto internal xref">Section 5</a> and <a href="#sec-joining-node-to-GM" class="auto internal xref">Section 6</a> of this document.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">All communications between the involved entities <span class="bcp14">MUST</span> be secured.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">In particular, communications between the Client and the Group Manager leverage protocol-specific transport profiles of ACE to achieve communication security, proof-of-possession, and server authentication. It is expected that, in the commonly referred base-case of this document, the transport profile to use is pre-configured and well-known to nodes participating in constrained applications.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">With respect to what is defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>:<a href="#section-2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-9.1">
          <p id="section-2-9.1.1">The interface provided by the Group Manager extends the original interface defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> for the KDC, as specified in <a href="#sec-interface-GM" class="auto internal xref">Section 8</a> of this document.<a href="#section-2-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.2">
          <p id="section-2-9.2.1">In addition to those defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, additional parameters are defined in this document and summarized in <a href="#ace-groupcomm-params" class="auto internal xref">Section 12</a>.<a href="#section-2-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-9.3">
          <p id="section-2-9.3.1">In addition to those defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-9" class="relref">Section 9</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, additional error identifiers are defined in this document and summarized in <a href="#error-types" class="auto internal xref">Section 13</a>.<a href="#section-2-9.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-10">Finally, <a href="#profile-req" class="auto internal xref">Appendix A</a> lists the specifications on this application profile of ACE, based on the requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-format-scope">
<section id="section-3">
      <h2 id="name-format-of-scope">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-format-of-scope" class="section-name selfRef">Format of Scope</a>
      </h2>
<p id="section-3-1">Building on the definition in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> considered in the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, scope denotes: the permissions that the Client seeks to obtain from the AS for accessing resources at a Resource Server; and the permissions that the AS actually issues to the Client following its request. This process is detailed in Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">5.8.1</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">5.8.2</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Consistent with the above and building on <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this section defines the exact format and encoding of scope used in this profile.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">To this end, this profile uses the Authorization Information Format (AIF) <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>. With reference to the generic AIF model<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-4">
<pre>
   AIF-Generic&lt;Toid, Tperm&gt; = [* [Toid, Tperm]]
</pre><a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">the value of the CBOR byte string used as scope encodes the CBOR array [* [Toid, Tperm]], where each [Toid, Tperm] element corresponds to one scope entry.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Furthermore, this document defines the new AIF data model AIF-OSCORE-GROUPCOMM, which this profile <span class="bcp14">MUST</span> use to format and encode scope entries.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">In particular, the following holds for each scope entry:<a href="#section-3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">
          <p id="section-3-8.1.1">The object identifier ("Toid") is specialized as a CBOR data item specifying the name of the groups pertaining to the scope entry.<a href="#section-3-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-8.2">
          <p id="section-3-8.2.1">The permission set ("Tperm") is specialized as a CBOR unsigned integer with value R, specifying the permissions that the Client wishes to have in the groups indicated by "Toid".<a href="#section-3-8.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-9">More specifically, the following applies when, as defined in this document, a scope entry includes as set of permissions the set of roles to take in an OSCORE group.<a href="#section-3-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-10.1">
          <p id="section-3-10.1.1">The object identifier ("Toid") is a CBOR text string, specifying the group name for the scope entry.<a href="#section-3-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-10.2">
          <p id="section-3-10.2.1">The permission set ("Tperm") is a CBOR unsigned integer with value R, specifying the role(s) that the Client wishes to take in the group (REQ1). The value R is computed as follows.<a href="#section-3-10.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-10.2.2.1">
              <p id="section-3-10.2.2.1.1">Each role in the permission set is converted into the corresponding numeric identifier X from the "Value" column of the "Group OSCORE Roles" registry defined in <a href="#ssec-iana-group-oscore-roles-registry" class="auto internal xref">Section 16.12</a> of this document, for which the initial entries are specified in <a href="#tab-role-values" class="auto internal xref">Table 1</a>.<a href="#section-3-10.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-10.2.2.2">
              <p id="section-3-10.2.2.2.1">The set of N numbers is converted into the single value R, by taking two to the power of each numeric identifier X_1, X_2, ..., X_N, and then computing the inclusive OR of the binary representations of all the power values.<a href="#section-3-10.2.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<span id="name-numeric-identifier-of-roles"></span><div id="tab-role-values">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-numeric-identifier-of-roles" class="selfRef">Numeric Identifier of Roles in an OSCORE Group</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">This value is reserved</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Requester</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">Send protected requests; receive protected responses</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Responder</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">Send protected responses; receive protected requests</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Monitor</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">Receive protected requests; never send protected messages</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Verifier</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">Verify signature of intercepted messages protected with the group mode</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-3-12">The following CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> notation defines a scope entry that uses the AIF-OSCORE-GROUPCOMM data model and expresses a set of Group OSCORE roles from those in <a href="#tab-role-values" class="auto internal xref">Table 1</a>.<a href="#section-3-12" class="pilcrow">¶</a></p>
<div class="lang-CDDL sourcecode" id="section-3-13">
<pre>
   ;# include rfc9237

   AIF-OSCORE-GROUPCOMM = AIF-Generic&lt;oscore-gname, oscore-gperm&gt;

   oscore-gname = tstr  ; Group name
   oscore-gperm = uint .bits group-oscore-roles

   group-oscore-roles = &amp;(
      Requester: 1,
      Responder: 2,
      Monitor: 3,
      Verifier: 4
   )

   scope_entry = [oscore-gname, oscore-gperm]
</pre><a href="#section-3-13" class="pilcrow">¶</a>
</div>
<p id="section-3-14">Future specifications that define new Group OSCORE roles <span class="bcp14">MUST</span> register a corresponding numeric identifier in the "Group OSCORE Roles" registry.<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">Note that the value 0 is not available to use as numeric identifier to specify a Group OSCORE role. It follows that, when expressing Group OSCORE roles to take in a group as per this document, a scope entry has the least significant bit of "Tperm" always set to 0.<a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16">This is an explicit feature of the AIF-OSCORE-GROUPCOMM data model. That is, for each scope entry, the least significant bit of "Tperm" set to 0 explicitly identifies the scope entry as exactly expressing a set of Group OSCORE roles ("Tperm"), pertaining to a single group whose name is specified by the string literal in "Toid".<a href="#section-3-16" class="pilcrow">¶</a></p>
<p id="section-3-17">Instead, by relying on the same AIF-OSCORE-GROUPCOMM data model, <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="cite xref">I-D.ietf-ace-oscore-gm-admin</a>]</span> defines the format of scope entries for Administrator Clients that wish to access an admin interface at the Group Manager. In such scope entries, the least significant bit of "Tperm" is always set to 1.<a href="#section-3-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-public-keys-of-joining-nodes">
<section id="section-4">
      <h2 id="name-authentication-credentials">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-authentication-credentials" class="section-name selfRef">Authentication Credentials</a>
      </h2>
<p id="section-4-1">Source authentication of a message sent within the group and protected with Group OSCORE is ensured by means of a digital signature embedded in the message (in group mode), or by integrity-protecting the message with pairwise keying material derived from the asymmetric keys of the sender and recipient (in pairwise mode).<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Therefore, group members must be able to retrieve each other's authentication credentials from a trusted repository, in order to verify source authenticity of incoming group messages.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">As also discussed in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager acts as trusted repository of the authentication credentials of the group members, and provides those authentication credentials to group members if requested to.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Upon joining an OSCORE group, a joining node is thus expected to provide its authentication credential to the Group Manager (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>). Later on as a group member, that node can provide the Group Manager with a different authentication credential that replaces the old one (see <a href="#sec-update-pub-key" class="auto internal xref">Section 9.4</a>). In either situation, the authentication credential can be provided within a chain or a bag (e.g., as the end-entity certificate in a chain of certificates), in which case the Group Manager stores the whole chain or bag. Consistently, the Group Manager specifies the whole chain or bag when providing that authentication credential, within the 'creds' parameter of a Join Response (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>) or of an Authentication Credential Response (see <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>).<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">In the following circumstances, a joining node is not required to provide its authentication credential to the Group Manager when joining an OSCORE group.<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">
          <p id="section-4-6.1.1">The joining node is going to join the group exclusively as monitor, i.e., it is not going to send protected messages to the group.<a href="#section-4-6.1.1" class="pilcrow">¶</a></p>
<p id="section-4-6.1.2">
In this case, the joining node is not required to provide its own authentication credential to the Group Manager, which thus does not have to perform any check related to the format of the authentication credential, to a signature or ECDH algorithm, and to possible parameters associated with the algorithm and the public key.<a href="#section-4-6.1.2" class="pilcrow">¶</a></p>
<p id="section-4-6.1.3">
If the joining node still provides an authentication credential in the 'client_cred' parameter of the Join Request (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>), the Group Manager silently ignores that parameter and the related parameter 'client_cred_verify'.<a href="#section-4-6.1.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-6.2">
          <p id="section-4-6.2.1">The joining node is currently a group member, and it is re-joining the group not exclusively as monitor.<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
<p id="section-4-6.2.2">
In this case, the joining node <span class="bcp14">MAY</span> choose to omit the 'client_cred' parameter and the 'client_cred_verify' parameter in the Join Request, if it intends to use the same authentication credential that it is currently using in the group (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-4-6.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-joining-node-to-AS">
<section id="section-5">
      <h2 id="name-authorization-to-join-a-gro">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-to-join-a-gro" class="section-name selfRef">Authorization to Join a Group</a>
      </h2>
<p id="section-5-1">This section builds on <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3" class="relref">Section 3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and is organized as follows.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">First, <a href="#ssec-auth-req" class="auto internal xref">Section 5.1</a> and <a href="#ssec-auth-resp" class="auto internal xref">Section 5.2</a> describe how the joining node interacts with the AS, in order to be authorized to join an OSCORE group under a given Group Manager and to obtain an access token. Then, <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a> describes how the joining node transfers the obtained access token to the Group Manager.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The following considers a joining node that intends to contact the Group Manager for the first time.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Note that what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3" class="relref">Section 3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> applies, and only additions or modifications to that specification are defined in this document.<a href="#section-5-4" class="pilcrow">¶</a></p>
<div id="ssec-auth-req">
<section id="section-5.1">
        <h3 id="name-authorization-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-5.1-1">The Authorization Request message is as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">If the 'scope' parameter is present:<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1.2.1">
                <p id="section-5.1-2.1.2.1.1">The value of the CBOR byte string encodes a CBOR array, whose format <span class="bcp14">MUST</span> follow the data model AIF-OSCORE-GROUPCOMM defined in <a href="#sec-format-scope" class="auto internal xref">Section 3</a> of this document. For each OSCORE group to join:<a href="#section-5.1-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1.2.1.2.1">
                    <p id="section-5.1-2.1.2.1.2.1.1">The group name is encoded as a CBOR text string.<a href="#section-5.1-2.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-5.1-2.1.2.1.2.2">
                    <p id="section-5.1-2.1.2.1.2.2.1">The set of requested roles is expressed as a single CBOR unsigned integer. This is computed as defined in <a href="#sec-format-scope" class="auto internal xref">Section 3</a> of this document, from the numerical abbreviations of each requested role defined in the "Group OSCORE Roles" registry, for which this document defines the entries in <a href="#tab-role-values" class="auto internal xref">Table 1</a> (REQ1).<a href="#section-5.1-2.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="ssec-auth-resp">
<section id="section-5.2">
        <h3 id="name-authorization-response">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
        </h3>
<p id="section-5.2-1">The Authorization Response message is as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">
            <p id="section-5.2-2.1.1">The AS <span class="bcp14">MUST</span> include the 'expires_in' parameter. Other means for the AS to specify the lifetime of access tokens are out of the scope of this document.<a href="#section-5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">The AS <span class="bcp14">MUST</span> include the 'scope' parameter, when the value included in the access token differs from the one specified by the joining node in the Authorization Request. In such a case, the second element of each scope entry <span class="bcp14">MUST</span> be present, and specifies the set of roles that the joining node is actually authorized to take in the OSCORE group for that scope entry, encoded as specified in <a href="#ssec-auth-req" class="auto internal xref">Section 5.1</a> of this document.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-3">Furthermore, the AS <span class="bcp14">MAY</span> use the extended format of scope defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-7" class="relref">Section 7</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> for the 'scope' claim of the access token. In such a case, the AS <span class="bcp14">MUST</span> use the CBOR tag with tag number TAG_NUMBER, associated with the CoAP Content-Format CF_ID for the media type "application/aif+cbor" registered in <a href="#ssec-iana-coap-content-format-registry" class="auto internal xref">Section 16.9</a> of this document (REQ28).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Note to RFC Editor: In the previous paragraph, please replace "TAG_NUMBER" with the CBOR tag number computed as TN(ct) in <span><a href="https://rfc-editor.org/rfc/rfc9277#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>, where ct is the ID assigned to the CoAP Content-Format registered in <a href="#ssec-iana-coap-content-format-registry" class="auto internal xref">Section 16.9</a> of this document. Then, please replace "CF_ID" with the ID assigned to that CoAP Content-Format. Finally, please delete this paragraph.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">This indicates that the binary encoded scope, as conveying the actual access control information, follows the scope semantics defined for this application profile in <a href="#sec-format-scope" class="auto internal xref">Section 3</a> of this document.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-token-post">
<section id="section-5.3">
        <h3 id="name-token-transferring">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-token-transferring" class="section-name selfRef">Token Transferring</a>
        </h3>
<p id="section-5.3-1">The exchange of Token Transfer Request and Token Transfer Response is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. In addition to that, the following applies.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">The Token Transfer Request <span class="bcp14">MAY</span> additionally contain the following parameters, which, if included, <span class="bcp14">MUST</span> have the corresponding values defined below (OPT2):<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1.2.1">
                <p id="section-5.3-2.1.2.1.1">'ecdh_info' defined in <a href="#ecdh-info" class="auto internal xref">Section 5.3.1</a> of this document, with value the CBOR simple value <code>null</code> (0xf6) to request information about the ECDH algorithm, the ECDH algorithm parameters, the ECDH key parameters, and the exact format of authentication credentials used in the OSCORE groups that the Client has been authorized to join. This is relevant in case the joining node supports the pairwise mode of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-5.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.1.2.2">
                <p id="section-5.3-2.1.2.2.1">'kdc_dh_creds' defined in <a href="#gm-dh-info" class="auto internal xref">Section 5.3.2</a> of this document, with value the CBOR simple value <code>null</code> (0xf6) to request the Diffie-Hellman authentication credentials of the Group Manager for the OSCORE groups that the Client has been authorized to join. That is, each of such authentication credentials includes a Diffie-Hellman public key of the Group Manager. This is relevant in case the joining node supports the pairwise mode of Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and the access token authorizes to join pairwise-only groups.<a href="#section-5.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.3-2.1.3">
Alternatively, the joining node may retrieve this information by other means.<a href="#section-5.3-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">The 'kdcchallenge' parameter contains a dedicated nonce N_S generated by the Group Manager. For the N_S value, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce. The joining node can use this nonce in order to prove the possession of its own private key, upon joining the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a> of this document).<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.3-2.2.2">
The 'kdcchallenge' parameter <span class="bcp14">MAY</span> be omitted from the Token Transfer Response, if the 'scope' of the access token specifies only the role "monitor", or only the role "verifier", or only the two roles combined, for each and every of the specified groups.<a href="#section-5.3-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.3">
            <p id="section-5.3-2.3.1">If the 'sign_info' parameter is present in the Token Transfer Response, the following applies for each element 'sign_info_entry'.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.3.2.1">
                <p id="section-5.3-2.3.2.1.1">'id' <span class="bcp14">MUST NOT</span> refer to OSCORE groups that are pairwise-only groups.<a href="#section-5.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.3.2.2">
                <p id="section-5.3-2.3.2.2.1">'sign_alg' takes value from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> (REQ3).<a href="#section-5.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.3.2.3">
                <p id="section-5.3-2.3.2.3.1">'sign_parameters' has the same format and value of the COSE capabilities array for the algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> (REQ4).<a href="#section-5.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.3.2.4">
                <p id="section-5.3-2.3.2.4.1">'sign_key_parameters' has the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span> (REQ5).<a href="#section-5.3-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.3.2.5">
                <p id="section-5.3-2.3.2.5.1">'cred_fmt' takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span> (REQ6). Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote a format of authentication credential that <span class="bcp14">MUST</span> explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-5.3-2.3.2.5.1" class="pilcrow">¶</a></p>
<p id="section-5.3-2.3.2.5.2">
At the time of writing this specification, acceptable formats of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-5.3-2.3.2.5.2" class="pilcrow">¶</a></p>
<p id="section-5.3-2.3.2.5.3">
[ As to C509 certificates, the COSE Header Parameters 'c5b' and 'c5c' are under pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-5.3-2.3.2.5.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.3-2.3.3">
This format is consistent with every signature algorithm currently considered in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> describes how the format of each 'sign_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-5.3-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.4">
            <p id="section-5.3-2.4.1">If the 'ecdh_info' parameter is present in the Token Transfer Response, the following applies for each element 'ecdh_info_entry'.<a href="#section-5.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.4.2.1">
                <p id="section-5.3-2.4.2.1.1">'id' <span class="bcp14">MUST NOT</span> refer to OSCORE groups that are signature-only groups.<a href="#section-5.3-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.4.2.2">
                <p id="section-5.3-2.4.2.2.1">'ecdh_alg' takes value from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-5.3-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.4.2.3">
                <p id="section-5.3-2.4.2.3.1">'ecdh_parameters' has the same format and value of the COSE capabilities array for the algorithm indicated in 'ecdh_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-5.3-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.4.2.4">
                <p id="section-5.3-2.4.2.4.1">'ecdh_key_parameters' has the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'ecdh_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#section-5.3-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.4.2.5">
                <p id="section-5.3-2.4.2.5.1">'cred_fmt' takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>. Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote a format of authentication credential that <span class="bcp14">MUST</span> explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable). The same considerations provided above on acceptable formats currently available for the 'cred_fmt' element of 'sign_info' apply.<a href="#section-5.3-2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.3-2.4.3">
The Group Manager omits the 'ecdh_info' parameter in the Token Transfer Response even if 'ecdh_info' is included in the Token Transfer Request, in case all the OSCORE groups that the Client is authorized to join are signature-only groups.<a href="#section-5.3-2.4.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.5">
            <p id="section-5.3-2.5.1">If the 'kdc_dh_creds' parameter is present in the Token Transfer Response, the following applies for each element 'kdc_dh_creds_entry'.<a href="#section-5.3-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.5.2.1">
                <p id="section-5.3-2.5.2.1.1">'id' <span class="bcp14">MUST</span> refer exclusively to OSCORE groups that are pairwise-only groups.<a href="#section-5.3-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-2.5.2.2">
                <p id="section-5.3-2.5.2.2.1">'cred_fmt' takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>. Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote a format of authentication credential that <span class="bcp14">MUST</span> explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable). The same considerations provided above on acceptable formats currently available for the 'cred_fmt' element of 'sign_info' apply.<a href="#section-5.3-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.3-2.5.3">
The Group Manager omits the 'kdc_dh_creds' parameter in the Token Transfer Response even if 'ecdh_info' is included in the Token Transfer Request, in case none of the OSCORE groups that the Client is authorized to join is a pairwise-only group.<a href="#section-5.3-2.5.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-3">Note that, other than through the above parameters as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the joining node may have obtained such information by alternative means. For example, information conveyed in the 'sign_info' and 'ecdh_info' parameters may have been pre-configured, or the joining node may early retrieve it, e.g., by using the approach described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">I-D.tiloca-core-oscore-discovery</a>]</span> to discover the OSCORE group and the link to the associated group-membership resource at the Group Manager (OPT3).<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="ecdh-info">
<section id="section-5.3.1">
          <h4 id="name-ecdh_info-parameter">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-ecdh_info-parameter" class="section-name selfRef">'ecdh_info' Parameter</a>
          </h4>
<p id="section-5.3.1-1">The 'ecdh_info' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the request and response messages exchanged between the Client and the /authz-info endpoint at the RS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1." class="relref">Section 5.10.1.</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">This parameter allows the Client and the RS to exchange information about an ECDH algorithm as well as about the authentication credentials and public keys to accordingly use for deriving Diffie-Hellman secrets. Its exact semantics and content are application specific.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">In application profiles that build on <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this parameter is used to exchange information about the ECDH algorithm as well as about the authentication credentials and public keys to be used with it, in the groups indicated by the transferred access token as per its 'scope' claim (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<p id="section-5.3.1-4">When used in the Token Transfer Request sent to the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), the 'ecdh_info' parameter specifies the CBOR simple value <code>null</code> (0xf6). This is done to ask for information about the ECDH algorithm and about the authentication credentials used to compute static-static Diffie-Hellman shared secrets <span>[<a href="#NIST-800-56A" class="cite xref">NIST-800-56A</a>]</span>, in the groups that the Client has been authorized to join or interact with.<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
<p id="section-5.3.1-5">When used in the following Token Transfer Response from the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), the 'ecdh_info' parameter is a CBOR array of one or more elements. The number of elements is at most the number of groups that the Client has been authorized to join or interact with. Each element contains information about ECDH parameters and about authentication credentials for one or more groups and is formatted as follows.<a href="#section-5.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-6.1">
              <p id="section-5.3.1-6.1.1">The first element 'id' is a group name or a CBOR array of group names, which is associated with groups for which the next four elements apply. Each specified group name is a CBOR text string and is hereafter referred to as 'gname'.<a href="#section-5.3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-6.2">
              <p id="section-5.3.1-6.2.1">The second element 'ecdh_alg' is a CBOR integer or a text string that indicates the ECDH algorithm used in the groups identified by the 'gname' values.<a href="#section-5.3.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-6.2.2">
For application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> that use the 'ecdh_info' parameter, it is <span class="bcp14">REQUIRED</span> to define specific values that 'ecdh_alg' can take, which are selected from the set of signing algorithms of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-5.3.1-6.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-6.3">
              <p id="section-5.3.1-6.3.1">The third element 'ecdh_parameters' is a CBOR array that indicates the parameters of the ECDH algorithm used in the groups identified by the 'gname' values. Its content depends on the value of 'ecdh_alg'.<a href="#section-5.3.1-6.3.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-6.3.2">
For application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> that use the 'ecdh_info' parameter, it is <span class="bcp14">REQUIRED</span> to define the possible values and structure for the elements of 'ecdh_parameters'.<a href="#section-5.3.1-6.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-6.4">
              <p id="section-5.3.1-6.4.1">The fourth element 'ecdh_key_parameters' is a CBOR array that indicates the parameters of the key used with the ECDH algorithm in the groups identified by the 'gname' values. Its content depends on the value of 'ecdh_alg'.<a href="#section-5.3.1-6.4.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-6.4.2">
For application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> that use the 'ecdh_info' parameter, it is <span class="bcp14">REQUIRED</span> to define the possible values and structure for the elements of 'ecdh_key_parameters'.<a href="#section-5.3.1-6.4.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-6.5">
              <p id="section-5.3.1-6.5.1">The fifth element 'cred_fmt' either is a CBOR integer indicating the format of authentication credentials used in the groups identified by the 'gname' values or is the CBOR simple value <code>null</code> (0xf6), which indicates that the KDC does not act as a repository of authentication credentials for group members. Its acceptable integer values are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>, with some of those values also indicating the type of container to use for exchanging the authentication credentials with the KDC (e.g., a chain or bag of certificates).<a href="#section-5.3.1-6.5.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-6.5.2">
For application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> that use the 'ecdh_info' parameter, it is <span class="bcp14">REQUIRED</span> to define specific values to use for 'cred_fmt', consistently with the acceptable formats of authentication credentials.<a href="#section-5.3.1-6.5.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.1-7">If 'ecdh_info' is included in the Token Transfer Request, the KDC <span class="bcp14">SHOULD</span> include the 'ecdh_info' parameter in the Token Transfer Response, as per the format defined above. Note that the field 'id' of each 'ecdh_info_entry' specifies the name, or array of group names to which that 'ecdh_info_entry' applies. As an exception, the KDC <span class="bcp14">MAY</span> omit the 'ecdh_info' parameter in the Token Transfer Response even if 'ecdh_info' is included in the Token Transfer Request, in case none of the groups that the Client is authorized to join uses an ECDH algorithm to derive Diffie-Hellman secrets.<a href="#section-5.3.1-7" class="pilcrow">¶</a></p>
<p id="section-5.3.1-8">The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the 'ecdh_info' parameter is given below.<a href="#section-5.3.1-8" class="pilcrow">¶</a></p>
<div class="lang-CDDL sourcecode" id="section-5.3.1-9">
<pre>
ecdh_info = ecdh_info_req / ecdh_info_resp

ecdh_info_req = null                  ; in the Token Transfer
                                      ; Request to the KDC

ecdh_info_resp = [+ ecdh_info_entry]  ; in the Token Transfer
                                      ; Response from the KDC

ecdh_info_entry =
[
  id: gname / [+ gname],
  ecdh_alg: int / tstr,
  ecdh_parameters: [any],
  ecdh_key_parameters: [+ parameter: any],
  cred_fmt: int / null
]

gname = tstr
</pre><a href="#section-5.3.1-9" class="pilcrow">¶</a>
</div>
<p id="section-5.3.1-10">This format is consistent with every ECDH algorithm currently defined in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs" class="auto internal xref">Appendix B</a> of this document describes how the format of each 'ecdh_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-5.3.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gm-dh-info">
<section id="section-5.3.2">
          <h4 id="name-kdc_dh_creds-parameter">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-kdc_dh_creds-parameter" class="section-name selfRef">'kdc_dh_creds' Parameter</a>
          </h4>
<p id="section-5.3.2-1">The 'kdc_dh_creds' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the request and response messages exchanged between the Client and the /authz-info endpoint at the RS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1." class="relref">Section 5.10.1.</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">This parameter allows the Client to request and retrieve the Diffie-Hellman authentication credentials of the RS, i.e., authentication credentials including a Diffie-Hellman public key of the RS.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">In application profiles that build on <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this parameter is used to request and retrieve from the KDC its Diffie-Hellman authentication credentials to use, in the groups indicated by the transferred access token as per its 'scope' claim (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2-4">When used in the Token Transfer Request sent to the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), the 'kdc_dh_creds' parameter specifies the CBOR simple value <code>null</code> (0xf6). This is done to ask for the Diffie-Hellman authentication credentials that the KDC uses in the groups that the Client has been authorized to join or interact with.<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
<p id="section-5.3.2-5">When used in the following Token Transfer Response from the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), the 'kdc_dh_creds' parameter is a CBOR array of one or more elements. The number of elements is at most the number of groups that the Client has been authorized to join or interact with. Each element contains information about the KDC's Diffie-Hellman authentication credentials for one or more groups and is formatted as follows.<a href="#section-5.3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-6.1">
              <p id="section-5.3.2-6.1.1">The first element 'id' is a group name or a CBOR array of group names, which is associated with groups for which the next two elements apply. Each specified group name is a CBOR text string and is hereafter referred to as 'gname'.<a href="#section-5.3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-6.2">
              <p id="section-5.3.2-6.2.1">The second element 'cred_fmt' is a CBOR integer indicating the format of the KDC's authentication credential used in the groups identified by the 'gname' values and specified by the following element 'cred'. Its acceptable integer values are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>, with some of those values also indicating the type of container to use for exchanging the authentication credentials with the KDC (e.g., a chain or bag of certificates).<a href="#section-5.3.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-6.2.2">
For application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> that use the 'kdc_dh_creds' parameter, it is <span class="bcp14">REQUIRED</span> to define specific values to use for 'cred_fmt', consistently with the acceptable formats of the KDC's authentication credentials.<a href="#section-5.3.2-6.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-6.3">
              <p id="section-5.3.2-6.3.1">The third element 'cred' is a CBOR byte string encoding the original binary representation of the Diffie-Hellman authentication credential that the KDC uses in the groups identified by the 'gname' values. The authentication credential complies with the format specified by the 'cred_fmt' element.<a href="#section-5.3.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.2-7">If 'kdc_dh_creds' is included in the Token Transfer Request, the KDC <span class="bcp14">SHOULD</span> include the 'kdc_dh_creds' parameter in the Token Transfer Response, as per the format defined above. Note that the field 'id' of each 'kdc_dh_creds_entry' specifies the name, or array of group names to which that 'kdc_dh_creds_entry' applies. As an exception, the KDC <span class="bcp14">MAY</span> omit the 'kdc_dh_creds' parameter in the Token Transfer Response even if 'kdc_dh_creds' is included in the Token Transfer Request, in case the KDC does not use a Diffie-Hellman authentication credential in any of the groups that the Client is authorized to join.<a href="#section-5.3.2-7" class="pilcrow">¶</a></p>
<p id="section-5.3.2-8">The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the 'kdc_dh_creds' parameter is given below.<a href="#section-5.3.2-8" class="pilcrow">¶</a></p>
<div class="lang-CDDL sourcecode" id="section-5.3.2-9">
<pre>
kdc_dh_creds = kdc_dh_creds_req / kdc_dh_creds_resp

kdc_dh_creds_req = null                     ; in the Token Transfer
                                            ; Request to the KDC

kdc_dh_creds_resp = [+ kdc_dh_creds_entry]  ; in the Token Transfer
                                            ; Response from the KDC

kdc_dh_creds_entry =
[
  id: gname / [+ gname],
  cred_fmt: int,
  cred: bstr
]

gname = tstr
</pre><a href="#section-5.3.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-joining-node-to-GM">
<section id="section-6">
      <h2 id="name-group-joining">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-group-joining" class="section-name selfRef">Group Joining</a>
      </h2>
<p id="section-6-1">This section describes the interactions between the joining node and the Group Manager to join an OSCORE group. The message exchange between the joining node and the Group Manager consists of the messages defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Note that what is defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> applies, and only additions or modifications to that specification are defined in this document.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ssec-join-req-sending">
<section id="section-6.1">
        <h3 id="name-send-the-join-request">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-send-the-join-request" class="section-name selfRef">Send the Join Request</a>
        </h3>
<p id="section-6.1-1">The joining node requests to join the OSCORE group by sending a Join Request message to the related group-membership resource at the Group Manager, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1.1" class="relref">Section 4.3.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Additionally to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the following applies.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">The 'scope' parameter <span class="bcp14">MUST</span> be included. Its value encodes one scope entry with the format defined in <a href="#sec-format-scope" class="auto internal xref">Section 3</a>, indicating the group name and the role(s) that the joining node wants to take in the group.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.1.2">
The 'scope' parameter <span class="bcp14">MUST NOT</span> specify any of the following sets of roles: ("requester", "monitor") and ("responder", "monitor"). Future specifications that define a new role for members of OSCORE groups <span class="bcp14">MUST</span> define possible sets of roles (including the new role and existing roles) that are not acceptable to specify in the 'scope' parameter of a Join Request.<a href="#section-6.1-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">The 'get_creds' parameter is present only if the joining node wants to retrieve the authentication credentials of the group members from the Group Manager during the joining process (see <a href="#sec-public-keys-of-joining-nodes" class="auto internal xref">Section 4</a>). Otherwise, this parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.2.2">
If this parameter is present and its value is not the CBOR simple value <code>null</code> (0xf6), each element of the inner CBOR array 'role_filter' is encoded as a CBOR unsigned integer, with the same value of a permission set ("Tperm") indicating that role or combination of roles in a scope entry, as defined in <a href="#sec-format-scope" class="auto internal xref">Section 3</a>.<a href="#section-6.1-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">The 'cnonce' parameter contains a dedicated nonce N_C generated by the joining node. For the N_C value, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.4">
            <p id="section-6.1-2.4.1">If the joining node intends to join the group exclusively as a monitor, then the 'client_cred' parameter and the 'client_cred_verify' parameter <span class="bcp14">MUST</span> be omitted.<a href="#section-6.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.5">
            <p id="section-6.1-2.5.1">If the joining node is currently a group member and intends to use the same authentication credential that it is currently using in the group, then the 'client_cred' parameter and the 'client_cred_verify' parameter <span class="bcp14">MAY</span> be omitted.<a href="#section-6.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.6">
            <p id="section-6.1-2.6.1">If the 'client_cred_verify' parameter is present, then the proof-of-possession (PoP) evidence included therein is computed as defined below (REQ14).<a href="#section-6.1-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.6.2.1">
                <p id="section-6.1-2.6.2.1.1">Specifically in the case where the joining node is not a current member of the group, the Group Manager might already have achieved proof-of-possession of the joining node's private key associated with the authentication credential AUTH_CRED_C that the joining node intends to use in the group.<a href="#section-6.1-2.6.2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.6.2.1.2">
For example, that could have happened upon completing the establishment of the secure communication association that is used to protect the Join Request, if the joining node used AUTH_CRED_C to authenticate itself with the Group Manager.<a href="#section-6.1-2.6.2.1.2" class="pilcrow">¶</a></p>
<p id="section-6.1-2.6.2.1.3">
Under these circumstances, the joining node <span class="bcp14">MAY</span> specify an empty PoP evidence, i.e., it sets the value of the 'client_cred_verify' parameter to the empty CBOR byte string (0x40).<a href="#section-6.1-2.6.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.6.2.2">
                <p id="section-6.1-2.6.2.2.1">If the conditions above do not hold or the joining node prefers to compute a non-empty PoP evidence, then the joining node  proceeds as follows. In either case, the N_S used to build the PoP input is as defined in <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>.<a href="#section-6.1-2.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.6.2.2.2.1">
                    <p id="section-6.1-2.6.2.2.2.1.1">If the group is not a pairwise-only group, the PoP evidence <span class="bcp14">MUST</span> be a signature. The joining node computes the signature by using the same private key and signature algorithm that it intends to use for signing messages in the OSCORE group.<a href="#section-6.1-2.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.1-2.6.2.2.2.2">
                    <p id="section-6.1-2.6.2.2.2.2.1">If the group is a pairwise-only group, the PoP evidence <span class="bcp14">MUST</span> be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>.<a href="#section-6.1-2.6.2.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-2.6.2.2.2.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-6.1-2.6.2.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.1-2.6.2.2.2.2.3">
The input parameters of HKDF are as follows:<a href="#section-6.1-2.6.2.2.2.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.6.2.2.2.2.4.1">
                        <p id="section-6.1-2.6.2.2.2.2.4.1.1">salt takes as value the empty byte string.<a href="#section-6.1-2.6.2.2.2.2.4.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-6.1-2.6.2.2.2.2.4.2">
                        <p id="section-6.1-2.6.2.2.2.2.4.2.1">IKM is computed as a cofactor Diffie-Hellman shared secret, see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="cite xref">NIST-800-56A</a>]</span>, using the ECDH algorithm used in the OSCORE group. The joining node uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the Group Manager. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-6.1-2.6.2.2.2.2.4.2.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-6.1-2.6.2.2.2.2.4.3">
                        <p id="section-6.1-2.6.2.2.2.2.4.3.1">info takes as value the PoP input.<a href="#section-6.1-2.6.2.2.2.2.4.3.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-6.1-2.6.2.2.2.2.4.4">
                        <p id="section-6.1-2.6.2.2.2.2.4.4.1">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-6.1-2.6.2.2.2.2.4.4.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<div id="sssec-challenge-value">
<section id="section-6.1.1">
          <h4 id="name-value-of-the-n_s-challenge">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-value-of-the-n_s-challenge" class="section-name selfRef">Value of the N_S Challenge</a>
          </h4>
<p id="section-6.1.1-1">The value of the N_S challenge is determined as follows.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-2.1">
              <p id="section-6.1.1-2.1.1">If the joining node has provided the access token to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>, then N_S takes the same value of the most recent 'kdcchallenge' parameter received by the joining node from the Group Manager. This can be either the one specified in the Token Transfer Response, or the one possibly specified in a 4.00 (Bad Request) error response to a following Join Request (see <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>).<a href="#section-6.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-2.2">
              <p id="section-6.1.1-2.2.1">If the provisioning of the access token to the Group Manager has relied on the DTLS profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and the access token was specified in the "psk_identity" field of the ClientKeyExchange message when using DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, then N_S is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-4" class="relref">Section 4</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> (REQ15).<a href="#section-6.1.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.2.2">
Specifically, N_S is exported from the DTLS session between the joining node and the Group Manager, using an empty context value (i.e., a context value of zero-length), 32 as length value in bytes, and the exporter label "EXPORTER-ACE-Pop-Input-coap-group-oscore-app" defined in <a href="#ssec-iana-tls-esporter-label-registry" class="auto internal xref">Section 16.7</a> of this document.<a href="#section-6.1.1-2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.2.3">
The same as above holds if TLS 1.2 <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> was used instead of DTLS 1.2, as per <span>[<a href="#RFC9430" class="cite xref">RFC9430</a>]</span>.<a href="#section-6.1.1-2.2.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-2.3">
              <p id="section-6.1.1-2.3.1">If the provisioning of the access token to the Group Manager has relied on the DTLS profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and the access token was specified in the "identity" field of a PskIdentity within the PreSharedKeyExtension of the ClientHello message when using DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, then N_S is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> (REQ15).<a href="#section-6.1.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.3.2">
Specifically, N_S is exported from the DTLS session between the joining node and the Group Manager, using an empty 'context_value' (i.e., a 'context_value' of zero length), 32 as 'key_length' in bytes, and the exporter label "EXPORTER-ACE-Pop-Input-coap-group-oscore-app" defined in <a href="#ssec-iana-tls-esporter-label-registry" class="auto internal xref">Section 16.7</a> of this document.<a href="#section-6.1.1-2.3.2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2.3.3">
The same as above holds if TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> was used instead of DTLS 1.3, as per <span>[<a href="#RFC9430" class="cite xref">RFC9430</a>]</span>.<a href="#section-6.1.1-2.3.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.1-3">It is up to applications to define how N_S is computed in further alternative settings.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-4"><a href="#ssec-security-considerations-reusage-nonces" class="auto internal xref">Section 15.3</a> provides security considerations on the reusage of the N_S challenge.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-join-req-processing">
<section id="section-6.2">
        <h3 id="name-receive-the-join-request">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-receive-the-join-request" class="section-name selfRef">Receive the Join Request</a>
        </h3>
<p id="section-6.2-1">The Group Manager processes the Join Request as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions. Note that the Group Manager can determine whether the joining node is a current group member, e.g., based on the ongoing secure communication association that is used to protect the Join Request.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">In case the joining node is going to join the group exclusively as monitor, then the Group Manager silently ignores the parameters 'client_cred' and 'client_cred_verify', if present.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">In case the joining node is not going to join the group exclusively as monitor, it is a current member of the group, and the 'client_cred_verify' parameter is not present, then the following applies:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-4.1">
            <p id="section-6.2-4.1.1">If the 'client_cred' parameter is present, the Group Manager verifies that it is already storing the authentication credential specified therein, as associated with the joining node in the group. If the verification fails, the Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#section-6.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-4.2">
            <p id="section-6.2-4.2.1">If case the 'client_cred' parameter is not present, the Group Manager verifies that it is already storing an authentication credential, as associated with the joining node in the group. If the verification fails, the Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#section-6.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-5">In case the joining node is not going to join the group exclusively as monitor and the 'client_cred_verify' parameter specifies the empty CBOR byte string (0x40), the Group Manager checks whether it has already achieved proof-of-possession of the joining node's private key associated with the authentication credential that is specified in the 'client_cred' parameter. If such verification fails, then the Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 3 ("Invalid proof-of-possession evidence"). After receiving that response, the client <span class="bcp14">MUST NOT</span> specify an empty PoP evidence in the 'client_cred_verify' parameter of a follow-up Join Request for joining the same group.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">In case the joining node is not going to join the group exclusively as monitor and the 'client_cred_verify' parameter specifies a value different from the empty CBOR byte string (0x40), then the Group Manager verifies the PoP evidence therein as follows:<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-7.1">
            <p id="section-6.2-7.1.1">As PoP input, the Group Manager uses the value of the 'scope' parameter from the Join Request as a CBOR byte string, concatenated with N_S encoded as a CBOR byte string, concatenated with N_C encoded as a CBOR byte string. The value of N_S is determined as described in <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>, while N_C is the nonce provided in the 'cnonce' parameter of the Join Request.<a href="#section-6.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-7.2">
            <p id="section-6.2-7.2.1">As public key of the joining node, the Group Manager uses either the one included in the authentication credential retrieved from the 'client_cred' parameter of the Join Request, or the one from the already stored authentication credential as acquired from previous interactions with the joining node (see above).<a href="#section-6.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-7.3">
            <p id="section-6.2-7.3.1">If the group is not a pairwise-only group, the PoP evidence is a signature. The Group Manager verifies it by using the public key of the joining node, as well as the signature algorithm used in the OSCORE group and possible corresponding parameters.<a href="#section-6.2-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-7.4">
            <p id="section-6.2-7.4.1">If the group is a pairwise-only group, the PoP evidence is a MAC. The Group Manager recomputes the MAC through the same process that is taken by the joining node when preparing the value of the 'client_cred_verify' parameter for the Join Request (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>), with the difference that the Group Manager uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the joining node. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Join Request.<a href="#section-6.2-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-8">The Group Manager <span class="bcp14">MUST</span> reply with a 5.03 (Service Unavailable) error response in the following cases:<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-9.1">
            <p id="section-6.2-9.1.1">There are currently no OSCORE Sender IDs available to assign in the OSCORE group and, at the same time, the joining node is not going to join the group exclusively as monitor. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 4 ("No available individual keying material").<a href="#section-6.2-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-9.2">
            <p id="section-6.2-9.2.1">The OSCORE group that the joining node has been trying to join is currently inactive (see <a href="#ssec-resource-active" class="auto internal xref">Section 8.2</a>). The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 9 ("Group currently not active").<a href="#section-6.2-9.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-10">The Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response in the following cases:<a href="#section-6.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-11.1">
            <p id="section-6.2-11.1.1">The 'scope' parameter is not present in the Join Request, or it is present and specifies any of the following sets of roles: ("requester", "monitor") and ("responder", "monitor").<a href="#section-6.2-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-11.2">
            <p id="section-6.2-11.2.1">The joining node is not going to join the group exclusively as monitor, and any of the following holds:<a href="#section-6.2-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-11.2.2.1">
                <p id="section-6.2-11.2.2.1.1">The joining node is not a current member of the group, and the 'client_cred' parameter and the 'client_cred_verify' parameter are not both present in the Join Request.<a href="#section-6.2-11.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-11.2.2.2">
                <p id="section-6.2-11.2.2.2.1">The 'client_cred' parameter is present in the Join Request and its value is not an eligible authentication credential (e.g., it is not of the format accepted in the group).<a href="#section-6.2-11.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.2-12">In order to prevent the acceptance of Ed25519 and Ed448 public keys that cannot be successfully converted to Montgomery coordinates, and thus cannot be used for the derivation of pairwise keys (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.5.1" class="relref">Section 2.5.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the Group Manager <span class="bcp14">MAY</span> reply with a 4.00 (Bad Request) error response in case all the following conditions hold:<a href="#section-6.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-13.1">
            <p id="section-6.2-13.1.1">The OSCORE group uses the pairwise mode of Group OSCORE.<a href="#section-6.2-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-13.2">
            <p id="section-6.2-13.2.1">The OSCORE group uses EdDSA public keys <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>.<a href="#section-6.2-13.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-13.3">
            <p id="section-6.2-13.3.1">The authentication credential of the joining node from the 'client_cred' parameter includes a public key which:<a href="#section-6.2-13.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-13.3.2.1">
                <p id="section-6.2-13.3.2.1.1">Is for the elliptic curve Ed25519 and has its Y coordinate equal to -1 or 1 (mod p), with p = (2<sup>255</sup> - 19), see <span><a href="https://rfc-editor.org/rfc/rfc7748#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>; or<a href="#section-6.2-13.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-13.3.2.2">
                <p id="section-6.2-13.3.2.2.1">Is for the elliptic curve Ed448 and has its Y coordinate equal to -1 or 1 (mod p), with p =  (2<sup>448</sup> - 2<sup>224</sup> - 1), see <span><a href="https://rfc-editor.org/rfc/rfc7748#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-6.2-13.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.2-14">A 4.00 (Bad Request) error response from the Group Manager to the joining node <span class="bcp14">MUST</span> have Content-Format "application/ace-groupcomm+cbor". The response payload is a CBOR map formatted as follows:<a href="#section-6.2-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-15.1">
            <p id="section-6.2-15.1.1">If the group uses (also) the group mode of Group OSCORE, then the CBOR map <span class="bcp14">MUST</span> contain the 'sign_info' parameter, whose CBOR label is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. This parameter has the same format of 'sign_info_res' defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3.1" class="relref">Section 3.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and includes a single element 'sign_info_entry', which pertains to the OSCORE group that the joining node has tried to join with the Join Request.<a href="#section-6.2-15.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-15.2">
            <p id="section-6.2-15.2.1">If the group uses (also) the pairwise mode of Group OSCORE, then the CBOR map <span class="bcp14">MUST</span> contain the 'ecdh_info' parameter, whose CBOR label is defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="auto internal xref">Section 16.3</a>. This parameter has the same format of 'ecdh_info_res' defined in <a href="#ecdh-info" class="auto internal xref">Section 5.3.1</a> and includes a single element 'ecdh_info_entry', which pertains to the OSCORE group that the joining node has tried to join with the Join Request.<a href="#section-6.2-15.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-15.3">
            <p id="section-6.2-15.3.1">If the group is a pairwise-only group, the CBOR map <span class="bcp14">MUST</span> contain the 'kdc_dh_creds' parameter, whose CBOR label is defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="auto internal xref">Section 16.3</a>. This parameter has the same format of 'kdc_dh_creds_res' defined in <a href="#gm-dh-info" class="auto internal xref">Section 5.3.2</a> and includes a single element 'kdc_dh_creds_entry', which pertains to the OSCORE group that the joining node has tried to join with the Join Request.<a href="#section-6.2-15.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-15.4">
            <p id="section-6.2-15.4.1">The CBOR map <span class="bcp14">MAY</span> include the 'kdcchallenge' parameter, whose CBOR label is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. If present, this parameter is a CBOR byte string, which encodes a newly generated 'kdcchallenge' value that the Client can use when preparing a new Join Request (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>). In such a case the Group Manager <span class="bcp14">MUST</span> store the newly generated value as the 'kdcchallenge' value associated with the joining node, thus replacing the currently stored value (if any).<a href="#section-6.2-15.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="follow-up-to-a-400-bad-request-error-response">
<section id="section-6.2.1">
          <h4 id="name-follow-up-to-a-400-bad-requ">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-follow-up-to-a-400-bad-requ" class="section-name selfRef">Follow-up to a 4.00 (Bad Request) Error Response</a>
          </h4>
<p id="section-6.2.1-1">When receiving a 4.00 (Bad Request) error response, the joining node <span class="bcp14">MAY</span> send a new Join Request to the Group Manager. In such a case:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-2.1">
              <p id="section-6.2.1-2.1.1">The 'cnonce' parameter <span class="bcp14">MUST</span> include a new dedicated nonce N_C generated by the joining node.<a href="#section-6.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-2.2">
              <p id="section-6.2.1-2.2.1">In case the joining node is going to join the group exclusively as monitor, then the following applies:<a href="#section-6.2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-2.2.2.1">
                  <p id="section-6.2.1-2.2.2.1.1">If present, the 'client_cred' parameter <span class="bcp14">MUST</span> include an authentication credential in the format indicated by the Group Manager. Also, the authentication credential as well as the included public key <span class="bcp14">MUST</span> be compatible with the signature or ECDH algorithm, and with possible associated parameters.<a href="#section-6.2.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.2.1-2.2.2.2">
                  <p id="section-6.2.1-2.2.2.2.1">If present, the 'client_cred_verify' parameter <span class="bcp14">MUST</span> include a PoP evidence computed as described in <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>. The private key to use is the one associated with the authentication credential specified in the current 'client_cred' parameter, with the signature or ECDH algorithm, and with possible associated parameters indicated by the Group Manager. If the error response from the Group Manager includes the 'kdcchallenge' parameter, the joining node <span class="bcp14">MUST</span> use its content as new N_S challenge to compute the PoP evidence.<a href="#section-6.2.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ssec-join-resp">
<section id="section-6.3">
        <h3 id="name-send-the-join-response">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-send-the-join-response" class="section-name selfRef">Send the Join Response</a>
        </h3>
<p id="section-6.3-1">If the processing of the Join Request described in <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a> is successful, the Group Manager updates the group membership by registering the joining node NODENAME as a new member of the OSCORE group GROUPNAME, as described in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">If the joining node has not taken exclusively the role of monitor, the Group Manager performs also the following actions.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-3.1">
            <p id="section-6.3-3.1.1">The Group Manager selects an available OSCORE Sender ID in the OSCORE group, and exclusively assigns it to the joining node. The Group Manager <span class="bcp14">MUST NOT</span> assign an OSCORE Sender ID to the joining node if this joins the group exclusively with the role of monitor, according to what is specified in the access token (see <a href="#ssec-auth-resp" class="auto internal xref">Section 5.2</a>).<a href="#section-6.3-3.1.1" class="pilcrow">¶</a></p>
<p id="section-6.3-3.1.2">
Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2.1.2" class="relref">Section 12.2.1.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager <span class="bcp14">MUST</span> assign an OSCORE Sender ID that has not been used in the OSCORE group since the latest time when the current Gid value was assigned to the group. The maximum length of a Sender ID in bytes is determined as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.2" class="relref">Section 2.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.3-3.1.2" class="pilcrow">¶</a></p>
<p id="section-6.3-3.1.3">
If the joining node is recognized as a current group member, e.g., through the ongoing secure communication association that is used to protect the Join Request, then the following also applies:<a href="#section-6.3-3.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-3.1.4.1">
                <p id="section-6.3-3.1.4.1.1">The Group Manager <span class="bcp14">MUST</span> assign a new OSCORE Sender ID different from the one currently used by the joining node in the OSCORE group.<a href="#section-6.3-3.1.4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-3.1.4.2">
                <p id="section-6.3-3.1.4.2.1">The Group Manager <span class="bcp14">MUST</span> add the old, relinquished OSCORE Sender ID of the joining node to the set of stale Sender IDs associated with the current version of the group keying material for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-6.3-3.1.4.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-3.2">
            <p id="section-6.3-3.2.1">The Group Manager stores the association between: i) the authentication credential of the joining node; and ii) the Group Identifier (Gid), i.e., the OSCORE ID Context associated with the OSCORE group, together with the OSCORE Sender ID assigned to the joining node in the group. The Group Manager <span class="bcp14">MUST</span> keep this association updated over time.<a href="#section-6.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-4">Then, the Group Manager replies to the joining node, providing the updated security parameters and keying material necessary to participate in the group communication. This success Join Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions:<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.1">
            <p id="section-6.3-5.1.1">The 'gkty' parameter identifies a key of type "Group_OSCORE_Input_Material object", which is defined in <a href="#ssec-iana-groupcomm-keys-registry" class="auto internal xref">Section 16.4</a> of this document.<a href="#section-6.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-5.2">
            <p id="section-6.3-5.2.1">The 'key' parameter includes what the joining node needs in order to set up the Group OSCORE Security Context as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.3-5.2.1" class="pilcrow">¶</a></p>
<p id="section-6.3-5.2.2">
This parameter has as value a Group_OSCORE_Input_Material object, which is defined in this document and extends the OSCORE_Input_Material object encoded in CBOR as defined in <span><a href="https://rfc-editor.org/rfc/rfc9203#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>. In particular, it contains the additional parameters 'group_senderId', 'cred_fmt', 'gp_enc_alg', 'sign_alg', 'sign_params', 'ecdh_alg', and 'ecdh_params', which are defined in <a href="#ssec-iana-security-context-parameter-registry" class="auto internal xref">Section 16.6</a> of this document.<a href="#section-6.3-5.2.2" class="pilcrow">¶</a></p>
<p id="section-6.3-5.2.3">
More specifically, the 'key' parameter is composed as follows.<a href="#section-6.3-5.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.2.4.1">
                <p id="section-6.3-5.2.4.1.1">The 'hkdf' parameter, if present, specifies the HKDF Algorithm that is used in the OSCORE group. The HKDF Algorithm is specified by the HMAC Algorithm value. This parameter <span class="bcp14">MAY</span> be omitted, if the HKDF Algorithm used in the group is HKDF SHA-256. Otherwise, this parameter <span class="bcp14">MUST</span> be present.<a href="#section-6.3-5.2.4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.4.2">
                <p id="section-6.3-5.2.4.2.1">The 'salt' parameter, if present, has as value the OSCORE Master Salt that is used in the OSCORE group. This parameter <span class="bcp14">MAY</span> be omitted, if the Master Salt used in the group is the empty byte string. Otherwise, this parameter <span class="bcp14">MUST</span> be present.<a href="#section-6.3-5.2.4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.4.3">
                <p id="section-6.3-5.2.4.3.1">The 'ms' parameter has as value the OSCORE Master Secret that is used in the OSCORE group. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-6.3-5.2.4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.4.4">
                <p id="section-6.3-5.2.4.4.1">The 'contextId' parameter has as value the Group Identifier (Gid), i.e., the OSCORE ID Context of the OSCORE group. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-6.3-5.2.4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.4.5">
                <p id="section-6.3-5.2.4.5.1">The 'group_senderId' parameter has as value the OSCORE Sender ID that the Group Manager has assigned to the joining node in the OSCORE group, as described above. This parameter <span class="bcp14">MUST</span> be present if and only if the node does not join the OSCORE group exclusively with the role of monitor, according to what is specified in the access token (see <a href="#ssec-auth-resp" class="auto internal xref">Section 5.2</a>).<a href="#section-6.3-5.2.4.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.4.6">
                <p id="section-6.3-5.2.4.6.1">The 'cred_fmt' parameter specifies the Authentication Credential Format used in the OSCORE group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This parameter <span class="bcp14">MUST</span> be present and it takes value from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span> (REQ6), with some of those values also indicating the type of container to use for exchanging the authentication credentials with the Group Manager (e.g., a chain or bag of certificates). Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote a format that <span class="bcp14">MUST</span> explicitly provide the public key as well as a comprehensive set of information related to the public key algorithm. This information includes, e.g., the used elliptic curve (when applicable).<a href="#section-6.3-5.2.4.6.1" class="pilcrow">¶</a></p>
<p id="section-6.3-5.2.4.6.2">
At the time of writing this specification, acceptable formats of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-6.3-5.2.4.6.2" class="pilcrow">¶</a></p>
<p id="section-6.3-5.2.4.6.3">
[ As to C509 certificates, the COSE Header Parameters 'c5b' and 'c5c' are under pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-6.3-5.2.4.6.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-6.3-5.2.5">
The 'key' parameter <span class="bcp14">MUST</span> also include the following parameters, if and only if the OSCORE group is not a pairwise-only group.<a href="#section-6.3-5.2.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.2.6.1">
                <p id="section-6.3-5.2.6.1.1">The 'gp_enc_alg' parameter, specifying the Group Encryption Algorithm that is used in the OSCORE group to encrypt messages protected with the group mode. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-6.3-5.2.6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.6.2">
                <p id="section-6.3-5.2.6.2.1">The 'sign_alg' parameter, specifying the Signature Algorithm that is used in the OSCORE group to sign messages protected with the group mode. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-6.3-5.2.6.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.6.3">
                <p id="section-6.3-5.2.6.3.1">The 'sign_params' parameter, specifying the parameters of the Signature Algorithm. This parameter is a CBOR array, which includes the following two elements:<a href="#section-6.3-5.2.6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.2.6.3.2.1">
                    <p id="section-6.3-5.2.6.3.2.1.1">'sign_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the Signature Algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-6.3-5.2.6.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-5.2.6.3.2.2">
                    <p id="section-6.3-5.2.6.3.2.2.1">'sign_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the Signature Algorithm indicated in 'sign_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#section-6.3-5.2.6.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-6.3-5.2.7">
The 'key' parameter <span class="bcp14">MUST</span> also include the following parameters, if and only if the OSCORE group is not a signature-only group.<a href="#section-6.3-5.2.7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.2.8.1">
                <p id="section-6.3-5.2.8.1.1">The 'alg' parameter, specifying the AEAD Algorithm used in the OSCORE group to encrypt messages protected with the pairwise mode.<a href="#section-6.3-5.2.8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.8.2">
                <p id="section-6.3-5.2.8.2.1">The 'ecdh_alg' parameter, specifying the Pairwise Key Agreement Algorithm used in the OSCORE group to derive the pairwise keys for the pairwise mode. This parameter takes values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-6.3-5.2.8.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-5.2.8.3">
                <p id="section-6.3-5.2.8.3.1">The 'ecdh_params' parameter, specifying the parameters of the Pairwise Key Agreement Algorithm. This parameter is a CBOR array, which includes the following two elements:<a href="#section-6.3-5.2.8.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.2.8.3.2.1">
                    <p id="section-6.3-5.2.8.3.2.1.1">'ecdh_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the algorithm indicated in 'ecdh_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-6.3-5.2.8.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-5.2.8.3.2.2">
                    <p id="section-6.3-5.2.8.3.2.2.1">'ecdh_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'ecdh_alg', as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#section-6.3-5.2.8.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-6.3-5.2.9">
The format of 'key' defined above is consistent with every signature algorithm and ECDH algorithm currently considered in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs-key" class="auto internal xref">Appendix B.2</a> of this document describes how the format of the 'key' parameter can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-6.3-5.2.9" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-6">Furthermore, the following applies.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-7.1">
            <p id="section-6.3-7.1.1">The 'exi' parameter <span class="bcp14">MUST</span> be present.<a href="#section-6.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.2">
            <p id="section-6.3-7.2.1">The 'ace_groupcomm_profile' parameter <span class="bcp14">MUST</span> be present and has value coap_group_oscore_app (PROFILE_TBD), which is registered in <a href="#ssec-iana-groupcomm-profile-registry" class="auto internal xref">Section 16.5</a> of this document.<a href="#section-6.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.3">
            <p id="section-6.3-7.3.1">The 'creds' parameter, if present, specifies the authentication credentials requested by the joining node by means of the 'get_creds' parameter that was specified in the Join Request.<a href="#section-6.3-7.3.1" class="pilcrow">¶</a></p>
<p id="section-6.3-7.3.2">
If the joining node has asked for the authentication credentials of all the group members, i.e., the 'get_creds' parameter in the Join Request had value the CBOR Simple Value <code>null</code> (0xf6), then the Group Manager provides only the authentication credentials of the group members that are relevant to the joining node. That is, in such a case, the 'creds' parameter specifies only: i) the authentication credentials of the responders currently in the OSCORE group, in case the joining node is configured (also) as requester; and ii) the authentication credentials of the requesters currently in the OSCORE group, in case the joining node is configured (also) as responder or monitor.<a href="#section-6.3-7.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.4">
            <p id="section-6.3-7.4.1">The 'peer_identifiers' parameter, if present, specifies the OSCORE Sender ID of each group member whose authentication credential is specified in the 'creds' parameter. That is, a group member's Sender ID is used as identifier for that group member (REQ25).<a href="#section-6.3-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.5">
            <p id="section-6.3-7.5.1">The 'group_policies' parameter <span class="bcp14">SHOULD</span> be present, and <span class="bcp14">SHOULD</span> include the following elements:<a href="#section-6.3-7.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-7.5.2.1">
                <p id="section-6.3-7.5.2.1.1">"Key Update Check Interval" (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), with default value 3600;<a href="#section-6.3-7.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-7.5.2.2">
                <p id="section-6.3-7.5.2.2.1">"Expiration Delta" (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), with default value 0.<a href="#section-6.3-7.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-7.6">
            <p id="section-6.3-7.6.1">The 'kdc_cred' parameter <span class="bcp14">MUST</span> be present, specifying the Group Manager's authentication credential in its original binary representation (REQ8). The Group Manager's authentication credential <span class="bcp14">MUST</span> be in the format used in the OSCORE group. Also, the authentication credential as well as the included public key <span class="bcp14">MUST</span> be compatible with the signature or ECDH algorithm, and with possible associated parameters used in the OSCORE group.<a href="#section-6.3-7.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.7">
            <p id="section-6.3-7.7.1">The 'kdc_nonce' parameter <span class="bcp14">MUST</span> be present, specifying the dedicated nonce N_KDC generated by the Group Manager. For N_KDC, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce.<a href="#section-6.3-7.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-7.8">
            <p id="section-6.3-7.8.1">The 'kdc_cred_verify' parameter <span class="bcp14">MUST</span> be present, specifying the proof-of-possession (PoP) evidence computed by the Group Manager. The PoP evidence is computed as defined below (REQ21).<a href="#section-6.3-7.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-7.8.2.1">
                <p id="section-6.3-7.8.2.1.1">If the group is not a pairwise-only group, then the PoP evidence <span class="bcp14">MUST</span> be a signature. The Group Manager computes the signature by using the signature algorithm used in the OSCORE group, as well as its own private key associated with the authentication credential specified in the 'kdc_cred' parameter.<a href="#section-6.3-7.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-7.8.2.2">
                <p id="section-6.3-7.8.2.2.1">If the group is a pairwise-only group, then the PoP evidence <span class="bcp14">MUST</span> be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>.<a href="#section-6.3-7.8.2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.3-7.8.2.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-6.3-7.8.2.2.2" class="pilcrow">¶</a></p>
<p id="section-6.3-7.8.2.2.3">
The input parameters of HKDF are as follows.<a href="#section-6.3-7.8.2.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-7.8.2.2.4.1">
                    <p id="section-6.3-7.8.2.2.4.1.1">salt takes as value the empty byte string.<a href="#section-6.3-7.8.2.2.4.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-7.8.2.2.4.2">
                    <p id="section-6.3-7.8.2.2.4.2.1">IKM is computed as a cofactor Diffie-Hellman shared secret, see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="cite xref">NIST-800-56A</a>]</span>, using the ECDH algorithm used in the OSCORE group. The Group Manager uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the joining node. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-6.3-7.8.2.2.4.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-7.8.2.2.4.3">
                    <p id="section-6.3-7.8.2.2.4.3.1">info takes as value the PoP input.<a href="#section-6.3-7.8.2.2.4.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-7.8.2.2.4.4">
                    <p id="section-6.3-7.8.2.2.4.4.1">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-6.3-7.8.2.2.4.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-7.9">
            <p id="section-6.3-7.9.1">The 'group_rekeying' parameter <span class="bcp14">MAY</span> be omitted, if the Group Manager uses the "Point-to-Point" group rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> as rekeying scheme in the OSCORE group (OPT9). Its detailed use for this profile is defined in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a> of this document. In any other case, the 'group_rekeying' parameter <span class="bcp14">MUST</span> be included.<a href="#section-6.3-7.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-8">As a last action, if the Group Manager reassigns Gid values during the group's lifetime (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2.1.1" class="relref">12.2.1.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#appendix-E" class="relref">E</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), then the Group Manager <span class="bcp14">MUST</span> store the Gid specified in the 'contextId' parameter of the 'key' parameter, as the Birth Gid of the joining node in the joined group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#appendix-E" class="relref">Appendix E</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This applies also in case the joining node is in fact re-joining the group; in such a case, the newly determined Birth Gid overwrites the one currently stored.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-join-resp-processing">
<section id="section-6.4">
        <h3 id="name-receive-the-join-response">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-receive-the-join-response" class="section-name selfRef">Receive the Join Response</a>
        </h3>
<p id="section-6.4-1">Upon receiving the Join Response, the joining node retrieves the Group Manager's authentication credential from the 'kdc_cred' parameter. The joining node <span class="bcp14">MUST</span> verify the proof-of-possession (PoP) evidence specified in the 'kdc_cred_verify' parameter of the Join Response as defined below (REQ21).<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
            <p id="section-6.4-2.1.1">If the group is not a pairwise-only group, the PoP evidence is a signature. The joining node verifies it by using the public key of the Group Manager from the received authentication credential, as well as the signature algorithm used in the OSCORE group and possible corresponding parameters.<a href="#section-6.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">If the group is a pairwise-only group, the PoP evidence is a MAC. The joining node recomputes the MAC through the same process that is taken by the Group Manager when computing the value of the 'kdc_cred_verify' parameter (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>), with the difference that the joining node uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the Group Manager from the received authentication credential. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Join Response.<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-3">In case of failed verification of the PoP evidence, the joining node <span class="bcp14">MUST</span> stop processing the Join Response and <span class="bcp14">MAY</span> send a new Join Request to the Group Manager (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>).<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">In case of successful verification of the PoP evidence, the joining node uses the information received in the Join Response to set up the Group OSCORE Security Context, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. In particular, the following applies.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">If the following parameters were not included in the 'key' parameter of the Join Response, then the joining node performs the following actions.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-6.1">
            <p id="section-6.4-6.1.1">Absent the 'gp_enc_alg' parameter, the parameter Group Encryption Algorithm in the Common Context of the Group OSCORE Security Context is not set.<a href="#section-6.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-6.2">
            <p id="section-6.4-6.2.1">Absent the 'sign_alg' parameter, the parameter Signature Algorithm in the Common Context of the Group OSCORE Security Context is not set.<a href="#section-6.4-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-6.3">
            <p id="section-6.4-6.3.1">Absent the 'alg' parameter, the parameter AEAD Algorithm in the Security Context of the Group OSCORE Security Context is not set.<a href="#section-6.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-6.4">
            <p id="section-6.4-6.4.1">Absent the 'ecdh_alg' parameter, the parameter Pairwise Key Agreement Algorithm in the Common Context of the Group OSCORE Security Context is not set.<a href="#section-6.4-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-7">If the following parameters were not included in the 'key' parameter of the Join Response, then the joining node considers the default values specified below, consistently with <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-8.1">
            <p id="section-6.4-8.1.1">Absent the 'hkdf' parameter, the joining node considers HKDF SHA-256 as the HKDF Algorithm to use in the OSCORE group.<a href="#section-6.4-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-8.2">
            <p id="section-6.4-8.2.1">Absent the 'salt' parameter, the joining node considers the empty byte string as the Master Salt to use in the OSCORE group.<a href="#section-6.4-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-8.3">
            <p id="section-6.4-8.3.1">Absent the 'group_rekeying' parameter, the joining node considers the "Point-to-Point" group rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> as the rekeying scheme used in the OSCORE group (OPT9). The detailed use of that rekeying scheme for this profile is defined in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a> of this document.<a href="#section-6.4-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-9">In addition, the joining node maintains an association between each authentication credential retrieved from the 'creds' parameter and the role(s) that the corresponding group member has in the OSCORE group.<a href="#section-6.4-9" class="pilcrow">¶</a></p>
<p id="section-6.4-10">From then on, the joining node can exchange group messages secured with Group OSCORE as described in <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. When doing so:<a href="#section-6.4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-11.1">
            <p id="section-6.4-11.1.1">The joining node <span class="bcp14">MUST NOT</span> process an incoming request message, if protected by a group member whose authentication credential is not associated with the role "Requester".<a href="#section-6.4-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-11.2">
            <p id="section-6.4-11.2.1">The joining node <span class="bcp14">MUST NOT</span> process an incoming response message, if protected by a group member whose authentication credential is not associated with the role "Responder".<a href="#section-6.4-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-11.3">
            <p id="section-6.4-11.3.1">The joining node <span class="bcp14">MUST NOT</span> use the group mode of Group OSCORE to process messages in the group, if the Join Response did not include both the 'gp_enc_alg' parameter and the 'sign_alg' parameter.<a href="#section-6.4-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-11.4">
            <p id="section-6.4-11.4.1">The joining node <span class="bcp14">MUST NOT</span> use the pairwise mode of Group OSCORE to process messages in the group, if the Join Response did not include both the 'alg' parameter and the 'ecdh_alg' parameter.<a href="#section-6.4-11.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-12">If the application requires backward security, the Group Manager <span class="bcp14">MUST</span> generate updated security parameters and group keying material, and provide it to the current group members, upon the new node's joining (see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>). In such a case, the joining node is not able to access secure communication in the OSCORE group that occurred prior to its joining.<a href="#section-6.4-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-overview-group-rekeying-process">
<section id="section-7">
      <h2 id="name-overview-of-the-group-rekey">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-overview-of-the-group-rekey" class="section-name selfRef">Overview of the Group Rekeying Process</a>
      </h2>
<p id="section-7-1">In a number of cases, the Group Manager has to generate new keying material and distribute it to the group (rekeying), as also discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">To this end the Group Manager <span class="bcp14">MUST</span> support the Group Rekeying Process described in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a> of this document, as an instance of the "Point-to-Point" rekeying scheme defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Future documents may define the use of alternative group rekeying schemes for this application profile, together with the corresponding rekeying message formats. The resulting group rekeying process <span class="bcp14">MUST</span> comply with the functional steps defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Upon generating the new group keying material and before starting its distribution, the Group Manager <span class="bcp14">MUST</span> increment the version number of the group keying material. When rekeying a group, the Group Manager <span class="bcp14">MUST</span> preserve the current value of the OSCORE Sender ID of each member in that group.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The data distributed to a group through a rekeying <span class="bcp14">MUST</span> include:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1">The new version number of the group keying material for the group.<a href="#section-7-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.2">
          <p id="section-7-5.2.1">A new Group Identifier (Gid) for the group as introduced in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, which is used as ID Context parameter of the Group OSCORE Common Security Context of that group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-7-5.2.1" class="pilcrow">¶</a></p>
<p id="section-7-5.2.2">
Note that the Gid differs from the group name also introduced in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, which is a plain, stable, and invariant identifier, with no cryptographic relevance and meaning.<a href="#section-7-5.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.3">
          <p id="section-7-5.3.1">A new value for the Master Secret parameter of the Group OSCORE Common Security Context of that group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-7-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.4">
          <p id="section-7-5.4.1">A set of stale Sender IDs, which allows each rekeyed node to purge authentication credentials and Recipient Contexts used in the group and associated with those Sender IDs. This in turn allows every group member to rely on stored authentication credentials, in order to confidently assert the group membership of other sender nodes, when receiving protected messages in the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). More details on the maintenance of stale Sender IDs are provided in <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>.<a href="#section-7-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-6">The data distributed through a group rekeying <span class="bcp14">MAY</span> also include a new value for the Master Salt parameter of the Group OSCORE Common Security Context of that group.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">The Group Manager <span class="bcp14">MUST</span> rekey the group in the following cases.<a href="#section-7-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-8.1">
          <p id="section-7-8.1.1">The application requires backward security - In this case, the group is rekeyed when a node joins the group as a new member. Therefore, a joining node cannot access communications in the group prior to its joining.<a href="#section-7-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-8.2">
          <p id="section-7-8.2.1">One or more nodes leave the group - That is, the group is rekeyed when one or more current members spontaneously request to leave the group (see <a href="#sec-leave-req" class="auto internal xref">Section 9.11</a>), or when the Group Manager forcibly evicts them from the group, e.g., due to expired or revoked authorization (see <a href="#sec-leaving" class="auto internal xref">Section 10</a>). Therefore, a leaving node cannot access communications in the group after its leaving, thus ensuring forward security in the group.<a href="#section-7-8.2.1" class="pilcrow">¶</a></p>
<p id="section-7-8.2.2">
Due to the set of stale Sender IDs distributed through the rekeying, this ensures that a node storing the latest group keying material does not store the authentication credentials of former group members (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">12.2</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-13.1" class="relref">13.1</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-7-8.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-9">When the expiration time for the group keying material approaches or has passed, the Group Manager may want to extend the secure group operation, as considered appropriate. If the Group Manager does so, the Group Manager <span class="bcp14">MUST</span> rekey the group.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">The Group Manager <span class="bcp14">MAY</span> rekey the group for other reasons, e.g., according to an application-specific rekeying period or scheduling.<a href="#section-7-10" class="pilcrow">¶</a></p>
<div id="sssec-stale-sender-ids">
<section id="section-7.1">
        <h3 id="name-stale-oscore-sender-ids">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-stale-oscore-sender-ids" class="section-name selfRef">Stale OSCORE Sender IDs</a>
        </h3>
<p id="section-7.1-1">For each OSCORE group, the Group Manager <span class="bcp14">MUST</span> maintain N &gt; 1 sets of "stale" OSCORE Sender IDs. It is up to the application to specify the value of N, possibly on a per-group basis.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Each set is uniquely associated with one version of the group keying material, and includes the OSCORE Sender IDs that have become "stale" in the OSCORE group under that version of the group keying material.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">In the following cases, the Group Manager <span class="bcp14">MUST</span> add an element to the set X associated with the current version of the group keying material.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.1">
            <p id="section-7.1-4.1.1">When a current group member obtains a new Sender ID, its old Sender ID is added to X. This happens when the Group Manager assigns a new Sender ID upon request from the group member (see <a href="#sec-new-key" class="auto internal xref">Section 9.2</a>), or in case the group member re-joins the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a> and <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>), thus also obtaining a new Sender ID.<a href="#section-7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.2">
            <p id="section-7.1-4.2.1">When a current group member leaves the group, its current Sender ID is added to X. This happens when a group member requests to leave the group (see <a href="#sec-leave-req" class="auto internal xref">Section 9.11</a>) or is forcibly evicted from the group (see <a href="#sec-leaving" class="auto internal xref">Section 10</a>).<a href="#section-7.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-5">The value of N can change during the lifetime of the group. If the new value N' is smaller than N, then the Group Manager <span class="bcp14">MUST</span> preserve the sets associated with the (up to) N' most recent versions of the group keying material.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">When performing a group rekeying (see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>) for switching from an old version V of the group keying material to a new version V' = (V + 1), the Group Manager <span class="bcp14">MUST</span> perform the following actions.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-7.1">
            <p id="section-7.1-7.1.1">Before creating the new group keying material with version V', if the number of sets of stale Sender IDs for the group is equal to N, then the Group Manager deletes the oldest set.<a href="#section-7.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-7.2">
            <p id="section-7.1-7.2.1">The Group Manager rekeys the group. This includes also distributing the set of stale Sender IDs associated with the version V of the group keying material (see <a href="#ssec-overview-group-rekeying-process" class="auto internal xref">Section 7</a>).<a href="#section-7.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-7.3">
            <p id="section-7.1-7.3.1">After completing the group rekeying, the Group Manager creates an empty set of stale Sender IDs, as associated with the version V' of the group keying material.<a href="#section-7.1-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-interface-GM">
<section id="section-8">
      <h2 id="name-interface-at-the-group-mana">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-interface-at-the-group-mana" class="section-name selfRef">Interface at the Group Manager</a>
      </h2>
<p id="section-8-1">The Group Manager provides the interface defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">The new FETCH handler is defined for the sub-resource /ace-group/GROUPNAME/kdc-cred (see <a href="#sec-gm-pub-key-fetch" class="auto internal xref">Section 8.1</a> of this document).<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Three new sub-resources are defined (see <a href="#ssec-resource-active" class="auto internal xref">Section 8.2</a>, <a href="#ssec-resource-verif-data" class="auto internal xref">Section 8.3</a>, and <a href="#ssec-resource-stale-sids" class="auto internal xref">Section 8.4</a> of this document).<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-3"><a href="#ssec-admitted-methods" class="auto internal xref">Section 8.5</a> provides a summary of the CoAP methods admitted to access different resources at the Group Manager, for nodes with different roles in the group or as non members (REQ11).<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The GROUPNAME segment of the URI path <span class="bcp14">MUST</span> match with the group name specified in the scope entry of the scope in the access token (i.e., 'gname' in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>) (REQ7).<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">The Resource Type (rt=) Link Target Attribute value "core.osc.gm" is registered in <a href="#iana-rt" class="auto internal xref">Section 16.10</a> (REQ10), and can be used to describe group-membership resources and its sub-resources at a Group Manager, e.g., by using a CoRE link-format document <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Applications can use this common resource type to discover links to group-membership resources for joining OSCORE groups, e.g., by using the approach described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-8-6" class="pilcrow">¶</a></p>
<div id="sec-gm-pub-key-fetch">
<section id="section-8.1">
        <h3 id="name-ace-group-groupname-kdc-cre">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-ace-group-groupname-kdc-cre" class="section-name selfRef">/ace-group/GROUPNAME/kdc-cred</a>
        </h3>
<p id="section-8.1-1">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this resource also implements a FETCH handler.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div id="kdc-cred-fetch">
<section id="section-8.1.1">
          <h4 id="name-fetch-handler">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-fetch-handler" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-8.1.1-1">The handler expects a FETCH request, whose payload is a CBOR map including a nonce N_C (see <a href="#sec-gm-pub-key-signature-verifier" class="auto internal xref">Section 9.5.2</a>).<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1.1-2">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the Group Manager performs the following checks.<a href="#section-8.1.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1.1-3">In case the requesting Client is a current group member, the Group Manager <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 8 ("Operation permitted only to signature verifiers").<a href="#section-8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1.1-4">In case GROUPNAME denotes a pairwise-only group, the Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 7 ("Signatures not used in the group").<a href="#section-8.1.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1.1-5">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying the authentication credential of the Group Manager together with a proof-of-possession (PoP) evidence. The payload of the response is formatted as defined in <a href="#sec-gm-pub-key-signature-verifier" class="auto internal xref">Section 9.5.2</a>.<a href="#section-8.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-resource-active">
<section id="section-8.2">
        <h3 id="name-ace-group-groupname-active">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ace-group-groupname-active" class="section-name selfRef">/ace-group/GROUPNAME/active</a>
        </h3>
<p id="section-8.2-1">This resource implements a GET handler.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div id="active-get">
<section id="section-8.2.1">
          <h4 id="name-get-handler">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-get-handler" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-8.2.1-1">The handler expects a GET request.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the handler verifies that the requesting Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying the current status of the group, i.e., active or inactive. The payload of the response is formatted as defined in <a href="#sec-status" class="auto internal xref">Section 9.9</a>.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4">The method to set the current group status is out of the scope of this document, and is defined for the administrator interface of the Group Manager specified in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="cite xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-resource-verif-data">
<section id="section-8.3">
        <h3 id="name-ace-group-groupname-verif-d">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-ace-group-groupname-verif-d" class="section-name selfRef">/ace-group/GROUPNAME/verif-data</a>
        </h3>
<p id="section-8.3-1">This resource implements a GET handler.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div id="verif-data-get">
<section id="section-8.3.1">
          <h4 id="name-get-handler-2">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-get-handler-2" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-8.3.1-1">The handler expects a GET request.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the handler performs the following actions.<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1-3">In case the requesting Client is a current group member, the Group Manager <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 8 ("Operation permitted only to signature verifiers").<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<p id="section-8.3.1-4">In case GROUPNAME denotes a pairwise-only group, the Group Manager <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 7 ("Signatures not used in the group").<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
<p id="section-8.3.1-5">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying data that allow also an external signature verifier to verify signatures of messages protected with the group mode and sent to the group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7.5" class="relref">7.5</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.3" class="relref">12.3</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The response <span class="bcp14">MUST</span> have Content-Format set to "application/ace-groupcomm+cbor". The payload of the response is a CBOR map, which is formatted as defined in <a href="#sec-verif-data" class="auto internal xref">Section 9.6</a>.<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-resource-stale-sids">
<section id="section-8.4">
        <h3 id="name-ace-group-groupname-stale-s">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-ace-group-groupname-stale-s" class="section-name selfRef">/ace-group/GROUPNAME/stale-sids</a>
        </h3>
<p id="section-8.4-1">This resource implements a FETCH handler.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div id="stale-sids-fetch">
<section id="section-8.4.1">
          <h4 id="name-fetch-handler-2">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-fetch-handler-2" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-8.4.1-1">The handler expects a FETCH request, whose payload specifies a version number of the group keying material, encoded as an unsigned CBOR integer (see <a href="#sec-retrieve-stale-sids" class="auto internal xref">Section 11.3.1</a>).<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.1-2">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the handler verifies that the requesting Client is a current member of the group. If the verification fails, the Group Manager <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
<p id="section-8.4.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response, specifying data that allow the requesting Client to delete the Recipient Contexts and authentication credentials associated with former members of the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The payload of the response is formatted as defined in <a href="#sec-retrieve-stale-sids" class="auto internal xref">Section 11.3.1</a>.<a href="#section-8.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ssec-admitted-methods">
<section id="section-8.5">
        <h3 id="name-admitted-methods">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-admitted-methods" class="section-name selfRef">Admitted Methods</a>
        </h3>
<p id="section-8.5-1"><a href="#tab-methods" class="auto internal xref">Table 2</a> summarizes the CoAP methods admitted to access different resources at the Group Manager, for (non-)members of a group with group name GROUPNAME, and considering different roles. The last two rows of the table apply to a node with node name NODENAME.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">The table uses the following abbreviations.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-3.1">
            <p id="section-8.5-3.1.1">G = CoAP method GET<a href="#section-8.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.2">
            <p id="section-8.5-3.2.1">F = CoAP method FETCH<a href="#section-8.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.3">
            <p id="section-8.5-3.3.1">P = CoAP method POST<a href="#section-8.5-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.4">
            <p id="section-8.5-3.4.1">D = CoAP method DELETE<a href="#section-8.5-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.5">
            <p id="section-8.5-3.5.1">Type1 = Member as Requester and/or Responder<a href="#section-8.5-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.6">
            <p id="section-8.5-3.6.1">Type2 = Member as Monitor<a href="#section-8.5-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.7">
            <p id="section-8.5-3.7.1">Type3 = Non-member (authorized to be signature verifier)<a href="#section-8.5-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.8">
            <p id="section-8.5-3.8.1">Type4 = Non-member (not authorized to be signature verifier)<a href="#section-8.5-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.5-3.9">
            <p id="section-8.5-3.9.1">* = Cannot join the group as signature verifier<a href="#section-8.5-3.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-admitted-coap-methods-on-th"></span><div id="tab-methods">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-admitted-coap-methods-on-th" class="selfRef">Admitted CoAP Methods on the Group Manager Resources</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Resource</th>
              <th class="text-left" rowspan="1" colspan="1">Type1</th>
              <th class="text-left" rowspan="1" colspan="1">Type2</th>
              <th class="text-left" rowspan="1" colspan="1">Type3</th>
              <th class="text-left" rowspan="1" colspan="1">Type4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME</td>
              <td class="text-left" rowspan="1" colspan="1">G P</td>
              <td class="text-left" rowspan="1" colspan="1">G P</td>
              <td class="text-left" rowspan="1" colspan="1">P *</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/active</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/verif-data</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/creds</td>
              <td class="text-left" rowspan="1" colspan="1">G F</td>
              <td class="text-left" rowspan="1" colspan="1">G F</td>
              <td class="text-left" rowspan="1" colspan="1">G F</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/kdc-cred</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/stale-sids</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/policies</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/num</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/nodes/NODENAME</td>
              <td class="text-left" rowspan="1" colspan="1">G P D</td>
              <td class="text-left" rowspan="1" colspan="1">G D</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">/ace-group/GROUPNAME/nodes/NODENAME/cred</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="signature-verifiers">
<section id="section-8.5.1">
          <h4 id="name-signature-verifiers">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-signature-verifiers" class="section-name selfRef">Signature Verifiers</a>
          </h4>
<p id="section-8.5.1-1">Just like any candidate group member, a signature verifier provides the Group Manager with an access token, as described in <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>. However, unlike candidate group members, it does not join any OSCORE group, i.e., it does not perform the joining process defined in <a href="#sec-joining-node-to-GM" class="auto internal xref">Section 6</a>.<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
<p id="section-8.5.1-2">After successfully transferring an access token to the Group Manager, a signature verifier is allowed to perform only some operations as non-member of a group, and only for the OSCORE groups specified in the validated access token. These are the operations specified in <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>, <a href="#sec-gm-pub-key" class="auto internal xref">Section 9.5</a>, <a href="#sec-verif-data" class="auto internal xref">Section 9.6</a>, and <a href="#sec-retrieve-gnames" class="auto internal xref">Section 9.10</a>.<a href="#section-8.5.1-2" class="pilcrow">¶</a></p>
<p id="section-8.5.1-3">Consistently, in case a node is not a member of the group with group name GROUPNAME and is authorized to be only signature verifier for that group, the Group Manager <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response if that node attempts to access any other endpoint than the following ones:<a href="#section-8.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5.1-4.1">
              <p id="section-8.5.1-4.1.1">/ace-group<a href="#section-8.5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.5.1-4.2">
              <p id="section-8.5.1-4.2.1">/ace-group/GROUPNAME/verif-data<a href="#section-8.5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.5.1-4.3">
              <p id="section-8.5.1-4.3.1">/ace-group/GROUPNAME/creds<a href="#section-8.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.5.1-4.4">
              <p id="section-8.5.1-4.4.1">/ace-group/GROUPNAME/kdc-cred<a href="#section-8.5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="client-operations">
<section id="section-8.6">
        <h3 id="name-operations-supported-by-cli">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-operations-supported-by-cli" class="section-name selfRef">Operations Supported by Clients</a>
        </h3>
<p id="section-8.6-1">Building on what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and with reference to the resources at the Group Manager newly defined earlier in <a href="#sec-interface-GM" class="auto internal xref">Section 8</a> of this document, it is expected that a Client minimally supports also the following set of operations and corresponding interactions with the Group Manager (REQ12).<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.6-2.1">
            <p id="section-8.6-2.1.1">GET request to /ace-group/GROUPNAME/active, in order to check the current status of the OSCORE group.<a href="#section-8.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.6-2.2">
            <p id="section-8.6-2.2.1">GET request to /ace-group/GROUPNAME/verif-data, in order for a signature verifier to retrieve data required to verify signatures of messages protected with the group mode of Group OSCORE and sent to a group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.3" class="relref">12.3</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7.5" class="relref">7.5</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). Note that this operation is relevant to support only to signature verifiers.<a href="#section-8.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.6-2.3">
            <p id="section-8.6-2.3.1">FETCH request to /ace-group/GROUPNAME/stale-sids, in order to retrieve from the Group Manager the data required to delete some of the stored group members' authentication credentials and associated Recipient Contexts (see <a href="#stale-sids-fetch" class="auto internal xref">Section 8.4.1</a>). This data is provided as an aggregated set of stale Sender IDs, which are used as specified in <a href="#missed-rekeying" class="auto internal xref">Section 11.3</a>.<a href="#section-8.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-additional-interactions">
<section id="section-9">
      <h2 id="name-additional-interactions-wit">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-additional-interactions-wit" class="section-name selfRef">Additional Interactions with the Group Manager</a>
      </h2>
<p id="section-9-1">This section defines the possible interactions with the Group Manager, in addition to the group joining specified in <a href="#sec-joining-node-to-GM" class="auto internal xref">Section 6</a>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="sec-updated-key">
<section id="section-9.1">
        <h3 id="name-retrieve-updated-keying-mat">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-retrieve-updated-keying-mat" class="section-name selfRef">Retrieve Updated Keying Material</a>
        </h3>
<p id="section-9.1-1">At some point, a group member considers the Group OSCORE Security Context invalid and to be renewed. This happens, for instance, after a number of unsuccessful security processing of incoming messages from other group members, or when the Security Context expires as specified by the 'exp' or 'exi' parameter of the Join Response.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">When this happens, the group member retrieves updated security parameters and group keying material. This can occur in the two different ways described below.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<div id="ssec-updated-key-only">
<section id="section-9.1.1">
          <h4 id="name-get-group-keying-material">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-get-group-keying-material" class="section-name selfRef">Get Group Keying Material</a>
          </h4>
<p id="section-9.1.1-1">If the group member wants to retrieve only the latest group keying material, it sends a Key Distribution Request to the Group Manager.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">That is, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME at the Group Manager.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1.1-3">The Group Manager processes the Key Distribution Request according to <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-4.1">
              <p id="section-9.1.1-4.1.1">The 'key' parameter is formatted as defined in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document, with the difference that it does not include the 'group_SenderId' parameter.<a href="#section-9.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.1-4.2">
              <p id="section-9.1.1-4.2.1">The 'exp' parameter <span class="bcp14">SHOULD</span> be present.<a href="#section-9.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.1-4.3">
              <p id="section-9.1.1-4.3.1">The 'exi' parameter <span class="bcp14">MUST</span> be present.<a href="#section-9.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.1-4.4">
              <p id="section-9.1.1-4.4.1">The 'ace_groupcomm_profile' parameter <span class="bcp14">MUST</span> be present and has value coap_group_oscore_app.<a href="#section-9.1.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.1.1-5">Upon receiving the Key Distribution Response, the group member retrieves the updated security parameters and group keying material, and, if they differ from the current ones, uses them to set up the new Group OSCORE Security Context as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-9.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-updated-and-individual-key">
<section id="section-9.1.2">
          <h4 id="name-get-group-keying-material-a">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-get-group-keying-material-a" class="section-name selfRef">Get Group Keying Material and OSCORE Sender ID</a>
          </h4>
<p id="section-9.1.2-1">If the group member wants to retrieve the latest group keying material as well as the OSCORE Sender ID that it has in the OSCORE group, it sends a Key Distribution Request to the Group Manager.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">That is, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
<p id="section-9.1.2-3">The Group Manager processes the Key Distribution Request according to <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Key Distribution Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.1" class="relref">Section 4.8.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-9.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.2-4.1">
              <p id="section-9.1.2-4.1.1">The 'key' parameter is formatted as defined in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document. If the requesting group member has exclusively the role of monitor, then the 'key' parameter does not include the 'group_SenderId' parameter.<a href="#section-9.1.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-4.1.2">
Note that, in any other case, the current Sender ID of the group member is not specified as a separate parameter, but instead by the 'group_SenderId' parameter within the 'key' parameter.<a href="#section-9.1.2-4.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.2-4.2">
              <p id="section-9.1.2-4.2.1">The 'exp' parameter <span class="bcp14">SHOULD</span> be present.<a href="#section-9.1.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.2-4.3">
              <p id="section-9.1.2-4.3.1">The 'exi' parameter <span class="bcp14">MUST</span> be present.<a href="#section-9.1.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.1.2-5">Upon receiving the Key Distribution Response, the group member retrieves the updated security parameters, group keying material, and Sender ID, and, if they differ from the current ones, uses them to set up the new Group OSCORE Security Context as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-9.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-new-key">
<section id="section-9.2">
        <h3 id="name-request-to-change-individua">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-request-to-change-individua" class="section-name selfRef">Request to Change Individual Keying Material</a>
        </h3>
<p id="section-9.2-1">As discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.6.2" class="relref">Section 2.6.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, a group member may at some point exhaust its Sender Sequence Numbers in the OSCORE group.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">When this happens, the group member <span class="bcp14">MUST</span> send a Key Renewal Request message to the Group Manager, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2.1" class="relref">Section 4.8.2.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends a CoAP POST request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">Upon receiving the Key Renewal Request, the Group Manager processes it as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">The Group Manager <span class="bcp14">MUST</span> return a 5.03 (Service Unavailable) response in case the OSCORE group identified by GROUPNAME is currently inactive (see <a href="#ssec-resource-active" class="auto internal xref">Section 8.2</a>). The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 9 ("Group currently not active").<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">Otherwise, the Group Manager performs one of the following actions.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2-6">
<li id="section-9.2-6.1">
            <p id="section-9.2-6.1.1">If the requesting group member has exclusively the role of monitor, the Group Manager replies with a 4.00 (Bad Request) error response.  The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 1 ("Request inconsistent with the current roles").<a href="#section-9.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.2-6.2">
            <p id="section-9.2-6.2.1">Otherwise, the Group Manager takes one of the following actions.<a href="#section-9.2-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-6.2.2.1">
                <p id="section-9.2-6.2.2.1.1">The Group Manager rekeys the OSCORE group. That is, the Group Manager generates new group keying material for that group (see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>), and replies to the group member with a group rekeying message as defined in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>, providing the new group keying material. Then, the Group Manager rekeys the rest of the OSCORE group, as discussed in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>.<a href="#section-9.2-6.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-9.2-6.2.2.1.2">
The Group Manager <span class="bcp14">SHOULD</span> perform a group rekeying only if already scheduled to  occur shortly, e.g., according to an application-specific rekeying period or scheduling, or as a reaction to a recent change in the group membership. In any other case, the Group Manager <span class="bcp14">SHOULD NOT</span> rekey the OSCORE group when receiving a Key Renewal Request (OPT12).<a href="#section-9.2-6.2.2.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2-6.2.2.2">
                <p id="section-9.2-6.2.2.2.1">The Group Manager selects and assigns a new OSCORE Sender ID for that group member, according to the same criteria defined in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> for selecting and assigning an OSCORE Sender ID to include in a Join Response.<a href="#section-9.2-6.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-9.2-6.2.2.2.2">
Then, the Group Manager replies with a Key Renewal Response formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The CBOR map in the response payload only includes the 'group_SenderId' parameter defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="auto internal xref">Section 16.3</a> of this document, specifying the new Sender ID of the group member encoded as a CBOR byte string.<a href="#section-9.2-6.2.2.2.2" class="pilcrow">¶</a></p>
<p id="section-9.2-6.2.2.2.3">
Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.6.3.1" class="relref">Section 2.6.3.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager <span class="bcp14">MUST</span> assign a new Sender ID that has not been used in the OSCORE group since the latest time when the current Gid value was assigned to the group.<a href="#section-9.2-6.2.2.2.3" class="pilcrow">¶</a></p>
<p id="section-9.2-6.2.2.2.4">
Furthermore, the Group Manager <span class="bcp14">MUST</span> add the old, relinquished Sender ID of the group member to the most recent set of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-9.2-6.2.2.2.4" class="pilcrow">¶</a></p>
<p id="section-9.2-6.2.2.2.5">
The Group Manager <span class="bcp14">MUST</span> return a 5.03 (Service Unavailable) response in case there are currently no Sender IDs available to assign in the OSCORE group. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 4 ("No available individual keying material").<a href="#section-9.2-6.2.2.2.5" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="sec-pub-keys">
<section id="section-9.3">
        <h3 id="name-retrieve-authentication-cre">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-retrieve-authentication-cre" class="section-name selfRef">Retrieve Authentication Credentials of Group Members</a>
        </h3>
<p id="section-9.3-1">A group member or a signature verifier may need to retrieve the authentication credentials of (other) group members. To this end, the group member or signature verifier sends an Authentication Credential Request message to the Group Manager, as per Sections <a href="https://rfc-editor.org/rfc/rfc9594#section-4.4.1.1" class="relref">4.4.1.1</a> and <a href="https://rfc-editor.org/rfc/rfc9594#section-4.4.2.1" class="relref">4.4.2.1</a> of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends the request to the endpoint /ace-group/GROUPNAME/creds at the Group Manager.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">If the Authentication Credential Request uses the method FETCH, then the Authentication Credential Request is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is:<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-3.1">
            <p id="section-9.3-3.1.1">Each element (if any) of the inner CBOR array 'role_filter' is formatted as in the inner CBOR array 'role_filter' of the 'get_creds' parameter of the Join Request when the parameter value is not the CBOR simple value <code>null</code> (0xf6) (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>).<a href="#section-9.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-3.2">
            <p id="section-9.3-3.2.1">Each element (if any) of the inner CBOR array 'id_filter' is a CBOR byte string, which encodes the OSCORE Sender ID of the group member for which the associated authentication credential is requested (REQ25).<a href="#section-9.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-4">Upon receiving the Authentication Credential Request, the Group Manager processes it as per Section 4.4.1 or Section 4.4.2 of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, depending on the request method being FETCH or GET, respectively. Additionally, if the Authentication Credential Request uses the method FETCH, the Group Manager silently ignores node identifiers included in the ’get_creds’ parameter of the request that are not associated with any current group member (REQ26).<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">The success Authentication Credential Response is formatted as defined in Section 4.4.1 or Section 4.4.2 of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, depending on the request method being FETCH or GET, respectively.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-update-pub-key">
<section id="section-9.4">
        <h3 id="name-upload-a-new-authentication">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-upload-a-new-authentication" class="section-name selfRef">Upload a New Authentication Credential</a>
        </h3>
<p id="section-9.4-1">A group member may need to provide the Group Manager with its new authentication credential to use in the group from then on, hence replacing the current one. This can be the case, for instance, if the signature or ECDH algorithm and possible associated parameters used in the OSCORE group have been changed, and the current authentication credential is not compatible with them.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">To this end, the group member sends an Authentication Credential Update Request message to the Group Manager, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.9.1.1" class="relref">Section 4.9.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following addition.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-3.1">
            <p id="section-9.4-3.1.1">The group member computes the proof-of-possession (PoP) evidence included in 'client_cred_verify' in the same way defined in <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a> when preparing a Join Request for the OSCORE group in question (REQ14), with the difference that the 'client_cred_verify' parameter <span class="bcp14">MUST NOT</span> specify an empty PoP evidence.<a href="#section-9.4-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.4-4">That is, the group member sends a CoAP POST request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME/cred at the Group Manager.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
<p id="section-9.4-5">Upon receiving the Authentication Credential Update Request, the Group Manager processes it as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.9.1" class="relref">Section 4.9.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following additions.<a href="#section-9.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-6.1">
            <p id="section-9.4-6.1.1">The N_S challenge that is used to build the proof-of-possession input is computed as defined in <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a> (REQ15).<a href="#section-9.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-6.2">
            <p id="section-9.4-6.2.1">The Group Manager verifies the PoP challenge included in the 'client_cred_verify' parameter in the same way defined in <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a> when processing a Join Request for the OSCORE group in question (REQ14), with the difference that the verification <span class="bcp14">MUST</span> fail if the 'client_cred_verify' parameter specifies an empty PoP evidence.<a href="#section-9.4-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-6.3">
            <p id="section-9.4-6.3.1">The Group Manager <span class="bcp14">MUST</span> return a 5.03 (Service Unavailable) response in case the OSCORE group identified by GROUPNAME is currently inactive (see <a href="#ssec-resource-active" class="auto internal xref">Section 8.2</a>). The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 9 ("Group currently not active").<a href="#section-9.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-6.4">
            <p id="section-9.4-6.4.1">If the requesting group member has exclusively the role of monitor, the Group Manager replies with a 4.00 (Bad request) error response. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 1 ("Request inconsistent with the current roles").<a href="#section-9.4-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-6.5">
            <p id="section-9.4-6.5.1">If the request is successfully processed, the Group Manager stores the association between: i) the new authentication credential of the group member; and ii) the Group Identifier (Gid), i.e., the OSCORE ID Context associated with the OSCORE group, together with the OSCORE Sender ID assigned to the group member in the group. The Group Manager <span class="bcp14">MUST</span> keep this association updated over time.<a href="#section-9.4-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-gm-pub-key">
<section id="section-9.5">
        <h3 id="name-retrieve-the-group-managers">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-retrieve-the-group-managers" class="section-name selfRef">Retrieve the Group Manager's Authentication Credential</a>
        </h3>
<p id="section-9.5-1">A group member or a signature verifier may need to retrieve the authentication credential of the Group Manager. To this end, the requesting Client sends a KDC Authentication Credential Request message to the Group Manager.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2"><a href="#sec-gm-pub-key-group-member" class="auto internal xref">Section 9.5.1</a> defines how this operation is performed by a group member, building on <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
<p id="section-9.5-3"><a href="#sec-gm-pub-key-signature-verifier" class="auto internal xref">Section 9.5.2</a> defines how this operation is performed by a signature verifier, by relying on the additional FETCH handler defined in <a href="#kdc-cred-fetch" class="auto internal xref">Section 8.1.1</a> of this document.<a href="#section-9.5-3" class="pilcrow">¶</a></p>
<div id="sec-gm-pub-key-group-member">
<section id="section-9.5.1">
          <h4 id="name-retrieval-for-group-members">
<a href="#section-9.5.1" class="section-number selfRef">9.5.1. </a><a href="#name-retrieval-for-group-members" class="section-name selfRef">Retrieval for Group Members</a>
          </h4>
<p id="section-9.5.1-1">A group member sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/kdc-cred at the Group Manager as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.5.1-1" class="pilcrow">¶</a></p>
<p id="section-9.5.1-2">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the Group Manager <span class="bcp14">MUST</span> respond with a 4.03 (Forbidden) error response, if the requesting Client is not a current group member. The response <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-9.5.1-2" class="pilcrow">¶</a></p>
<p id="section-9.5.1-3">The payload of the 2.05 (Content) KDC Authentication Credential Response is a CBOR map, which is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The Group Manager specifies the parameters 'kdc_cred', 'kdc_nonce', and 'kdc_cred_verify' as defined for the Join Response in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document. This especially applies to the computing of the proof-of-possession (PoP) evidence included in 'kdc_cred_verify' (REQ21).<a href="#section-9.5.1-3" class="pilcrow">¶</a></p>
<p id="section-9.5.1-4">Upon receiving a 2.05 (Content) KDC Authentication Credential Response, the requesting Client retrieves the Group Manager's authentication credential from the 'kdc_cred' parameter, and proceeds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The requesting Client verifies the PoP evidence included in 'kdc_cred_verify' by means of the same method used when processing the Join Response, as defined in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document (REQ21).<a href="#section-9.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-gm-pub-key-signature-verifier">
<section id="section-9.5.2">
          <h4 id="name-retrieval-for-signature-ver">
<a href="#section-9.5.2" class="section-number selfRef">9.5.2. </a><a href="#name-retrieval-for-signature-ver" class="section-name selfRef">Retrieval for Signature Verifiers</a>
          </h4>
<p id="section-9.5.2-1">A Client signature verifier sends a CoAP FETCH request to the endpoint /ace-group/GROUPNAME/kdc-cred at the Group Manager defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.5.2-1" class="pilcrow">¶</a></p>
<p id="section-9.5.2-2">The request <span class="bcp14">MUST</span> have Content-Format "application/ace-groupcomm+cbor". The payload of the request is formatted as a CBOR map, which <span class="bcp14">MUST</span> contain the following field with the value specified below:<a href="#section-9.5.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5.2-3.1">
              <p id="section-9.5.2-3.1.1">'cnonce': encoded as a CBOR byte string, whose value is a dedicated nonce N_C generated by the Client. For the N_C value, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce.<a href="#section-9.5.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.5.2-4">The payload of the 2.05 (Content) KDC Authentication Credential Response is a CBOR map, which is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the following difference:<a href="#section-9.5.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5.2-5.1">
              <p id="section-9.5.2-5.1.1">The 'kdc_cred_verify' field  specifies the PoP evidence computed by the Group Manager over the following PoP input: the nonce N_C (encoded as a CBOR byte string) concatenated with the nonce N_KDC (encoded as a CBOR byte string), where:<a href="#section-9.5.2-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5.2-5.1.2.1">
                  <p id="section-9.5.2-5.1.2.1.1">N_C is the nonce generated by the Client signature verifier and specified in the 'cnonce' field of the received KDC Authentication Credential Request.<a href="#section-9.5.2-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-9.5.2-5.1.2.2">
                  <p id="section-9.5.2-5.1.2.2.1">N_KDC is the nonce generated by the Group Manager and specified in the 'kdc_nonce' field of the KDC Authentication Credential Response.<a href="#section-9.5.2-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-9.5.2-6">The Group Manager specifies the 'kdc_cred' field and 'kdc_nonce' field as defined for the Join Response in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document. The computed PoP evidence included in the 'kdc_cred_verify' field is always a signature computed over the PoP input defined above (REQ21).<a href="#section-9.5.2-6" class="pilcrow">¶</a></p>
<p id="section-9.5.2-7">Upon receiving a 2.05 (Content) KDC Authentication Credential Response, the requesting Client retrieves the Group Manager's authentication credential from the 'kdc_cred' parameter. Then, it proceeds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.5.1.1" class="relref">Section 4.5.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, with the difference that it verifies the PoP evidence included in 'kdc_cred_verify' field by verifying a signature and using the PoP input defined above (REQ21)<a href="#section-9.5.2-7" class="pilcrow">¶</a></p>
<p id="section-9.5.2-8">Note that a signature verifier would not receive a successful response from the Group Manager, in case GROUPNAME denotes a pairwise-only group (see <a href="#kdc-cred-fetch" class="auto internal xref">Section 8.1.1</a>).<a href="#section-9.5.2-8" class="pilcrow">¶</a></p>
<p id="section-9.5.2-9"><a href="#fig-gm-pub-key-signature-verifier-req-resp" class="auto internal xref">Figure 1</a> gives an overview of the exchange described above,  while <a href="#fig-gm-pub-key-signature-verifier-resp-ex" class="auto internal xref">Figure 2</a> shows an example of Signature Verification Data Request-Response.<a href="#section-9.5.2-9" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-kdc-authent"></span><div id="fig-gm-pub-key-signature-verifier-req-resp">
<figure id="figure-1">
            <div id="section-9.5.2-10.1">
              <div class="alignCenter art-svg artwork" id="section-9.5.2-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="568" viewBox="0 0 568 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,64 L 24,160" fill="none" stroke="black"></path>
                  <path d="M 536,64 L 536,160" fill="none" stroke="black"></path>
                  <path d="M 32,96 L 528,96" fill="none" stroke="black"></path>
                  <path d="M 32,144 L 56,144" fill="none" stroke="black"></path>
                  <path d="M 512,144 L 528,144" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="536,96 524,90.4 524,101.6" fill="black" transform="rotate(0,528,96)"></polygon>
                  <polygon class="arrowhead" points="40,144 28,138.4 28,149.6" fill="black" transform="rotate(180,32,144)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Signature</text>
                    <text x="536" y="36">Group</text>
                    <text x="36" y="52">Verifier</text>
                    <text x="536" y="52">Manager</text>
                    <text x="152" y="84">KDC</text>
                    <text x="228" y="84">Authentication</text>
                    <text x="332" y="84">Credential</text>
                    <text x="408" y="84">Request</text>
                    <text x="168" y="116">FETCH</text>
                    <text x="312" y="116">/ace-group/GROUPNAME/kdc-cred</text>
                    <text x="80" y="148">KDC</text>
                    <text x="156" y="148">Authentication</text>
                    <text x="260" y="148">Credential</text>
                    <text x="344" y="148">Response:</text>
                    <text x="404" y="148">2.05</text>
                    <text x="464" y="148">(Content)</text>
                  </g>
                </svg><a href="#section-9.5.2-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-message-flow-of-kdc-authent" class="selfRef">Message Flow of KDC Authentication Credential Request-Response, with a Signature Verifier as Requesting Client</a>
            </figcaption></figure>
</div>
<span id="name-example-of-kdc-authenticati"></span><div id="fig-gm-pub-key-signature-verifier-resp-ex">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-9.5.2-11.1">
<pre>
   Request:

   Header: FETCH (Code=0.05)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "kdc-cred"
   Content-Format: 261 (application/ace-groupcomm+cbor)
   Payload (in CBOR diagnostic notation):
   {
     / cnonce / 6: h'6c5a8891bbcf4199'
   }


   Response:

   Header: Content (Code=2.05)
   Content-Format: 261 (application/ace-groupcomm+cbor)
   Payload (in CBOR diagnostic notation):
   {
     / kdc_cred /        17: h'a2026008a101a5010202419920012158
                               2065eda5a12577c2bae829437fe33870
                               1a10aaa375e1bb5b5de108de439c0855
                               1d2258201e52ed75701163f7f9e40ddf
                               9f341b3dc9ba860af7e0ca7ca7e9eecd
                               0084d19c',
     / kdc_nonce /       18: h'aff56da30b7db12a',
     / kdc_cred_verify / 19: h'f3e4be39445b1a3e83e1510d1aca2f2e
                               3fc54702aa56e1b2cb20284294c9106a
                               8a7c081c7645042b18aba9d1fad1bd9c
                               63f91bac658d69351210a031d8fc7c5f'
   }
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-of-kdc-authenticati" class="selfRef">Example of KDC Authentication Credential Request-Response, with a Signature Verifier as Requesting Client</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-verif-data">
<section id="section-9.6">
        <h3 id="name-retrieve-signature-verifica">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-retrieve-signature-verifica" class="section-name selfRef">Retrieve Signature Verification Data</a>
        </h3>
<p id="section-9.6-1">A signature verifier may need to retrieve data required to verify signatures of messages protected with the group mode and sent to a group (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7.5" class="relref">7.5</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.3" class="relref">12.3</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). To this end, the signature verifier sends a Signature Verification Data Request message to the Group Manager.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">That is, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/verif-data at the Group Manager defined in <a href="#ssec-resource-verif-data" class="auto internal xref">Section 8.3</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
<p id="section-9.6-3">The payload of the 2.05 (Content) Signature Verification Data Response is a CBOR map, which has the format used for the Join Response message in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>, with the following differences.<a href="#section-9.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6-4.1">
            <p id="section-9.6-4.1.1">Of the parameters present in the Join Response message, only the parameters 'gkty', 'key', 'num', 'exp', 'exi', and 'ace_groupcomm_profile' are present in the Signature Verification Data Response.<a href="#section-9.6-4.1.1" class="pilcrow">¶</a></p>
<p id="section-9.6-4.1.2">
The 'key' parameter includes only the following data.<a href="#section-9.6-4.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.6-4.1.3.1">
                <p id="section-9.6-4.1.3.1.1">The parameters 'hkdf', 'contextId', 'cred_fmt', 'gp_enc_alg', 'sign_alg', and 'sign_params'. These parameters <span class="bcp14">MUST</span> be present.<a href="#section-9.6-4.1.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.6-4.1.3.2">
                <p id="section-9.6-4.1.3.2.1">The parameters 'alg' and 'ecdh_alg'. These parameters <span class="bcp14">MUST NOT</span> be present if the group is a signature-only group. Otherwise, they <span class="bcp14">MUST</span> be present.<a href="#section-9.6-4.1.3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-9.6-4.2">
            <p id="section-9.6-4.2.1">The 'sign_enc_key' parameter is also included, with CBOR label registered in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="auto internal xref">Section 16.3</a>. This parameter specifies the Signature Encryption Key of the OSCORE Group, encoded as a CBOR byte string. The Group Manager derives the Signature Encryption Key from the group keying material, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-2.1.9" class="relref">Section 2.1.9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-9.6-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.6-5">In order to verify signatures in the group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-7.5" class="relref">Section 7.5</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the signature verifier relies on: the data retrieved from the 2.05 (Content) Signature Verification Data Response; the public keys of the group members signing the messages to verify, retrieved from those members' authentication credentials that can be obtained as defined in <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>; and the public key of the Group Manager, retrieved from the Group Manager's authentication credential that can be obtained as defined in <a href="#sec-gm-pub-key-signature-verifier" class="auto internal xref">Section 9.5.2</a>.<a href="#section-9.6-5" class="pilcrow">¶</a></p>
<p id="section-9.6-6"><a href="#fig-verif-data-req-resp" class="auto internal xref">Figure 3</a> gives an overview of the exchange described above,  while <a href="#fig-verif-data-req-resp-ex" class="auto internal xref">Figure 4</a> shows an example of Signature Verification Data Request-Response.<a href="#section-9.6-6" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-signature-v"></span><div id="fig-verif-data-req-resp">
<figure id="figure-3">
          <div id="section-9.6-7.1">
            <div class="alignCenter art-svg artwork" id="section-9.6-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="552" viewBox="0 0 552 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,64 L 24,160" fill="none" stroke="black"></path>
                <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
                <path d="M 32,96 L 512,96" fill="none" stroke="black"></path>
                <path d="M 32,144 L 56,144" fill="none" stroke="black"></path>
                <path d="M 496,144 L 512,144" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="520,96 508,90.4 508,101.6" fill="black" transform="rotate(0,512,96)"></polygon>
                <polygon class="arrowhead" points="40,144 28,138.4 28,149.6" fill="black" transform="rotate(180,32,144)"></polygon>
                <g class="text">
                  <text x="40" y="36">Signature</text>
                  <text x="520" y="36">Group</text>
                  <text x="36" y="52">Verifier</text>
                  <text x="520" y="52">Manager</text>
                  <text x="176" y="84">Signature</text>
                  <text x="268" y="84">Verification</text>
                  <text x="340" y="84">Data</text>
                  <text x="392" y="84">Request</text>
                  <text x="152" y="116">GET</text>
                  <text x="296" y="116">/ace-group/GROUPNAME/verif-data</text>
                  <text x="104" y="148">Signature</text>
                  <text x="196" y="148">Verification</text>
                  <text x="268" y="148">Data</text>
                  <text x="328" y="148">Response:</text>
                  <text x="388" y="148">2.05</text>
                  <text x="448" y="148">(Content)</text>
                </g>
              </svg><a href="#section-9.6-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-of-signature-v" class="selfRef">Message Flow of Signature Verification Data Request-Response</a>
          </figcaption></figure>
</div>
<span id="name-example-of-signature-verifi"></span><div id="fig-verif-data-req-resp-ex">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-9.6-8.1">
<pre>
   Request:

   Header: GET (Code=0.01)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "verif-data"


   Response:

   Header: Content (Code=2.05)
   Content-Format: 261 (application/ace-groupcomm+cbor)
   Payload (in CBOR diagnostic notation):
   {
                       / gkty / 7: e'group_oscore_input_material_obj',
                       / key /  8: {
                         / hkdf /       3: 5, / HMAC with SHA-256 /
                         / contextId /  6: h'37fc',
                              e'cred_fmt': 33, / x5chain /
                            e'gp_enc_alg': 10, / AES-CCM-16-64-128 /
                              e'sign_alg': -8, / EdDSA /
                           e'sign_params': [[1], [1, 6]]
                                           / [[OKP], [OKP, Ed25519]] /
                       },
     / num /                    9: 12,
     / ace_groupcomm_profile / 10: e'coap_group_oscore_app',
     / exp /                   11: 1609459200,
     / exi /                   12: 2592000,
                  e'sign_enc_key': h'bc661fae6742abc3dd01beda1142567c'
   }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-signature-verifi" class="selfRef">Example of Signature Verification Data Request-Response</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-policies">
<section id="section-9.7">
        <h3 id="name-retrieve-the-group-policies">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-retrieve-the-group-policies" class="section-name selfRef">Retrieve the Group Policies</a>
        </h3>
<p id="section-9.7-1">A group member may request the current policies used in the OSCORE group. To this end, the group member sends a Policies Request, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.6.1.1" class="relref">Section 4.6.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/policies at the Group Manager, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">Upon receiving the Policies Request, the Group Manager processes it as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.6.1" class="relref">Section 4.6.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The success Policies Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.6.1" class="relref">Section 4.6.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-version">
<section id="section-9.8">
        <h3 id="name-retrieve-the-keying-materia">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-retrieve-the-keying-materia" class="section-name selfRef">Retrieve the Keying Material Version</a>
        </h3>
<p id="section-9.8-1">A group member may request the current version of the keying material used in the OSCORE group. To this end, the group member sends a Version Request, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.7.1.1" class="relref">Section 4.7.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/num at the Group Manager, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2">Upon receiving the Version Request, the Group Manager processes it as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.7.1" class="relref">Section 4.7.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The success Version Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.7.1" class="relref">Section 4.7.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-status">
<section id="section-9.9">
        <h3 id="name-retrieve-the-group-status">
<a href="#section-9.9" class="section-number selfRef">9.9. </a><a href="#name-retrieve-the-group-status" class="section-name selfRef">Retrieve the Group Status</a>
        </h3>
<p id="section-9.9-1">A group member may request the current status of the OSCORE group, i.e., active or inactive. To this end, the group member sends a Group Status Request to the Group Manager.<a href="#section-9.9-1" class="pilcrow">¶</a></p>
<p id="section-9.9-2">That is, the group member sends a CoAP GET request to the endpoint /ace-group/GROUPNAME/active at the Group Manager defined in <a href="#ssec-resource-active" class="auto internal xref">Section 8.2</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-9.9-2" class="pilcrow">¶</a></p>
<p id="section-9.9-3">The payload of the 2.05 (Content) Group Status Response includes the CBOR Simple Value <code>true</code> (0xf5) if the group is currently active, or the CBOR Simple Value <code>false</code> (0xf4) otherwise. The group is considered active if it is set to allow new members to join, and if communication within the group is fine to occur.<a href="#section-9.9-3" class="pilcrow">¶</a></p>
<p id="section-9.9-4">Upon learning from a 2.05 (Content) Group Status Response that the group is currently inactive, the group member <span class="bcp14">SHOULD</span> stop taking part in communications within the group, until the group becomes active again.<a href="#section-9.9-4" class="pilcrow">¶</a></p>
<p id="section-9.9-5">Upon learning from a 2.05 (Content) Group Status Response that the group has become active again, the group member can resume taking part in communications within the group.<a href="#section-9.9-5" class="pilcrow">¶</a></p>
<p id="section-9.9-6"><a href="#fig-key-status-req-resp" class="auto internal xref">Figure 5</a> gives an overview of the exchange described above, while <a href="#fig-key-status-req-resp-ex" class="auto internal xref">Figure 6</a> shows an example of Group Status Request-Response.<a href="#section-9.9-6" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-statu"></span><div id="fig-key-status-req-resp">
<figure id="figure-5">
          <div id="section-9.9-7.1">
            <div class="alignCenter art-svg artwork" id="section-9.9-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="560" viewBox="0 0 560 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,64 L 24,128" fill="none" stroke="black"></path>
                <path d="M 528,64 L 528,128" fill="none" stroke="black"></path>
                <path d="M 32,80 L 48,80" fill="none" stroke="black"></path>
                <path d="M 496,80 L 520,80" fill="none" stroke="black"></path>
                <path d="M 32,112 L 120,112" fill="none" stroke="black"></path>
                <path d="M 440,112 L 520,112" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,80 516,74.4 516,85.6" fill="black" transform="rotate(0,520,80)"></polygon>
                <polygon class="arrowhead" points="40,112 28,106.4 28,117.6" fill="black" transform="rotate(180,32,112)"></polygon>
                <g class="text">
                  <text x="24" y="36">Group</text>
                  <text x="528" y="36">Group</text>
                  <text x="28" y="52">Member</text>
                  <text x="528" y="52">Manager</text>
                  <text x="80" y="84">Group</text>
                  <text x="132" y="84">Status</text>
                  <text x="196" y="84">Request:</text>
                  <text x="248" y="84">GET</text>
                  <text x="376" y="84">/ace-group/GROUPNAME/active</text>
                  <text x="152" y="116">Group</text>
                  <text x="204" y="116">Status</text>
                  <text x="272" y="116">Response:</text>
                  <text x="332" y="116">2.05</text>
                  <text x="392" y="116">(Content)</text>
                </g>
              </svg><a href="#section-9.9-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-message-flow-of-group-statu" class="selfRef">Message Flow of Group Status Request-Response</a>
          </figcaption></figure>
</div>
<span id="name-example-of-group-status-req"></span><div id="fig-key-status-req-resp-ex">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-9.9-8.1">
<pre>
   Request:

   Header: GET (Code=0.01)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "active"


   Response:

   Header: Content (Code=2.05)
   Content-Format: 60 (application/cbor)
   Payload (in CBOR diagnostic notation):
     true
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-group-status-req" class="selfRef">Example of Group Status Request-Response</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-retrieve-gnames">
<section id="section-9.10">
        <h3 id="name-retrieve-group-names">
<a href="#section-9.10" class="section-number selfRef">9.10. </a><a href="#name-retrieve-group-names" class="section-name selfRef">Retrieve Group Names</a>
        </h3>
<p id="section-9.10-1">A node may want to retrieve from the Group Manager the group name and the URI of the group-membership resource of a group. This is relevant in the following cases.<a href="#section-9.10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.10-2.1">
            <p id="section-9.10-2.1.1">Before joining a group, a joining node may know only the current Group Identifier (Gid) of that group, but not the group name and the URI of the group-membership resource.<a href="#section-9.10-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.10-2.2">
            <p id="section-9.10-2.2.1">As current group member in several groups, the node has missed a previous group rekeying in one of them (see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>). Hence, it retains stale keying material and fails to decrypt received messages exchanged in that group.<a href="#section-9.10-2.2.1" class="pilcrow">¶</a></p>
<p id="section-9.10-2.2.2">
Such messages do not provide a direct hint to the correct group name, that the node would need in order to retrieve the latest keying material and authentication credentials from the Group Manager (see <a href="#ssec-updated-key-only" class="auto internal xref">Section 9.1.1</a>, <a href="#ssec-updated-and-individual-key" class="auto internal xref">Section 9.1.2</a>, and <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>). However, such messages may specify the current Gid of the group, as value of the 'kid_context' field of the OSCORE CoAP option (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-9.10-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.10-2.3">
            <p id="section-9.10-2.3.1">As signature verifier, the node also refers to a group name for retrieving the required authentication credentials from the Group Manager (see <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>). As discussed above, intercepted messages do not provide a direct hint to the correct group name, while they may specify the current Gid of the group, as value of the 'kid_context' field of the OSCORE CoAP option. In such a case, upon intercepting a message in the group, the node requires to correctly map the Gid currently used in the group with the invariant group name.<a href="#section-9.10-2.3.1" class="pilcrow">¶</a></p>
<p id="section-9.10-2.3.2">
Furthermore, since it is not a group member, the node does not take part to a possible group rekeying. Thus, following a group rekeying and the consequent change of Gid in a group, the node would retain the old Gid value and cannot correctly associate intercepted messages to the right group, especially if acting as signature verifier in several groups. This in turn prevents the efficient verification of signatures, and especially the retrieval of required, new authentication credentials from the Group Manager.<a href="#section-9.10-2.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.10-3">In either case, the node only knows the current Gid of the group, as learned from received or intercepted messages exchanged in the group. As detailed below, the node can contact the Group Manager, and request the group name and URI of the group-membership resource corresponding to that Gid. Then, it can use that information to join the group, or get the latest keying material as a current group member, or retrieve authentication credentials used in the group as a signature verifier. To this end, the node sends a Group Name and URI Retrieval Request, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.2.1.1" class="relref">Section 4.2.1.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-9.10-3" class="pilcrow">¶</a></p>
<p id="section-9.10-4">That is, the node sends a CoAP FETCH request to the endpoint /ace-group at the Group Manager formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Each element of the CBOR array 'gid' is a CBOR byte string (REQ13), which encodes the Gid of the group for which the group name and the URI of the group-membership resource are requested.<a href="#section-9.10-4" class="pilcrow">¶</a></p>
<p id="section-9.10-5">Upon receiving the Group Name and URI Retrieval Request, the Group Manager processes it as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. The success Group Name and URI Retrieval Response is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Each element of the CBOR array 'gid' is a CBOR byte string (REQ13), which encodes the Gid of the group for which the group name and the URI of the group-membership resource are provided.<a href="#section-9.10-5" class="pilcrow">¶</a></p>
<p id="section-9.10-6">For each of its groups, the Group Manager maintains an association between the group name and the URI of the group-membership resource on one hand, and only the current Gid for that group on the other hand. That is, the Group Manager does not maintain an association between the former pair and any other Gid for that group than the current, most recent one.<a href="#section-9.10-6" class="pilcrow">¶</a></p>
<p id="section-9.10-7"><a href="#fig-group-names-req-resp" class="auto internal xref">Figure 7</a> gives an overview of the exchanges described above, while <a href="#fig-group-names-req-resp-ex" class="auto internal xref">Figure 8</a> shows an example of Group Name and URI Retrieval Request-Response.<a href="#section-9.10-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-name-"></span><div id="fig-group-names-req-resp">
<figure id="figure-7">
          <div id="section-9.10-8.1">
            <div class="alignCenter art-svg artwork" id="section-9.10-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="568" viewBox="0 0 568 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 16,64 L 16,128" fill="none" stroke="black"></path>
                <path d="M 536,64 L 536,128" fill="none" stroke="black"></path>
                <path d="M 24,80 L 40,80" fill="none" stroke="black"></path>
                <path d="M 496,80 L 528,80" fill="none" stroke="black"></path>
                <path d="M 24,112 L 48,112" fill="none" stroke="black"></path>
                <path d="M 496,112 L 528,112" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="536,80 524,74.4 524,85.6" fill="black" transform="rotate(0,528,80)"></polygon>
                <polygon class="arrowhead" points="32,112 20,106.4 20,117.6" fill="black" transform="rotate(180,24,112)"></polygon>
                <g class="text">
                  <text x="536" y="36">Group</text>
                  <text x="20" y="52">Node</text>
                  <text x="536" y="52">Manager</text>
                  <text x="72" y="84">Group</text>
                  <text x="116" y="84">Name</text>
                  <text x="152" y="84">and</text>
                  <text x="184" y="84">URI</text>
                  <text x="240" y="84">Retrieval</text>
                  <text x="316" y="84">Request:</text>
                  <text x="376" y="84">FETCH</text>
                  <text x="444" y="84">/ace-group</text>
                  <text x="80" y="116">Group</text>
                  <text x="124" y="116">Name</text>
                  <text x="160" y="116">and</text>
                  <text x="192" y="116">URI</text>
                  <text x="248" y="116">Retrieval</text>
                  <text x="328" y="116">Response:</text>
                  <text x="388" y="116">2.05</text>
                  <text x="448" y="116">(Content)</text>
                </g>
              </svg><a href="#section-9.10-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-message-flow-of-group-name-" class="selfRef">Message Flow of Group Name and URI Retrieval Request-Response</a>
          </figcaption></figure>
</div>
<span id="name-example-of-group-name-and-u"></span><div id="fig-group-names-req-resp-ex">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-9.10-9.1">
<pre>
   Request:

   Header: FETCH (Code=0.05)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Content-Format: 261 (application/ace-groupcomm+cbor)
   Payload (in CBOR diagnostic notation):
   {
     / gid / 0: [h'37fc', h'84bd']
   }


   Response:

   Header: Content (Code=2.05)
   Content-Format: 261 (application/ace-groupcomm+cbor)
   Payload (in CBOR diagnostic notation):
   {
     / gid /   0: [h'37fc', h'84bd'],
     / gname / 1: ["g1", "g2"],
     / guri /  2: ["/ace-group/g1", "/ace-group/g2"]
   }
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-group-name-and-u" class="selfRef">Example of Group Name and URI Retrieval Request-Response</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-leave-req">
<section id="section-9.11">
        <h3 id="name-leave-the-group">
<a href="#section-9.11" class="section-number selfRef">9.11. </a><a href="#name-leave-the-group" class="section-name selfRef">Leave the Group</a>
        </h3>
<p id="section-9.11-1">A group member may request to leave the OSCORE group. To this end, the group member sends a Group Leaving Request, as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.3.1" class="relref">Section 4.8.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. That is, it sends a CoAP DELETE request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the Group Manager.<a href="#section-9.11-1" class="pilcrow">¶</a></p>
<p id="section-9.11-2">Upon receiving the Group Leaving Request, the Group Manager processes it as per <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.8.3" class="relref">Section 4.8.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. Then, the Group Manager performs the follow-up actions defined in <a href="#sec-leaving" class="auto internal xref">Section 10</a> of this document.<a href="#section-9.11-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-leaving">
<section id="section-10">
      <h2 id="name-removal-of-a-group-member">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-removal-of-a-group-member" class="section-name selfRef">Removal of a Group Member</a>
      </h2>
<p id="section-10-1">Other than after a spontaneous request to the Group Manager as described in <a href="#sec-leave-req" class="auto internal xref">Section 9.11</a>, a node may be forcibly removed from the OSCORE group, e.g., due to expired or revoked authorization.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In either case, if the Group Manager reassigns Gid values during the group's lifetime (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2.1.1" class="relref">12.2.1.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#appendix-E" class="relref">E</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>), the Group Manager "forgets" the Birth Gid currently associated with the leaving node in the OSCORE group. This was stored following the Join Response sent to that node, after its latest (re-)joining of the OSCORE group (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>).<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">If any of the two conditions below holds, the Group Manager <span class="bcp14">MUST</span> inform the leaving node of its eviction as follows. If both conditions hold, the Group Manager <span class="bcp14">MUST</span> inform the leaving node by using only the method corresponding to one of either conditions.<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">
          <p id="section-10-4.1.1">If, upon joining the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>), the leaving node specified a URI in the 'control_uri' parameter defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the Group Manager sends a DELETE request targeting the URI specified in the 'control_uri' parameter (OPT7).<a href="#section-10-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.2">
          <p id="section-10-4.2.1">If the leaving node has been observing the associated resource at /ace-group/GROUPNAME/nodes/NODENAME, the Group Manager sends an unsolicited 4.04 (Not Found) error response to the leaving node, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.2" class="relref">Section 4.3.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-10-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-5">Furthermore, the Group Manager might intend to evict all the current group members from the group at once. In such a case, if the Join Responses sent by the Group Manager to nodes joining the group (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>) specify a URI in the 'control_group_uri' parameter defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, then the Group Manager <span class="bcp14">MUST</span> additionally send a DELETE request targeting the URI specified in the 'control_group_uri' parameter (OPT10).<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">If the leaving node has not exclusively the role of monitor, the Group Manager performs the following actions.<a href="#section-10-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-7.1">
          <p id="section-10-7.1.1">The Group Manager frees the OSCORE Sender ID value of the leaving node. This value <span class="bcp14">MUST NOT</span> become available for possible upcoming joining nodes in the same group, until the group has been rekeyed and assigned a new Group Identifier (Gid).<a href="#section-10-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-7.2">
          <p id="section-10-7.2.1">The Group Manager <span class="bcp14">MUST</span> add the relinquished Sender ID of the leaving node to the most recent set of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-10-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-7.3">
          <p id="section-10-7.3.1">The Group Manager cancels the association between, on one hand, the authentication credential of the leaving node and, on the other hand, the Gid associated with the OSCORE group together with the freed Sender ID value. The Group Manager deletes the authentication credential of the leaving node, if that authentication credential has no remaining association with any pair (Gid, Sender ID).<a href="#section-10-7.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-8">Then, the Group Manager <span class="bcp14">MUST</span> generate updated security parameters and group keying material, and provide it to the remaining group members (see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>). As a consequence, the leaving node is not able to acquire the new security parameters and group keying material distributed after its leaving.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">The same considerations from <span><a href="https://rfc-editor.org/rfc/rfc9594#section-5" class="relref">Section 5</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> apply here as well, considering the Group Manager acting as KDC.<a href="#section-10-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-group-rekeying-process">
<section id="section-11">
      <h2 id="name-group-rekeying-process">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-group-rekeying-process" class="section-name selfRef">Group Rekeying Process</a>
      </h2>
<p id="section-11-1">In order to rekey the OSCORE group, the Group Manager distributes a new Group Identifier (Gid), i.e., a new OSCORE ID Context; a new OSCORE Master Secret; and, optionally, a new OSCORE Master Salt for that group. When doing so, the Group Manager <span class="bcp14">MUST</span> increment the version number of the group keying material, before starting its distribution.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">As per Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2.1.1" class="relref">12.2.1.1</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#appendix-E" class="relref">E</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Manager <span class="bcp14">MAY</span> reassign a Gid to the same group over that group's lifetime, e.g., once the whole space of Gid values has been used for the group in question. If the Group Manager supports reassignment of Gid values and performs it in a group, then the Group Manager additionally takes the following actions.<a href="#section-11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">
          <p id="section-11-3.1.1">Before rekeying the group, the Group Manager <span class="bcp14">MUST</span> check if the new Gid to be distributed coincides with the Birth Gid of any of the current group members (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>).<a href="#section-11-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.2">
          <p id="section-11-3.2.1">If any of such "elder members" is found in the group, the Group Manager <span class="bcp14">MUST</span> evict them from the group. That is, the Group Manager <span class="bcp14">MUST</span> terminate their membership and <span class="bcp14">MUST</span> rekey the group in such a way that the new keying material is not provided to those evicted elder members. This also includes adding their relinquished Sender IDs to the most recent set of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>), before rekeying the group.<a href="#section-11-3.2.1" class="pilcrow">¶</a></p>
<p id="section-11-3.2.2">
Until a further following group rekeying, the Group Manager <span class="bcp14">MUST</span> store the list of those latest-evicted elder members. If any of those nodes re-joins the group before a further following group rekeying occurs, the Group Manager <span class="bcp14">MUST NOT</span> rekey the group upon their re-joining. When one of those nodes re-joins the group, the Group Manager can rely, e.g., on the ongoing secure communication association to recognize the node as included in the stored list.<a href="#section-11-3.2.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-4">Across the rekeying execution, the Group Manager <span class="bcp14">MUST</span> preserve the same unchanged OSCORE Sender IDs for all group members intended to remain in the group. This avoids affecting the retrieval of authentication credentials from the Group Manager and the verification of group messages.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">The Group Manager <span class="bcp14">MUST</span> support the "Point-to-Point" group rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.12" class="relref">Section 11.12</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, as per the detailed use defined in <a href="#sending-rekeying-msg" class="auto internal xref">Section 11.1</a> of this document. Future specifications may define how this application profile can use alternative group rekeying schemes, which <span class="bcp14">MUST</span> comply with the functional steps defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The Group Manager <span class="bcp14">MUST</span> indicate the use of such an alternative group rekeying scheme to joining nodes, by means of the 'group_rekeying' parameter included in Join Response messages (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>).<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">It is <span class="bcp14">RECOMMENDED</span> that the Group Manager gets confirmation of successful distribution from the group members, and admits a maximum number of individual retransmissions to non-confirming group members. Once completed the group rekeying process, the Group Manager creates a new empty set of stale Sender IDs associated with the version of the newly distributed group keying material (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">In case the rekeying terminates and some group members have not received the new keying material, they will not be able to correctly process following secured messages exchanged in the group. These group members will eventually contact the Group Manager, in order to retrieve the current keying material and its version.<a href="#section-11-7" class="pilcrow">¶</a></p>
<p id="section-11-8">Some of these group members may be in multiple groups, each associated with a different Group Manager. When failing to correctly process messages secured with the new keying material, these group members may not have sufficient information to determine which exact Group Manager they should contact, in order to retrieve the current keying material they are missing.<a href="#section-11-8" class="pilcrow">¶</a></p>
<p id="section-11-9">If the Gid is formatted as described in Appendix C of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the Group Prefix can be used as a hint to determine the right Group Manager, as long as no collisions among Group Prefixes are experienced. Otherwise, a group member needs to contact the Group Manager of each group, e.g., by first requesting only the version of the current group keying material (see <a href="#sec-version" class="auto internal xref">Section 9.8</a>) and then possibly requesting the current keying material (see <a href="#ssec-updated-key-only" class="auto internal xref">Section 9.1.1</a>).<a href="#section-11-9" class="pilcrow">¶</a></p>
<p id="section-11-10">Furthermore, some of these group members can be in multiple groups, all of which are associated with the same Group Manager. In this case, these group members may also not have sufficient information to determine which exact group they should refer to, when contacting the right Group Manager. Hence, they need to contact a Group Manager multiple times, i.e., separately for each group they belong to and associated with that Group Manager.<a href="#section-11-10" class="pilcrow">¶</a></p>
<p id="section-11-11"><a href="#receiving-rekeying-msg" class="auto internal xref">Section 11.2</a> defines the actions performed by a group member upon receiving the new group keying material. <a href="#missed-rekeying" class="auto internal xref">Section 11.3</a> discusses how a group member can realize that it has missed one or more rekeying instances, and the actions it is accordingly required to take.<a href="#section-11-11" class="pilcrow">¶</a></p>
<div id="sending-rekeying-msg">
<section id="section-11.1">
        <h3 id="name-sending-rekeying-messages">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-sending-rekeying-messages" class="section-name selfRef">Sending Rekeying Messages</a>
        </h3>
<p id="section-11.1-1">When using the "Point-to-Point" group rekeying scheme, the group rekeying messages <span class="bcp14">MUST</span> have Content-Format set to "application/ace-groupcomm+cbor" and have the same format used for the Join Response message in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>, with the following differences. Note that this extends the minimal content of a rekeying message as defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6" class="relref">Section 6</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> (OPT14).<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.1">
            <p id="section-11.1-2.1.1">Of the parameters present in the Join Response message, only the parameters 'gkty', 'key', 'num', 'exp', 'exi', and 'ace_groupcomm_profile' are present.<a href="#section-11.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-11.1-2.1.2">
The 'key' parameter includes only the following data.<a href="#section-11.1-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.1.3.1">
                <p id="section-11.1-2.1.3.1.1">The 'ms' parameter, specifying the new OSCORE Master Secret value. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-11.1-2.1.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-2.1.3.2">
                <p id="section-11.1-2.1.3.2.1">The 'contextId' parameter, specifying the new Gid to use as OSCORE ID Context value. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-11.1-2.1.3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-2.1.3.3">
                <p id="section-11.1-2.1.3.3.1">The 'salt' value, specifying the new OSCORE Master Salt value. This parameter <span class="bcp14">MAY</span> be present.<a href="#section-11.1-2.1.3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-11.1-2.2">
            <p id="section-11.1-2.2.1">The parameter 'stale_node_ids' <span class="bcp14">MUST</span> also be included, with CBOR label defined in <a href="#ssec-iana-ace-groupcomm-parameters-registry" class="auto internal xref">Section 16.3</a>. This parameter is encoded as a CBOR array, where each element is encoded as a CBOR byte string. The order of elements in the CBOR array is irrelevant. The parameter is populated as follows.<a href="#section-11.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.2.2.1">
                <p id="section-11.1-2.2.2.1.1">The Group Manager creates an empty CBOR array ARRAY.<a href="#section-11.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-2.2.2.2">
                <p id="section-11.1-2.2.2.2.1">The Group Manager considers the most recent set of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>), i.e., the set X associated with the current version of the group keying material about to be relinquished.<a href="#section-11.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-2.2.2.3">
                <p id="section-11.1-2.2.2.3.1">For each Sender ID in X, the Group Manager encodes it as a CBOR byte string and adds the result to ARRAY.<a href="#section-11.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-2.2.2.4">
                <p id="section-11.1-2.2.2.4.1">The parameter 'stale_node_ids' takes ARRAY as value.<a href="#section-11.1-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-11.1-2.3">
            <p id="section-11.1-2.3.1">The parameters 'creds', 'peer_roles', and 'peer_identifiers' <span class="bcp14">SHOULD</span> be present, if the group rekeying is performed due to one or multiple Clients that have requested to join the group. Following the same semantics used in the Join Response message (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>), the three parameters specify the authentication credential, roles in the group and node identifier of each of the Clients that have requested to join the group. The Group Manager <span class="bcp14">MUST NOT</span> include a non-empty subset of these three parameters.<a href="#section-11.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.1-3">The Group Manager separately sends a group rekeying message formatted as defined above to each group member to be rekeyed.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">Each rekeying message <span class="bcp14">MUST</span> be secured with the pairwise secure communication association between the Group Manager and the group member used during the joining process. Each rekeying message can target the 'control_uri' URI path defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.3.1" class="relref">Section 4.3.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> (OPT7), if provided by the intended recipient upon joining the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>).<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5">This distribution approach requires group members to act (also) as servers, in order to correctly handle unsolicited group rekeying messages from the Group Manager. If a group member and the Group Manager use OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> to secure their pairwise communications, the group member <span class="bcp14">MUST</span> create a Replay Window in its own Recipient Context upon establishing the OSCORE Security Context with the Group Manager, e.g., by means of the OSCORE profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-11.1-5" class="pilcrow">¶</a></p>
<p id="section-11.1-6">Group members and the Group Manager <span class="bcp14">SHOULD</span> additionally support alternative distribution approaches that do not require group members to act (also) as servers. A number of such approaches are defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6" class="relref">Section 6</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. In particular, a group member may use CoAP Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> and subscribe for updates to the group-membership resource of the group, at the endpoint /ace-group/GROUPNAME/ of the Group Manager (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>). Alternatively, a full-fledged Pub-Sub model can be considered <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">I-D.ietf-core-coap-pubsub</a>]</span>, where the Group Manager publishes to a rekeying topic hosted at a Broker, while the group members subscribe to such topic (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-11.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="receiving-rekeying-msg">
<section id="section-11.2">
        <h3 id="name-receiving-rekeying-messages">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-receiving-rekeying-messages" class="section-name selfRef">Receiving Rekeying Messages</a>
        </h3>
<p id="section-11.2-1">After having received the new group keying material, a group member proceeds as follows. Unless otherwise specified, the following is independent of the specifically used group rekeying scheme.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">The group member considers the stale Sender IDs received from the Group Manager. If the "Point-to-Point" group rekeying scheme as detailed in <a href="#sending-rekeying-msg" class="auto internal xref">Section 11.1</a> is used, the stale Sender IDs are specified by the 'stale_node_ids' parameter.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">After that, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, the group member <span class="bcp14">MUST</span> remove every authentication credential associated with a stale Sender ID from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">Then, the following cases can occur, based on the version number V' of the new group keying material distributed through the rekeying process. If the "Point-to-Point" group rekeying scheme as detailed in <a href="#sending-rekeying-msg" class="auto internal xref">Section 11.1</a> is used, this information is specified by the 'num' parameter.<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-5.1">
            <p id="section-11.2-5.1.1">The group member has not missed any group rekeying. That is, the old keying material stored by the group member has version number V, while the received new keying material has version number V' = (V + 1). In such a case, the group member simply installs the new keying material and derives the corresponding new Security Context.<a href="#section-11.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-5.2">
            <p id="section-11.2-5.2.1">The group member has missed one or more group rekeying instances. That is, the old keying material stored by the group member has version number V, while the received new keying material has version number V' &gt; (V + 1). In such a case, the group member <span class="bcp14">MUST</span> proceed as defined in <a href="#missed-rekeying" class="auto internal xref">Section 11.3</a>.<a href="#section-11.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-5.3">
            <p id="section-11.2-5.3.1">The group member has received keying material not newer than the stored one. That is, the old keying material stored by the group member has version number V, while the received keying material has version number V' &lt; (V + 1). In such a case, the group member <span class="bcp14">MUST</span> ignore the received rekeying messages and <span class="bcp14">MUST NOT</span> install the received keying material.<a href="#section-11.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="missed-rekeying">
<section id="section-11.3">
        <h3 id="name-missed-rekeying-instances">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-missed-rekeying-instances" class="section-name selfRef">Missed Rekeying Instances</a>
        </h3>
<p id="section-11.3-1">A group member can realize to have missed one or more rekeying instances in one of the ways discussed below. In the following, V denotes the version number of the old keying material stored by the group member, while V' denotes the version number of the latest, possibly just distributed, keying material.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">a. The group member has participated to a rekeying process that has distributed new keying material with version number V' &gt; (V + 1), as discussed in <a href="#receiving-rekeying-msg" class="auto internal xref">Section 11.2</a>.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
<p id="section-11.3-3">b. The group member has obtained the latest keying material from the Group Manager, as a response to a Key Distribution Request (see <a href="#ssec-updated-key-only" class="auto internal xref">Section 9.1.1</a>) or to a Join Request when re-joining the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>). That is, V is different than V' specified by the 'num' parameter in the response.<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<p id="section-11.3-4">c. The group member has obtained the authentication credentials of other group members, through an Authentication Credential Request-Response exchange with the Group Manager (see <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>). That is, V is different than V' specified by the 'num' parameter in the response.<a href="#section-11.3-4" class="pilcrow">¶</a></p>
<p id="section-11.3-5">d. The group member has performed a Version Request-Response exchange with the Group Manager (see <a href="#sec-version" class="auto internal xref">Section 9.8</a>). That is, V is different than V' specified by the 'num' parameter in the response.<a href="#section-11.3-5" class="pilcrow">¶</a></p>
<p id="section-11.3-6">In either case, the group member <span class="bcp14">MUST</span> delete the stored keying material with version number V.<a href="#section-11.3-6" class="pilcrow">¶</a></p>
<p id="section-11.3-7">If case (a) or case (b) applies, the group member <span class="bcp14">MUST</span> perform the following actions.<a href="#section-11.3-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.3-8">
<li id="section-11.3-8.1">
            <p id="section-11.3-8.1.1">The group member <span class="bcp14">MUST NOT</span> install the latest keying material yet, in case that was already obtained.<a href="#section-11.3-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-8.2">
            <p id="section-11.3-8.2.1">The group member sends a Stale Sender IDs Request to the Group Manager (see <a href="#sec-retrieve-stale-sids" class="auto internal xref">Section 11.3.1</a>), specifying the version number V as payload of the request.<a href="#section-11.3-8.2.1" class="pilcrow">¶</a></p>
<p id="section-11.3-8.2.2">
If the Stale Sender IDs Response from the Group Manager has no payload, the group member <span class="bcp14">MUST</span> remove all the authentication credentials from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete all its Recipient Contexts used in the group.<a href="#section-11.3-8.2.2" class="pilcrow">¶</a></p>
<p id="section-11.3-8.2.3">
Otherwise, the group member considers the stale Sender IDs specified in the Stale Sender IDs Response from the Group Manager. Then, the group member <span class="bcp14">MUST</span> remove every authentication credential associated with a stale Sender ID from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-11.3-8.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-8.3">
            <p id="section-11.3-8.3.1">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-11.3-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.3-9">If case (c) or case (d) applies, the group member <span class="bcp14">SHOULD</span> perform the following actions.<a href="#section-11.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.3-10">
<li id="section-11.3-10.1">
            <p id="section-11.3-10.1.1">The group member sends a Stale Sender IDs Request to the Group Manager (see <a href="#sec-retrieve-stale-sids" class="auto internal xref">Section 11.3.1</a>), specifying the version number V as payload of the request.<a href="#section-11.3-10.1.1" class="pilcrow">¶</a></p>
<p id="section-11.3-10.1.2">
If the Stale Sender IDs Response from the Group Manager has no payload, the group member <span class="bcp14">MUST</span> remove all the authentication credentials from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete all its Recipient Contexts used in the group.<a href="#section-11.3-10.1.2" class="pilcrow">¶</a></p>
<p id="section-11.3-10.1.3">
Otherwise, the group member considers the stale Sender IDs specified in the Stale Sender IDs Response from the Group Manager. Then, the group member <span class="bcp14">MUST</span> remove every authentication credential associated with a stale Sender ID from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete each of its Recipient Contexts used in the group whose corresponding Recipient ID is a stale Sender ID.<a href="#section-11.3-10.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-10.2">
            <p id="section-11.3-10.2.1">The group member obtains the latest keying material with version number V' from the Group Manager. This can happen by sending a Key Distribution Request to the Group Manager (see <a href="#ssec-updated-key-only" class="auto internal xref">Section 9.1.1</a>) and <a href="#ssec-updated-and-individual-key" class="auto internal xref">Section 9.1.2</a>).<a href="#section-11.3-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-10.3">
            <p id="section-11.3-10.3.1">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-11.3-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.3-11">If case (c) or case (d) applies, the group member can alternatively perform the following actions.<a href="#section-11.3-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.3-12">
<li id="section-11.3-12.1">
            <p id="section-11.3-12.1.1">The group member re-joins the group (see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>). When doing so, the group member <span class="bcp14">MUST</span> re-join with the same roles it currently has in the group, and <span class="bcp14">MUST</span> request from the Group Manager the authentication credentials of all the current group members. That is, the 'get_creds' parameter of the Join Request <span class="bcp14">MUST</span> be present and <span class="bcp14">MUST</span> be set to the CBOR simple value <code>null</code> (0xf6).<a href="#section-11.3-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-12.2">
            <p id="section-11.3-12.2.1">When receiving the Join Response (see <a href="#ssec-join-resp-processing" class="auto internal xref">Section 6.4</a> and <a href="#ssec-join-resp-processing" class="auto internal xref">Section 6.4</a>), the group member retrieves the set Z of authentication credentials specified in the 'creds' parameter.<a href="#section-11.3-12.2.1" class="pilcrow">¶</a></p>
<p id="section-11.3-12.2.2">
Then, the group member <span class="bcp14">MUST</span> remove every authentication credential which is not in Z from its list of group members' authentication credentials used in the group, and <span class="bcp14">MUST</span> delete each of its Recipient Contexts used in the group that does not include any of the authentication credentials in Z.<a href="#section-11.3-12.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.3-12.3">
            <p id="section-11.3-12.3.1">The group member installs the latest keying material with version number V' and derives the corresponding new Security Context.<a href="#section-11.3-12.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<div id="sec-retrieve-stale-sids">
<section id="section-11.3.1">
          <h4 id="name-retrieve-stale-sender-ids">
<a href="#section-11.3.1" class="section-number selfRef">11.3.1. </a><a href="#name-retrieve-stale-sender-ids" class="section-name selfRef">Retrieve Stale Sender IDs</a>
          </h4>
<p id="section-11.3.1-1">When realizing to have missed one or more group rekeying instances (see <a href="#missed-rekeying" class="auto internal xref">Section 11.3</a>), a node needs to retrieve from the Group Manager the data required to delete some of its stored group members' authentication credentials and Recipient Contexts (see <a href="#stale-sids-fetch" class="auto internal xref">Section 8.4.1</a>). These data is provided as an aggregated set of stale Sender IDs, which are used as specified in <a href="#missed-rekeying" class="auto internal xref">Section 11.3</a>.<a href="#section-11.3.1-1" class="pilcrow">¶</a></p>
<p id="section-11.3.1-2">That is, the node sends a CoAP FETCH request to the endpoint /ace-group/GROUPNAME/stale-sids at the Group Manager defined in <a href="#ssec-resource-stale-sids" class="auto internal xref">Section 8.4</a> of this document, where GROUPNAME is the name of the OSCORE group.<a href="#section-11.3.1-2" class="pilcrow">¶</a></p>
<p id="section-11.3.1-3">The payload of the Stale Sender IDs Request <span class="bcp14">MUST</span> include a CBOR unsigned integer. This encodes the version number V of the most recent group keying material stored and installed by the requesting Client, which is older than the latest, possibly just distributed, keying material with version number V'.<a href="#section-11.3.1-3" class="pilcrow">¶</a></p>
<p id="section-11.3.1-4">The handler <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response, if the request is not formatted correctly. Also, the handler <span class="bcp14">MUST</span> respond with a 4.00 (Bad Request) error response, if the specified version number V is greater or equal than the version number V' associated with the latest keying material in the group, i.e., in case V &gt;= V'.<a href="#section-11.3.1-4" class="pilcrow">¶</a></p>
<p id="section-11.3.1-5">Otherwise, the handler responds with a 2.05 (Content) Stale Sender IDs Response. The payload of the response is formatted as defined below, where SKEW = (V' - V + 1).<a href="#section-11.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3.1-6.1">
              <p id="section-11.3.1-6.1.1">The Group Manager considers ITEMS as the current number of sets of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-11.3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.3.1-6.2">
              <p id="section-11.3.1-6.2.1">If SKEW &gt; ITEMS, the Stale Sender IDs Response <span class="bcp14">MUST NOT</span> have a payload.<a href="#section-11.3.1-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.3.1-6.3">
              <p id="section-11.3.1-6.3.1">Otherwise, the payload of the Stale Sender IDs Response <span class="bcp14">MUST</span> include a CBOR array, where each element is encoded as a CBOR byte string. The order of elements in the CBOR array is irrelevant. The Group Manager populates the CBOR array as follows.<a href="#section-11.3.1-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3.1-6.3.2.1">
                  <p id="section-11.3.1-6.3.2.1.1">The Group Manager creates an empty CBOR array ARRAY and an empty set X.<a href="#section-11.3.1-6.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-11.3.1-6.3.2.2">
                  <p id="section-11.3.1-6.3.2.2.1">The Group Manager considers the SKEW most recent sets of stale Sender IDs for the group. Note that the most recent set is the one associated with the latest version of the group keying material.<a href="#section-11.3.1-6.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-11.3.1-6.3.2.3">
                  <p id="section-11.3.1-6.3.2.3.1">The Group Manager copies all the Sender IDs from the selected sets into X. When doing so, the Group Manager <span class="bcp14">MUST</span> discard duplicates. That is, the same Sender ID <span class="bcp14">MUST NOT</span> be present more than once in the final content of X.<a href="#section-11.3.1-6.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-11.3.1-6.3.2.4">
                  <p id="section-11.3.1-6.3.2.4.1">For each Sender ID in X, the Group Manager encodes it as a CBOR byte string and adds the result to ARRAY.<a href="#section-11.3.1-6.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-11.3.1-6.3.2.5">
                  <p id="section-11.3.1-6.3.2.5.1">Finally, ARRAY is specified as payload of the Stale Sender IDs Response. Note that ARRAY might result in the empty CBOR array.<a href="#section-11.3.1-6.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-11.3.1-7"><a href="#fig-stale-ids-req-resp" class="auto internal xref">Figure 9</a> gives an overview of the exchange described above,  while <a href="#fig-stale-ids-req-resp-ex" class="auto internal xref">Figure 10</a> shows an example of Stale Sender IDs Request-Response.<a href="#section-11.3.1-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-stale-sende"></span><div id="fig-stale-ids-req-resp">
<figure id="figure-9">
            <div id="section-11.3.1-8.1">
              <div class="alignCenter art-svg artwork" id="section-11.3.1-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="552" viewBox="0 0 552 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,64 L 24,160" fill="none" stroke="black"></path>
                  <path d="M 520,64 L 520,160" fill="none" stroke="black"></path>
                  <path d="M 32,96 L 512,96" fill="none" stroke="black"></path>
                  <path d="M 32,144 L 112,144" fill="none" stroke="black"></path>
                  <path d="M 464,144 L 512,144" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="520,96 508,90.4 508,101.6" fill="black" transform="rotate(0,512,96)"></polygon>
                  <polygon class="arrowhead" points="40,144 28,138.4 28,149.6" fill="black" transform="rotate(180,32,144)"></polygon>
                  <g class="text">
                    <text x="520" y="36">Group</text>
                    <text x="20" y="52">Node</text>
                    <text x="520" y="52">Manager</text>
                    <text x="200" y="84">Stale</text>
                    <text x="252" y="84">Sender</text>
                    <text x="296" y="84">IDs</text>
                    <text x="344" y="84">Request</text>
                    <text x="152" y="116">FETCH</text>
                    <text x="304" y="116">/ace-group/GROUPNAME/stale-sids</text>
                    <text x="144" y="148">Stale</text>
                    <text x="196" y="148">Sender</text>
                    <text x="240" y="148">IDs</text>
                    <text x="296" y="148">Response:</text>
                    <text x="356" y="148">2.05</text>
                    <text x="416" y="148">(Content)</text>
                  </g>
                </svg><a href="#section-11.3.1-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-message-flow-of-stale-sende" class="selfRef">Message Flow of Stale Sender IDs Request-Response</a>
            </figcaption></figure>
</div>
<span id="name-example-of-stale-sender-ids"></span><div id="fig-stale-ids-req-resp-ex">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-11.3.1-9.1">
<pre>
   Request:

   Header: FETCH (Code=0.05)
   Uri-Host: "kdc.example.com"
   Uri-Path: "ace-group"
   Uri-Path: "g1"
   Uri-Path: "stale-sids"
   Content-Format: 60 (application/cbor)
   Payload (in CBOR diagnostic notation):
     42


   Response:

   Header: Content (Code=2.05)
   Content-Format: 60 (application/cbor)
   Payload (in CBOR diagnostic notation):
     [h'01', h'fc', h'12ab', h'de44', h'ff']
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-stale-sender-ids" class="selfRef">Example of Stale Sender IDs Request-Response</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupcomm-params">
<section id="section-12">
      <h2 id="name-ace-groupcomm-parameters">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-ace-groupcomm-parameters" class="section-name selfRef">ACE Groupcomm Parameters</a>
      </h2>
<p id="section-12-1">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this application profile defines additional parameters used during the second part of the message exchange with the Group Manager, i.e., after the exchange of Token Transfer Request and Response (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>). The table below summarizes them and specifies the CBOR key to use instead of the full descriptive name.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">Note that the media type "application/ace-groupcomm+cbor" <span class="bcp14">MUST</span> be used when these parameters are transported in the respective message fields.<a href="#section-12-2" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-parameters-2"></span><div id="tab-ACE-Groupcomm-Parameters">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-ace-groupcomm-parameters-2" class="selfRef">ACE Groupcomm Parameters</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">group_senderId</td>
            <td class="text-left" rowspan="1" colspan="1">21</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ecdh_info</td>
            <td class="text-left" rowspan="1" colspan="1">31</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kdc_dh_creds</td>
            <td class="text-left" rowspan="1" colspan="1">32</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_enc_key</td>
            <td class="text-left" rowspan="1" colspan="1">33</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">stale_node_ids</td>
            <td class="text-left" rowspan="1" colspan="1">34</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-12-4">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">The Group Manager is expected to support all the parameters above. Instead, a Client is required to support the new parameters defined in this application profile as specified below (REQ29).<a href="#section-12-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-6.1">
          <p id="section-12-6.1.1">'group_senderId' <span class="bcp14">MUST</span> be supported by a Client that intends to join an OSCORE group with the role of Requester and/or Responder.<a href="#section-12-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-6.2">
          <p id="section-12-6.2.1">'ecdh_info' <span class="bcp14">MUST</span> be supported by a Client that intends to join a group which uses the pairwise mode of Group OSCORE.<a href="#section-12-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-6.3">
          <p id="section-12-6.3.1">'kdc_dh_creds' <span class="bcp14">MUST</span> be supported by a Client that intends to join a group which uses the pairwise mode of Group OSCORE and that does not plan to or cannot rely on an early retrieval of the Group Manager's Diffie-Hellman authentication credential.<a href="#section-12-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-6.4">
          <p id="section-12-6.4.1">'sign_enc_key' <span class="bcp14">MUST</span> be supported by a Client that intends to join a group which uses the group mode of Group OSCORE or to be signature verifier for that group.<a href="#section-12-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-6.5">
          <p id="section-12-6.5.1">'stale_node_ids' <span class="bcp14">MUST</span> be supported.<a href="#section-12-6.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-12-7">When the conditional parameters defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> are used with this application profile, a Client must, should or may support them as specified below (REQ30).<a href="#section-12-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-8.1">
          <p id="section-12-8.1.1">'client_cred' and 'client_cred_verify'. A Client that has an own authentication credential to use in a group <span class="bcp14">MUST</span> support these parameters.<a href="#section-12-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.2">
          <p id="section-12-8.2.1">'kdcchallenge'. A Client that has an own authentication credential to use in a group and that provides the access token to the Group Manager through a Token Transfer Request (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>) <span class="bcp14">MUST</span> support this parameter.<a href="#section-12-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.3">
          <p id="section-12-8.3.1">'creds_repo'. This parameter is not relevant for this application profile, since the Group Manager always acts as repository of the group members' authentication credentials.<a href="#section-12-8.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.4">
          <p id="section-12-8.4.1">'group_policies'. A Client that is interested in the specific policies used in a group, but that does not know them or cannot become aware of them before joining that group, <span class="bcp14">SHOULD</span> support this parameter.<a href="#section-12-8.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.5">
          <p id="section-12-8.5.1">'peer_roles'. A Client <span class="bcp14">MUST</span> support this parameter, since in this application profile it is relevant for Clients to know the roles of the group member associated with each authentication credential.<a href="#section-12-8.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.6">
          <p id="section-12-8.6.1">'kdc_nonce', 'kdc_cred', and 'kdc_cred_verify'. A Client <span class="bcp14">MUST</span> support these parameters, since the Group Manager's authentication credential is required to process messages protected with Group OSCORE (see Section 4.3 of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-12-8.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.7">
          <p id="section-12-8.7.1">'mgt_key_material'. A Client that supports an advanced rekeying scheme possibly used in the group, such as based on one-to-many rekeying messages sent by the Group Manager (e.g., over IP multicast), <span class="bcp14">MUST</span> support this parameter.<a href="#section-12-8.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-8.8">
          <p id="section-12-8.8.1">'control_group_uri'. A Client that supports the hosting of local resources each associated with a group (hence acting as CoAP server) and the reception of one-to-many requests sent to those resources by the Group Manager (e.g., over IP
multicast) <span class="bcp14">MUST</span> support this parameter.<a href="#section-12-8.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="error-types">
<section id="section-13">
      <h2 id="name-ace-groupcomm-error-identif">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-ace-groupcomm-error-identif" class="section-name selfRef">ACE Groupcomm Error Identifiers</a>
      </h2>
<p id="section-13-1">In addition to what is defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-9" class="relref">Section 9</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, this document defines new values that the Group Manager can use as error identifiers. These are used in error responses with Content-Format "application/concise-problem-details+cbor" <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>, as values of the 'error-id' field within the Custom Problem Detail entry 'ace- groupcomm-error' (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-13-1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-error-identifi"></span><div id="tab-ACE-Groupcomm-Error-Identifiers">
<table class="center" id="table-4">
        <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-ace-groupcomm-error-identifi" class="selfRef">ACE Groupcomm Error Identifiers</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">Signatures not used in the group</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">Operation permitted only to signature verifiers</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">Group currently not active</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-13-3">If the Client supports the problem-details format <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and the Custom Problem Detail entry 'ace-groupcomm-error' defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, and is able to understand the error specified in the 'error-id' field therein, then the Client may use that information to determine what actions to take next. If the Concise Problem Details data item specified in the error response includes the 'detail' entry and the Client supports it, such an entry may provide additional context.<a href="#section-13-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-4.1">
          <p id="section-13-4.1.1">In case of error 7, the Client should stop sending the request in question to the Group Manager. In this application profile, this error is relevant only for a signature verifier, in case it tries to access resources related to a pairwise-only group.<a href="#section-13-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-4.2">
          <p id="section-13-4.2.1">In case of error 8, the Client should stop sending the request in question to the Group Manager.<a href="#section-13-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-4.3">
          <p id="section-13-4.3.1">In case of error 9, the Client should wait for a certain (pre-configured) amount of time, before trying to re-send its request to the Group Manager.<a href="#section-13-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="default-values-for-group-configuration-parameters">
<section id="section-14">
      <h2 id="name-default-values-for-group-co">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-default-values-for-group-co" class="section-name selfRef">Default Values for Group Configuration Parameters</a>
      </h2>
<p id="section-14-1">This section defines the default values that the Group Manager assumes for the configuration parameters of an OSCORE group, unless differently specified when creating and configuring the group. This can be achieved as specified in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="cite xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">A possible reason for the Group Manager to consider default values different from those recommended in this section is to ensure that each of those are consistent with what the Group Manager supports, e.g., in terms of signature algorithm and format of authentication credentials used in the OSCORE group.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">This ensures that the Group Manager is able to perform the operations defined in this document, e.g., to achieve proof-of-possession of a joining node's private key (see <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>), as well as to provide a joining node with its own authentication credential and the associated proof-of-possession challenge (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>).<a href="#section-14-3" class="pilcrow">¶</a></p>
<p id="section-14-4">The following builds on the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>, the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>, the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>, and the "COSE Elliptic Curves" registry <span>[<a href="#COSE.Elliptic.Curves" class="cite xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-14-4" class="pilcrow">¶</a></p>
<div id="common">
<section id="section-14.1">
        <h3 id="name-common">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-common" class="section-name selfRef">Common</a>
        </h3>
<p id="section-14.1-1">This section always applies, as related to common configuration parameters.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-2.1">
            <p id="section-14.1-2.1.1">For the HKDF Algorithm 'hkdf', the Group Manager <span class="bcp14">SHOULD</span> use HKDF SHA-256, defined as default in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. In the 'hkdf' parameter, this HKDF Algorithm is specified by the HMAC Algorithm HMAC 256/256 (COSE algorithm encoding: 5).<a href="#section-14.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.2">
            <p id="section-14.1-2.2.1">For the Authentication Credential Format 'cred_fmt', the Group Manager <span class="bcp14">SHOULD</span> use CBOR Web Token Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, i.e., the COSE Header Parameter 'kccs' (COSE header parameter encoding: 14).<a href="#section-14.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.3">
            <p id="section-14.1-2.3.1">For 'max_stale_sets', the Group Manager <span class="bcp14">SHOULD</span> consider N = 3 as the maximum number of stored sets of stale Sender IDs for the group (see <a href="#sssec-stale-sender-ids" class="auto internal xref">Section 7.1</a>).<a href="#section-14.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="group-mode">
<section id="section-14.2">
        <h3 id="name-group-mode">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-group-mode" class="section-name selfRef">Group Mode</a>
        </h3>
<p id="section-14.2-1">This section applies if the group uses (also) the group mode of Group OSCORE.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2-2.1">
            <p id="section-14.2-2.1.1">For the Group Encryption Algorithm 'gp_enc_alg' used to encrypt messages protected with the group mode, the Group Manager <span class="bcp14">SHOULD</span> use AES-CCM-16-64-128 (COSE algorithm encoding: 10).<a href="#section-14.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.2">
            <p id="section-14.2-2.2.1">For the Signature Algorithm 'sign_alg' used to sign messages protected with the group mode, the Group Manager <span class="bcp14">SHOULD</span> use EdDSA <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>.<a href="#section-14.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.3">
            <p id="section-14.2-2.3.1">For the parameters 'sign_params' of the Signature Algorithm, the Group Manager <span class="bcp14">SHOULD</span> use the following:<a href="#section-14.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2-2.3.2.1">
                <p id="section-14.2-2.3.2.1.1">The array [[OKP], [OKP, Ed25519]], in case EdDSA is assumed or specified for 'sign_alg'. This indicates to use the COSE key type OKP and the elliptic curve Ed25519 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>.<a href="#section-14.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.2-2.3.2.2">
                <p id="section-14.2-2.3.2.2.1">The array [[EC2], [EC2, P-256]], in case ES256 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-256.<a href="#section-14.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.2-2.3.2.3">
                <p id="section-14.2-2.3.2.3.1">The array [[EC2], [EC2, P-384]], in case ES384 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-384.<a href="#section-14.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.2-2.3.2.4">
                <p id="section-14.2-2.3.2.4.1">The array [[EC2], [EC2, P-521]], in case ES512 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-521.<a href="#section-14.2-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.2-2.3.2.5">
                <p id="section-14.2-2.3.2.5.1">The array [[RSA], [RSA]], in case PS256, PS384 or PS512 <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type RSA.<a href="#section-14.2-2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="pairwise-mode">
<section id="section-14.3">
        <h3 id="name-pairwise-mode">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-pairwise-mode" class="section-name selfRef">Pairwise Mode</a>
        </h3>
<p id="section-14.3-1">This section applies if the group uses (also) the pairwise mode of Group OSCORE.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-2.1">
            <p id="section-14.3-2.1.1">For the AEAD Algorithm 'alg' used to encrypt messages protected with the pairwise mode, the Group Manager <span class="bcp14">SHOULD</span> use the same default value defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, i.e., AES-CCM-16-64-128 (COSE algorithm encoding: 10).<a href="#section-14.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.2">
            <p id="section-14.3-2.2.1">For the Pairwise Key Agreement Algorithm 'ecdh_alg' used to compute static-static Diffie-Hellman shared secrets, the Group Manager <span class="bcp14">SHOULD</span> use the following:<a href="#section-14.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-2.2.2.1">
                <p id="section-14.3-2.2.2.1.1">The ECDH algorithm ECDH-SS + HKDF-256 (COSE algorithm encoding: -27), in case the HKDF Algorithm assumed or specified for 'hkdf' is HKDF SHA-256 (specified by the HMAC Algorithm HMAC 256/256).<a href="#section-14.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.3-2.2.2.2">
                <p id="section-14.3-2.2.2.2.1">The ECDH algorithm ECDH-SS + HKDF-512 (COSE algorithm encoding: -28), in case the HKDF Algorithm specified for 'hkdf' is HKDF SHA-512 (specified by the HMAC Algorithm HMAC HMAC 512/512).<a href="#section-14.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-14.3-2.3">
            <p id="section-14.3-2.3.1">For the parameter 'ecdh_params' of the Pairwise Key Agreement Algorithm, the Group Manager <span class="bcp14">SHOULD</span> use the following:<a href="#section-14.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-2.3.2.1">
                <p id="section-14.3-2.3.2.1.1">The array [[OKP], [OKP, X25519]], in case EdDSA is assumed or specified for 'sign_alg', or in case the group is a pairwise-only group. This indicates to use the COSE key type OKP and the elliptic curve X25519 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>.<a href="#section-14.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.3-2.3.2.2">
                <p id="section-14.3-2.3.2.2.1">The array [[EC2], [EC2, P-256]], in case ES256 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-256.<a href="#section-14.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.3-2.3.2.3">
                <p id="section-14.3-2.3.2.3.1">The array [[EC2], [EC2, P-384]], in case ES384 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-384.<a href="#section-14.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.3-2.3.2.4">
                <p id="section-14.3-2.3.2.4.1">The array [[EC2], [EC2, P-521]], in case ES512 <span>[<a href="#RFC6979" class="cite xref">RFC6979</a>]</span> is specified for 'sign_alg'. This indicates to use the COSE key type EC2 and the elliptic curve P-521.<a href="#section-14.3-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-15-1">Security considerations for this profile are inherited from <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, the ACE framework for Authentication and Authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, and the specific transport profile of ACE signaled by the AS, such as <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">The following security considerations also apply for this profile.<a href="#section-15-2" class="pilcrow">¶</a></p>
<div id="ssec-security-considerations-management">
<section id="section-15.1">
        <h3 id="name-management-of-oscore-groups">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-management-of-oscore-groups" class="section-name selfRef">Management of OSCORE Groups</a>
        </h3>
<p id="section-15.1-1">This profile leverages the following management aspects related to OSCORE groups and discussed in the sections of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span> referred below.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1-2.1">
            <p id="section-15.1-2.1.1">Management of group keying material (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12.2" class="relref">Section 12.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The Group Manager is responsible for the renewal and re-distribution of the keying material in the groups of its competence (rekeying).<a href="#section-15.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-15.1-2.1.2">
The Group Manager performs a rekeying when one or more members leave the group, thus preserving forward security and ensuring that the security properties of Group OSCORE are fulfilled. According to the specific application requirements, the Group Manager can also rekey the group upon a new node's joining, in case backward security has also to be preserved.<a href="#section-15.1-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-2.2">
            <p id="section-15.1-2.2.1">Provisioning and retrieval of authentication credentials (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-12" class="relref">Section 12</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). The Group Manager acts as repository of authentication credentials of group members, and provides them upon request.<a href="#section-15.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-2.3">
            <p id="section-15.1-2.3.1">Freshness of messages (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). This concerns how a recipient node can assert freshness of messages received within the group.<a href="#section-15.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.1-3">Before sending the Join Response, the Group Manager <span class="bcp14">MUST</span> verify that the joining node actually owns the associated private key. To this end, the Group Manager can rely on the proof-of-possession challenge-response defined in <a href="#sec-joining-node-to-GM" class="auto internal xref">Section 6</a>.<a href="#section-15.1-3" class="pilcrow">¶</a></p>
<p id="section-15.1-4">Alternatively, when establishing a secure communication association with the Group Manager, the joining node can provide the Group Manager with its own authentication credential, and use the public key included thereof as asymmetric proof-of-possession key. For example, this is the case when the joining node relies on <span><a href="https://rfc-editor.org/rfc/rfc9202#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and authenticates itself during the DTLS handshake with the Group Manager. However, this requires the authentication credential to be in the format used in the OSCORE group, and that both the authentication credential of the joining node and the included public key are compatible with the signature or ECDH algorithm, and with possible associated parameters used in the OSCORE group.<a href="#section-15.1-4" class="pilcrow">¶</a></p>
<p id="section-15.1-5">A node may have joined multiple OSCORE groups under different non-synchronized Group Managers. Therefore, it can happen that those OSCORE groups have the same Group Identifier (Gid). It follows that, upon receiving a Group OSCORE message addressed to one of those groups, the node would have multiple Security Contexts matching with the Gid in the incoming message. It is up to the application to decide how to handle such collisions of Group Identifiers, e.g., by trying to process the incoming message using one Security Context at the time until the right one is found.<a href="#section-15.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-security-considerations-challenges">
<section id="section-15.2">
        <h3 id="name-size-of-nonces-as-proof-of-">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-size-of-nonces-as-proof-of-" class="section-name selfRef">Size of Nonces as Proof-of-Possesion Challenge</a>
        </h3>
<p id="section-15.2-1">With reference to the Join Request message in <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a>, the proof-of-possession (PoP) evidence included in 'client_cred_verify' is computed over an input including also N_C | N_S, where | denotes concatenation.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">For the N_C challenge, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random nonce. Furthermore, N_C is always conveyed in the 'cnonce' parameter of the Join Request, which is always sent over the secure communication association between the joining node and the Group Manager.<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<p id="section-15.2-3">As defined in <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>, the way the N_S value is computed depends on the particular way the joining node provides the Group Manager with the access token, as well as on following interactions between the two.<a href="#section-15.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-4.1">
            <p id="section-15.2-4.1.1">If the access token has not been provided to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>, then N_S is computed as a 32-byte long challenge. For an example, see point (2) of <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>.<a href="#section-15.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-4.2">
            <p id="section-15.2-4.2.1">If the access token has been provided to the Group Manager by means of a Token Transfer Request to the /authz-info endpoint as in <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>, then N_S takes the most recent value provided to the Client by the Group Manager in the 'kdcchallenge' parameter, as specified in point (1) of <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>. This value is provided either in the Token Transfer Response (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>), or in a 4.00 (Bad Request) error response to a following Join Request (see <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>). In either case, it is <span class="bcp14">RECOMMENDED</span> to use an 8-byte long random challenge as value for N_S.<a href="#section-15.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.2-5">If we consider both N_C and N_S to take 8-byte long values, the following considerations hold.<a href="#section-15.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-6.1">
            <p id="section-15.2-6.1.1">Let us consider both N_C and N_S as taking random values, and the Group Manager to never change the value of the N_S provided to a Client during the lifetime of an access token. Then, as per the birthday paradox, the average collision for N_S will happen after 2^32 new transferred access tokens, while the average collision for N_C will happen after 2^32 new Join Requests. This amounts to considerably more token provisionings than the expected new joinings to OSCORE groups under a same Group Manager, as well as to considerably more requests to join OSCORE groups from a same Client using a same access token under a same Group Manager.<a href="#section-15.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-6.2">
            <p id="section-15.2-6.2.1"><span><a href="https://rfc-editor.org/rfc/rfc9203#section-7" class="relref">Section 7</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> as well <span><a href="https://rfc-editor.org/rfc/rfc8613#appendix-B.2" class="relref">Appendix B.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> recommend the use of 8-byte random values as well. Unlike in those cases, the values of N_C and N_S considered in this document are not used for as sensitive operations as the derivation of a Security Context, and thus do not have possible implications in the security of AEAD ciphers.<a href="#section-15.2-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-security-considerations-reusage-nonces">
<section id="section-15.3">
        <h3 id="name-reusage-of-nonces-for-proof">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-reusage-of-nonces-for-proof" class="section-name selfRef">Reusage of Nonces for Proof-of-Possession Input</a>
        </h3>
<p id="section-15.3-1">As long as the Group Manager preserves the same N_S value currently associated with an access token, i.e., the latest value provided to a Client in a 'kdcchallenge' parameter, the Client is able to successfully reuse the same proof-of-possession (PoP) input for multiple Join Requests to that Group Manager.<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3-2">In particular, the Client can reuse the same N_C value for every Join Request to the Group Manager, and combine it with the same unchanged N_S value. This results in reusing the same PoP input for producing the PoP evidence to include in the 'client_cred_verify' parameter of the Join Requests.<a href="#section-15.3-2" class="pilcrow">¶</a></p>
<p id="section-15.3-3">Unless the Group Manager maintains a list of N_C values already used by that Client since the latest update to the N_S value associated with the access token, the Group Manager can be forced to falsely believe that the Client possesses its own private key at that point in time, upon verifying the PoP evidence in the 'client_cred_verify' parameter.<a href="#section-15.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-16">
      <h2 id="name-iana-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-16-1">This document has the following actions for IANA.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-16-2" class="pilcrow">¶</a></p>
<div id="iana-kinfo">
<section id="section-16.1">
        <h3 id="name-oauth-parameters">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-oauth-parameters" class="section-name selfRef">OAuth Parameters</a>
        </h3>
<p id="section-16.1-1">IANA is asked to register the following entries in the "OAuth Parameters" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-16.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.1-2.1">
            <p id="section-16.1-2.1.1">Name: ecdh_info<a href="#section-16.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.2">
            <p id="section-16.1-2.2.1">Parameter Usage Location: client-rs request, rs-client response<a href="#section-16.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.3">
            <p id="section-16.1-2.3.1">Change Controller: IETF<a href="#section-16.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.4">
            <p id="section-16.1-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.1-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.1-4.1">
            <p id="section-16.1-4.1.1">Name: kdc_dh_creds<a href="#section-16.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-4.2">
            <p id="section-16.1-4.2.1">Parameter Usage Location: client-rs request, rs-client response<a href="#section-16.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-4.3">
            <p id="section-16.1-4.3.1">Change Controller: IETF<a href="#section-16.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-4.4">
            <p id="section-16.1-4.4.1">Reference: [RFC-XXXX]<a href="#section-16.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-kinfo-map">
<section id="section-16.2">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings</a>
        </h3>
<p id="section-16.2-1">IANA is asked to register the following entries in the "OAuth Parameters CBOR Mappings" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.10" class="relref">Section 8.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-16.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.2-2.1">
            <p id="section-16.2-2.1.1">Name: ecdh_info<a href="#section-16.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-2.2">
            <p id="section-16.2-2.2.1">CBOR Key: TBD (range -256 to 255)<a href="#section-16.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-2.3">
            <p id="section-16.2-2.3.1">Value Type: Null or array<a href="#section-16.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-2.4">
            <p id="section-16.2-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-2.5">
            <p id="section-16.2-2.5.1">Original Specification: [RFC-XXXX]<a href="#section-16.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.2-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.2-4.1">
            <p id="section-16.2-4.1.1">Name: kdc_dh_creds<a href="#section-16.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-4.2">
            <p id="section-16.2-4.2.1">CBOR Key: TBD (range -256 to 255)<a href="#section-16.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-4.3">
            <p id="section-16.2-4.3.1">Value Type: Null or array<a href="#section-16.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-4.4">
            <p id="section-16.2-4.4.1">Reference: [RFC-XXXX]<a href="#section-16.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.2-4.5">
            <p id="section-16.2-4.5.1">Original Specification: [RFC-XXXX]<a href="#section-16.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-ace-groupcomm-parameters-registry">
<section id="section-16.3">
        <h3 id="name-ace-groupcomm-parameters-3">
<a href="#section-16.3" class="section-number selfRef">16.3. </a><a href="#name-ace-groupcomm-parameters-3" class="section-name selfRef">ACE Groupcomm Parameters</a>
        </h3>
<p id="section-16.3-1">IANA is asked to register the following entries to the "ACE Groupcomm Parameters" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.7" class="relref">Section 11.7</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-16.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.3-2.1">
            <p id="section-16.3-2.1.1">Name: group_senderId<a href="#section-16.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-2.2">
            <p id="section-16.3-2.2.1">CBOR Key: 21<a href="#section-16.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-2.3">
            <p id="section-16.3-2.3.1">CBOR Type: bstr<a href="#section-16.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-2.4">
            <p id="section-16.3-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.3-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.3-4.1">
            <p id="section-16.3-4.1.1">Name: ecdh_info<a href="#section-16.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-4.2">
            <p id="section-16.3-4.2.1">CBOR Key: 31<a href="#section-16.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-4.3">
            <p id="section-16.3-4.3.1">CBOR Type: array<a href="#section-16.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-4.4">
            <p id="section-16.3-4.4.1">Reference: [RFC-XXXX]<a href="#section-16.3-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.3-5"><br></p>
<ul class="normal">
<li class="normal" id="section-16.3-6.1">
            <p id="section-16.3-6.1.1">Name: kdc_dh_creds<a href="#section-16.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-6.2">
            <p id="section-16.3-6.2.1">CBOR Key: 32<a href="#section-16.3-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-6.3">
            <p id="section-16.3-6.3.1">CBOR Type: array<a href="#section-16.3-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-6.4">
            <p id="section-16.3-6.4.1">Reference: [RFC-XXXX]<a href="#section-16.3-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.3-7"><br></p>
<ul class="normal">
<li class="normal" id="section-16.3-8.1">
            <p id="section-16.3-8.1.1">Name: sign_enc_key<a href="#section-16.3-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-8.2">
            <p id="section-16.3-8.2.1">CBOR Key: 33<a href="#section-16.3-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-8.3">
            <p id="section-16.3-8.3.1">CBOR Type: bstr<a href="#section-16.3-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-8.4">
            <p id="section-16.3-8.4.1">Reference: [RFC-XXXX]<a href="#section-16.3-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.3-9"><br></p>
<ul class="normal">
<li class="normal" id="section-16.3-10.1">
            <p id="section-16.3-10.1.1">Name: stale_node_ids<a href="#section-16.3-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-10.2">
            <p id="section-16.3-10.2.1">CBOR Key: 34<a href="#section-16.3-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-10.3">
            <p id="section-16.3-10.3.1">CBOR Type: array<a href="#section-16.3-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.3-10.4">
            <p id="section-16.3-10.4.1">Reference: [RFC-XXXX]<a href="#section-16.3-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-groupcomm-keys-registry">
<section id="section-16.4">
        <h3 id="name-ace-groupcomm-key-types">
<a href="#section-16.4" class="section-number selfRef">16.4. </a><a href="#name-ace-groupcomm-key-types" class="section-name selfRef">ACE Groupcomm Key Types</a>
        </h3>
<p id="section-16.4-1">IANA is asked to register the following entry in the "ACE Groupcomm Key Types" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.8" class="relref">Section 11.8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-16.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.4-2.1">
            <p id="section-16.4-2.1.1">Name: Group_OSCORE_Input_Material object<a href="#section-16.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-2.2">
            <p id="section-16.4-2.2.1">Key Type Value: GROUPCOMM_KEY_TBD<a href="#section-16.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-2.3">
            <p id="section-16.4-2.3.1">Profile: "coap_group_oscore_app", defined in <a href="#ssec-iana-groupcomm-profile-registry" class="auto internal xref">Section 16.5</a> of this document.<a href="#section-16.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-2.4">
            <p id="section-16.4-2.4.1">Description: A Group_OSCORE_Input_Material object encoded as described in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document.<a href="#section-16.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.4-2.5">
            <p id="section-16.4-2.5.1">Reference: [RFC-XXXX]<a href="#section-16.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-groupcomm-profile-registry">
<section id="section-16.5">
        <h3 id="name-ace-groupcomm-profiles">
<a href="#section-16.5" class="section-number selfRef">16.5. </a><a href="#name-ace-groupcomm-profiles" class="section-name selfRef">ACE Groupcomm Profiles</a>
        </h3>
<p id="section-16.5-1">IANA is asked to register the following entry in the "ACE Groupcomm Profiles" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.9" class="relref">Section 11.9</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-16.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.5-2.1">
            <p id="section-16.5-2.1.1">Name: coap_group_oscore_app<a href="#section-16.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-2.2">
            <p id="section-16.5-2.2.1">Description: Application profile to provision keying material for participating in group communication protected with Group OSCORE as per <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-16.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-2.3">
            <p id="section-16.5-2.3.1">CBOR Value: PROFILE_TBD<a href="#section-16.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.5-2.4">
            <p id="section-16.5-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-security-context-parameter-registry">
<section id="section-16.6">
        <h3 id="name-oscore-security-context-par">
<a href="#section-16.6" class="section-number selfRef">16.6. </a><a href="#name-oscore-security-context-par" class="section-name selfRef">OSCORE Security Context Parameters</a>
        </h3>
<p id="section-16.6-1">IANA is asked to register the following entries in the "OSCORE Security Context Parameters" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9203#section-9.4" class="relref">Section 9.4</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-16.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.6-2.1">
            <p id="section-16.6-2.1.1">Name: group_SenderId<a href="#section-16.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.2">
            <p id="section-16.6-2.2.1">CBOR Label: 7<a href="#section-16.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.3">
            <p id="section-16.6-2.3.1">CBOR Type: byte string<a href="#section-16.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.4">
            <p id="section-16.6-2.4.1">Registry: -<a href="#section-16.6-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.5">
            <p id="section-16.6-2.5.1">Description: OSCORE Sender ID assigned to a member of an OSCORE group<a href="#section-16.6-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-2.6">
            <p id="section-16.6-2.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-4.1">
            <p id="section-16.6-4.1.1">Name: cred_fmt<a href="#section-16.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-4.2">
            <p id="section-16.6-4.2.1">CBOR Label: 8<a href="#section-16.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-4.3">
            <p id="section-16.6-4.3.1">CBOR Type: integer<a href="#section-16.6-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-4.4">
            <p id="section-16.6-4.4.1">Registry: <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span> Labels (integer)<a href="#section-16.6-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-4.5">
            <p id="section-16.6-4.5.1">Description: Format of authentication credentials to be used in the OSCORE group<a href="#section-16.6-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-4.6">
            <p id="section-16.6-4.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-5"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-6.1">
            <p id="section-16.6-6.1.1">Name: gp_enc_alg<a href="#section-16.6-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-6.2">
            <p id="section-16.6-6.2.1">CBOR Label: 9<a href="#section-16.6-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-6.3">
            <p id="section-16.6-6.3.1">CBOR Type: text string / integer<a href="#section-16.6-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-6.4">
            <p id="section-16.6-6.4.1">Registry: <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> Values<a href="#section-16.6-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-6.5">
            <p id="section-16.6-6.5.1">Description: OSCORE Group Encryption Algorithm Value<a href="#section-16.6-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-6.6">
            <p id="section-16.6-6.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-6.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-7"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-8.1">
            <p id="section-16.6-8.1.1">Name: sign_alg<a href="#section-16.6-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-8.2">
            <p id="section-16.6-8.2.1">CBOR Label: 10<a href="#section-16.6-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-8.3">
            <p id="section-16.6-8.3.1">CBOR Type: text string / integer<a href="#section-16.6-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-8.4">
            <p id="section-16.6-8.4.1">Registry: <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> Values<a href="#section-16.6-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-8.5">
            <p id="section-16.6-8.5.1">Description: OSCORE Signature Algorithm Value<a href="#section-16.6-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-8.6">
            <p id="section-16.6-8.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-8.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-9"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-10.1">
            <p id="section-16.6-10.1.1">Name: sign_params<a href="#section-16.6-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-10.2">
            <p id="section-16.6-10.2.1">CBOR Label: 11<a href="#section-16.6-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-10.3">
            <p id="section-16.6-10.3.1">CBOR Type: array<a href="#section-16.6-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-10.4">
            <p id="section-16.6-10.4.1">Registry: <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> Capabilities, <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span> Capabilities, <span>[<a href="#COSE.Elliptic.Curves" class="cite xref">COSE.Elliptic.Curves</a>]</span> Values<a href="#section-16.6-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-10.5">
            <p id="section-16.6-10.5.1">Description: OSCORE Signature Algorithm Parameters<a href="#section-16.6-10.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-10.6">
            <p id="section-16.6-10.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-10.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-11"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-12.1">
            <p id="section-16.6-12.1.1">Name: ecdh_alg<a href="#section-16.6-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-12.2">
            <p id="section-16.6-12.2.1">CBOR Label: 12<a href="#section-16.6-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-12.3">
            <p id="section-16.6-12.3.1">CBOR Type: text string / integer<a href="#section-16.6-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-12.4">
            <p id="section-16.6-12.4.1">Registry: <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> Values<a href="#section-16.6-12.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-12.5">
            <p id="section-16.6-12.5.1">Description: OSCORE Pairwise Key Agreement Algorithm Value<a href="#section-16.6-12.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-12.6">
            <p id="section-16.6-12.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-12.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.6-13"><br></p>
<ul class="normal">
<li class="normal" id="section-16.6-14.1">
            <p id="section-16.6-14.1.1">Name: ecdh_params<a href="#section-16.6-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-14.2">
            <p id="section-16.6-14.2.1">CBOR Label: 13<a href="#section-16.6-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-14.3">
            <p id="section-16.6-14.3.1">CBOR Type: array<a href="#section-16.6-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-14.4">
            <p id="section-16.6-14.4.1">Registry: <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> Capabilities, <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span> Capabilities, <span>[<a href="#COSE.Elliptic.Curves" class="cite xref">COSE.Elliptic.Curves</a>]</span> Values<a href="#section-16.6-14.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-14.5">
            <p id="section-16.6-14.5.1">Description: OSCORE Pairwise Key Agreement Algorithm Parameters<a href="#section-16.6-14.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.6-14.6">
            <p id="section-16.6-14.6.1">Reference: [RFC-XXXX]<a href="#section-16.6-14.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-tls-esporter-label-registry">
<section id="section-16.7">
        <h3 id="name-tls-exporter-labels">
<a href="#section-16.7" class="section-number selfRef">16.7. </a><a href="#name-tls-exporter-labels" class="section-name selfRef">TLS Exporter Labels</a>
        </h3>
<p id="section-16.7-1">IANA is asked to register the following entry in the "TLS Exporter Labels" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-6" class="relref">Section 6</a> of [<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> and updated in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-12" class="relref">Section 12</a> of [<a href="#RFC8447" class="cite xref">RFC8447</a>]</span>.<a href="#section-16.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.7-2.1">
            <p id="section-16.7-2.1.1">Value: EXPORTER-ACE-Pop-Input-coap-group-oscore-app<a href="#section-16.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.7-2.2">
            <p id="section-16.7-2.2.1">DTLS-OK: Y<a href="#section-16.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.7-2.3">
            <p id="section-16.7-2.3.1">Recommended: N<a href="#section-16.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.7-2.4">
            <p id="section-16.7-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.7-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-AIF-registry">
<section id="section-16.8">
        <h3 id="name-aif-media-type-sub-paramete">
<a href="#section-16.8" class="section-number selfRef">16.8. </a><a href="#name-aif-media-type-sub-paramete" class="section-name selfRef">AIF Media-Type Sub-Parameters</a>
        </h3>
<p id="section-16.8-1">For the media-types application/aif+cbor and application/aif+json defined in <span><a href="https://rfc-editor.org/rfc/rfc9237#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>, IANA is requested to register the following entries for the two media-type parameters Toid and Tperm, in the respective sub-registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9237#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> within the "MIME Media Type Sub-Parameter" registry group.<a href="#section-16.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.8-2.1">
            <p id="section-16.8-2.1.1">Parameter: Toid<a href="#section-16.8-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-2.2">
            <p id="section-16.8-2.2.1">Name: oscore-gname<a href="#section-16.8-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-2.3">
            <p id="section-16.8-2.3.1">Description/Specification: OSCORE group name<a href="#section-16.8-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-2.4">
            <p id="section-16.8-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.8-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.8-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.8-4.1">
            <p id="section-16.8-4.1.1">Parameter: Tperm<a href="#section-16.8-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-4.2">
            <p id="section-16.8-4.2.1">Name: oscore-gperm<a href="#section-16.8-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-4.3">
            <p id="section-16.8-4.3.1">Description/Specification: permissions pertaining OSCORE groups<a href="#section-16.8-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.8-4.4">
            <p id="section-16.8-4.4.1">Reference: [RFC-XXXX]<a href="#section-16.8-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-coap-content-format-registry">
<section id="section-16.9">
        <h3 id="name-coap-content-formats">
<a href="#section-16.9" class="section-number selfRef">16.9. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content-Formats</a>
        </h3>
<p id="section-16.9-1">IANA is asked to register the following entries in the "CoAP Content-Formats" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-16.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.9-2.1">
            <p id="section-16.9-2.1.1">Content Type: application/aif+cbor;Toid="oscore-gname",Tperm="oscore-gperm"<a href="#section-16.9-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-2.2">
            <p id="section-16.9-2.2.1">Content Coding: -<a href="#section-16.9-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-2.3">
            <p id="section-16.9-2.3.1">ID: 292 (suggested)<a href="#section-16.9-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-2.4">
            <p id="section-16.9-2.4.1">Reference: [RFC-XXXX]<a href="#section-16.9-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.9-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.9-4.1">
            <p id="section-16.9-4.1.1">Content Type: application/aif+json;Toid="oscore-gname",Tperm="oscore-gperm"<a href="#section-16.9-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-4.2">
            <p id="section-16.9-4.2.1">Content Coding: -<a href="#section-16.9-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-4.3">
            <p id="section-16.9-4.3.1">ID: 293 (suggested)<a href="#section-16.9-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.9-4.4">
            <p id="section-16.9-4.4.1">Reference: [RFC-XXXX]<a href="#section-16.9-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-rt">
<section id="section-16.10">
        <h3 id="name-core-resource-type">
<a href="#section-16.10" class="section-number selfRef">16.10. </a><a href="#name-core-resource-type" class="section-name selfRef">CoRE Resource Type</a>
        </h3>
<p id="section-16.10-1">IANA is asked to register the following entry in the "Resource Type (rt=) Link Target Attribute Values" registry within the "Constrained Restful Environments (CoRE) Parameters" registry group.<a href="#section-16.10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.10-2.1">
            <p id="section-16.10-2.1.1">Value: "core.osc.gm"<a href="#section-16.10-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.10-2.2">
            <p id="section-16.10-2.2.1">Description: Group-membership resource of an OSCORE Group Manager.<a href="#section-16.10-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.10-2.3">
            <p id="section-16.10-2.3.1">Reference: [RFC-XXXX]<a href="#section-16.10-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.10-3">Client applications can use this resource type to discover a group membership resource at an OSCORE Group Manager, where to send a request for joining the corresponding OSCORE group.<a href="#section-16.10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-ace-groupcomm-errors">
<section id="section-16.11">
        <h3 id="name-ace-groupcomm-errors">
<a href="#section-16.11" class="section-number selfRef">16.11. </a><a href="#name-ace-groupcomm-errors" class="section-name selfRef">ACE Groupcomm Errors</a>
        </h3>
<p id="section-16.11-1">IANA is asked to register the following entries in the "ACE Groupcomm Errors" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.12" class="relref">Section 11.12</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-16.11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.11-2.1">
            <p id="section-16.11-2.1.1">Value: 7<a href="#section-16.11-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-2.2">
            <p id="section-16.11-2.2.1">Description: Signatures not used in the group.<a href="#section-16.11-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-2.3">
            <p id="section-16.11-2.3.1">Reference: [RFC-XXXX]<a href="#section-16.11-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.11-3"><br></p>
<ul class="normal">
<li class="normal" id="section-16.11-4.1">
            <p id="section-16.11-4.1.1">Value: 8<a href="#section-16.11-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-4.2">
            <p id="section-16.11-4.2.1">Description: Operation permitted only to signature verifiers.<a href="#section-16.11-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-4.3">
            <p id="section-16.11-4.3.1">Reference: [RFC-XXXX]<a href="#section-16.11-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.11-5"><br></p>
<ul class="normal">
<li class="normal" id="section-16.11-6.1">
            <p id="section-16.11-6.1.1">Value: 9<a href="#section-16.11-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-6.2">
            <p id="section-16.11-6.2.1">Description: Group currently not active.<a href="#section-16.11-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.11-6.3">
            <p id="section-16.11-6.3.1">Reference: [RFC-XXXX]<a href="#section-16.11-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-iana-group-oscore-roles-registry">
<section id="section-16.12">
        <h3 id="name-group-oscore-roles">
<a href="#section-16.12" class="section-number selfRef">16.12. </a><a href="#name-group-oscore-roles" class="section-name selfRef">Group OSCORE Roles</a>
        </h3>
<p id="section-16.12-1">This document establishes the IANA "Group OSCORE Roles" registry. The registry has been created to use the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#ssec-iana-expert-review" class="auto internal xref">Section 16.13</a>.<a href="#section-16.12-1" class="pilcrow">¶</a></p>
<p id="section-16.12-2">This registry includes the possible roles that nodes can take in an OSCORE group, each in combination with a numeric identifier. These numeric identifiers are used to express authorization information about joining OSCORE groups, as specified in <a href="#sec-format-scope" class="auto internal xref">Section 3</a> of [RFC-XXXX].<a href="#section-16.12-2" class="pilcrow">¶</a></p>
<p id="section-16.12-3">The columns of this registry are:<a href="#section-16.12-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.12-4.1">
            <p id="section-16.12-4.1.1">Name: A value that can be used in documents for easier comprehension, to identify a possible role that nodes can take in an OSCORE group.<a href="#section-16.12-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.12-4.2">
            <p id="section-16.12-4.2.1">Value: The numeric identifier for this role. Integer values greater than 65535 are marked as "Private Use", all other values use the registration policy "Expert Review" <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-16.12-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.12-4.3">
            <p id="section-16.12-4.3.1">Description: This field contains a brief description of the role.<a href="#section-16.12-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.12-4.4">
            <p id="section-16.12-4.4.1">Reference: This contains a pointer to the public specification for the role.<a href="#section-16.12-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.12-5">This registry will be initially populated by the values in <a href="#tab-role-values" class="auto internal xref">Table 1</a>. The Reference column for all of these entries will be [RFC-XXXX].<a href="#section-16.12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-iana-expert-review">
<section id="section-16.13">
        <h3 id="name-expert-review-instructions">
<a href="#section-16.13" class="section-number selfRef">16.13. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-16.13-1">The IANA registry established in this document is defined as "Expert Review".  This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-16.13-1" class="pilcrow">¶</a></p>
<p id="section-16.13-2">Expert reviewers should take into consideration the following points:<a href="#section-16.13-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.13-3.1">
            <p id="section-16.13-3.1.1">Clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Experts should inspect the entry for the considered role, to verify the correctness of its description against the role as intended in the specification that defined it. Experts should consider requesting an opinion on the correctness of registered parameters from the Authentication and Authorization for Constrained Environments (ACE) Working Group and the Constrained RESTful Environments (CoRE) Working Group.<a href="#section-16.13-3.1.1" class="pilcrow">¶</a></p>
<p id="section-16.13-3.1.2">
Entries that do not meet these objectives of clarity and completeness should not be registered.<a href="#section-16.13-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.13-3.2">
            <p id="section-16.13-3.2.1">Duplicated registration and point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments.<a href="#section-16.13-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.13-3.3">
            <p id="section-16.13-3.3.1">Experts should take into account the expected usage of roles when approving point assignments. Given a 'Value' V as code point, the length of the encoding of (2<sup>V+1</sup> - 1) should be weighed against the usage of the entry, considering the resources and capabilities of devices it will be used on. Additionally, given a 'Value' V as code point, the length of the encoding of (2<sup>V+1</sup> - 1) should be weighed against how many code points resulting in that encoding length are left, and the resources and capabilities of devices it will be used on.<a href="#section-16.13-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.13-3.4">
            <p id="section-16.13-3.4.1">Specifications are recommended. When specifications are not provided, the description provided needs to have sufficient information to verify the points above.<a href="#section-16.13-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-17">
      <h2 id="name-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-17.1">
        <h3 id="name-normative-references">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Elliptic.Curves">[COSE.Elliptic.Curves]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Elliptic Curves"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves">https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">https://www.iana.org/assignments/cose/cose.xhtml#key-type</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Group Object Security for Constrained RESTful Environments (Group OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-23</span>, <time datetime="2024-09-26" class="refDate">26 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-56A">[NIST-800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography - NIST Special Publication 800-56A, Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5705">https://www.rfc-editor.org/rfc/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6979">https://www.rfc-editor.org/rfc/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8447">https://www.rfc-editor.org/rfc/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9202">[RFC9202]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9202</span>, <span class="seriesInfo">DOI 10.17487/RFC9202</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9202">https://www.rfc-editor.org/rfc/rfc9202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9237">[RFC9237]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"An Authorization Information Format (AIF) for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9237</span>, <span class="seriesInfo">DOI 10.17487/RFC9237</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9237">https://www.rfc-editor.org/rfc/rfc9237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9277">https://www.rfc-editor.org/rfc/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9290">[RFC9290]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Problem Details for Constrained Application Protocol (CoAP) APIs"</span>, <span class="seriesInfo">RFC 9290</span>, <span class="seriesInfo">DOI 10.17487/RFC9290</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9290">https://www.rfc-editor.org/rfc/rfc9290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9430">[RFC9430]</dt>
        <dd>
<span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Extension of the Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE) to Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 9430</span>, <span class="seriesInfo">DOI 10.17487/RFC9430</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9430">https://www.rfc-editor.org/rfc/rfc9430</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9594">[RFC9594]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Provisioning for Group Communication Using Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9594</span>, <span class="seriesInfo">DOI 10.17487/RFC9594</span>, <time datetime="2024-09" class="refDate">September 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9594">https://www.rfc-editor.org/rfc/rfc9594</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-17.2">
        <h3 id="name-informative-references">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-oscore-gm-admin">[I-D.ietf-ace-oscore-gm-admin]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Van der Stok, P.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Admin Interface for the OSCORE Group Manager"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-gm-admin-12</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-gm-admin-12">https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-gm-admin-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Jimenez, J.</span>, <span class="refAuthor">Koster, M.</span>, and <span class="refAuthor">A. Keränen</span>, <span class="refTitle">"A publish-subscribe architecture for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-15</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-15">https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-12</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-12">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-11</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsüss, C.</span>, and <span class="refAuthor">P. Van der Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-16</span>, <time datetime="2024-09-04" class="refDate">4 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16">https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="profile-req">
<section id="appendix-A">
      <h2 id="name-profile-requirements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-A-1">This section lists how this application profile of ACE addresses the requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="mandatory-to-address-requirements">
<section id="appendix-A.1">
        <h3 id="name-mandatory-to-address-requir">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-mandatory-to-address-requir" class="section-name selfRef">Mandatory-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">
            <p id="appendix-A.1-1.1.1">REQ1: Specify the format and encoding of scope. This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format: see <a href="#sec-format-scope" class="auto internal xref">Section 3</a> and <a href="#ssec-auth-req" class="auto internal xref">Section 5.1</a>.<a href="#appendix-A.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.2">
            <p id="appendix-A.1-1.2.1">REQ2: If scope uses AIF, register its specific instance of "Toid" and "Tperm" as media type parameters and a corresponding Content-Format, as per the guidelines in <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>: see <a href="#ssec-iana-AIF-registry" class="auto internal xref">Section 16.8</a> and <a href="#ssec-iana-coap-content-format-registry" class="auto internal xref">Section 16.9</a>.<a href="#appendix-A.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.3">
            <p id="appendix-A.1-1.3.1">REQ3: If used, specify the acceptable values for the 'sign_alg' parameter: values from the "Value" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#appendix-A.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.4">
            <p id="appendix-A.1-1.4.1">REQ4: If used, specify the acceptable values and structure for the 'sign_parameters' parameter: values and structure from the COSE algorithm capabilities as specified in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#appendix-A.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.5">
            <p id="appendix-A.1-1.5.1">REQ5: If used, specify the acceptable values and structure for the 'sign_key_parameters' parameter: values and structure from the COSE key type capabilities as specified in the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#appendix-A.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.6">
            <p id="appendix-A.1-1.6.1">REQ6: Specify the acceptable formats for authentication credentials and, if applicable, the acceptable values for the 'cred_fmt' parameter: acceptable formats explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a> and <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>). Consistent acceptable values for 'cred_fmt' are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>, with some of those values also indicating the type of container to use for exchanging the authentication credentials with the Group Manager (e.g., a chain or bag of certificates).<a href="#appendix-A.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.7">
            <p id="appendix-A.1-1.7.1">REQ7: If the value of the GROUPNAME URI path and the group name in the access token scope ('gname') are not required to coincide, specify the mechanism to map the GROUPNAME value in the URI to the group name: not applicable, since a perfect matching is required.<a href="#appendix-A.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.8">
            <p id="appendix-A.1-1.8.1">REQ8: Define whether the KDC has an authentication credential as required for the correct group operation and if this has to be provided through the 'kdc_cred' parameter: yes, as required by the Group OSCORE protocol <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> of this document.<a href="#appendix-A.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.9">
            <p id="appendix-A.1-1.9.1">REQ9: Specify if any part of the KDC interface as defined in <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> is not supported by the KDC: not applicable.<a href="#appendix-A.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.10">
            <p id="appendix-A.1-1.10.1">REQ10: Register a Resource Type for the group-membership resources, which is used to discover the correct URL for sending a Join Request to the KDC: the Resource Type (rt=) Link Target Attribute value "core.osc.gm" is registered in <a href="#iana-rt" class="auto internal xref">Section 16.10</a>.<a href="#appendix-A.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.11">
            <p id="appendix-A.1-1.11.1">REQ11: Define what specific actions (e.g., CoAP methods) are allowed on each resource accessible through the KDC interface, depending on: whether the Client is a current group member; the roles that a Client is authorized to take as per the obtained access token; and the roles that the Client has as a current group member: see <a href="#ssec-admitted-methods" class="auto internal xref">Section 8.5</a>.<a href="#appendix-A.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.12">
            <p id="appendix-A.1-1.12.1">REQ12: Categorize possible newly defined operations for Clients into primary operations expected to be minimally supported and secondary operations, and provide accompanying considerations: see <a href="#client-operations" class="auto internal xref">Section 8.6</a>.<a href="#appendix-A.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.13">
            <p id="appendix-A.1-1.13.1">REQ13: Specify the encoding of group identifiers: CBOR byte string (see <a href="#sec-retrieve-gnames" class="auto internal xref">Section 9.10</a>).<a href="#appendix-A.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.14">
            <p id="appendix-A.1-1.14.1">REQ14: Specify the approaches used to compute and verify the PoP evidence to include in the 'client_cred_verify' parameter and which of those approaches is used in which case: see <a href="#ssec-join-req-sending" class="auto internal xref">Section 6.1</a> and <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>.<a href="#appendix-A.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.15">
            <p id="appendix-A.1-1.15.1">REQ15: Specify how the nonce N_S is generated, if the access token is not provided to the KDC through the Token Transfer Request sent to the /authz-info endpoint (e.g., the access token is instead transferred during the establishment of a secure communication association): see <a href="#sssec-challenge-value" class="auto internal xref">Section 6.1.1</a>.<a href="#appendix-A.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.16">
            <p id="appendix-A.1-1.16.1">REQ16: Define the initial value of the version number for the group keying material: the initial value <span class="bcp14">MUST</span> be set to 0 when creating the OSCORE group, e.g., as in <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="cite xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>.<a href="#appendix-A.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.17">
            <p id="appendix-A.1-1.17.1">REQ17: Specify the format of the group keying material that is conveyed in the 'key' parameter: see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>.<a href="#appendix-A.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.18">
            <p id="appendix-A.1-1.18.1">REQ18: Specify the acceptable values of the 'gkty' parameter. For each of them, register a corresponding entry in the "ACE Groupcomm Key Types" IANA registry if such an entry does not exist already: Group_OSCORE_Input_Material object (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>).<a href="#appendix-A.1-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.19">
            <p id="appendix-A.1-1.19.1">REQ19: Specify and register the application profile identifier: coap_group_oscore_app (see <a href="#ssec-iana-groupcomm-profile-registry" class="auto internal xref">Section 16.5</a>).<a href="#appendix-A.1-1.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.20">
            <p id="appendix-A.1-1.20.1">REQ20: If used, specify the format and default values of the entries of the CBOR map to include in the 'group_policies' parameter: see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>.<a href="#appendix-A.1-1.20.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.21">
            <p id="appendix-A.1-1.21.1">REQ21: Specify the approaches used to compute and verify the PoP evidence to include in the 'kdc_cred_verify' parameter and which of those approaches is used in which case. If external signature verifiers are supported, specify how those provide a nonce to the KDC to be used for computing the PoP evidence: see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>, <a href="#ssec-join-resp-processing" class="auto internal xref">Section 6.4</a> and <a href="#sec-gm-pub-key-signature-verifier" class="auto internal xref">Section 9.5.2</a>.<a href="#appendix-A.1-1.21.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.22">
            <p id="appendix-A.1-1.22.1">REQ22: Specify the communication protocol that members of the group use to communicate with each other (e.g., CoAP for group communication): CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, also for group communication <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>.<a href="#appendix-A.1-1.22.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.23">
            <p id="appendix-A.1-1.23.1">REQ23: Specify the security protocol that members of the group use to protect the group communication (e.g., Group OSCORE). This must provide encryption, integrity, and replay protection: Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-A.1-1.23.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.24">
            <p id="appendix-A.1-1.24.1">REQ24: Specify how the communication is secured between the Client and the KDC. Optionally, specify a transport profile of ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> to use between the Client and the KDC: by means of any transport profile of ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> between Client and Group Manager that complies with the requirements in <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#appendix-A.1-1.24.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.25">
            <p id="appendix-A.1-1.25.1">REQ25: Specify the format of the node identifiers of group members: the Sender ID used in the OSCORE group (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a> and <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>).<a href="#appendix-A.1-1.25.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.26">
            <p id="appendix-A.1-1.26.1">REQ26: Specify policies at the KDC to handle node identifiers that are included in the 'get_creds' parameter but are not associated with any current group member: see <a href="#sec-pub-keys" class="auto internal xref">Section 9.3</a>.<a href="#appendix-A.1-1.26.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.27">
            <p id="appendix-A.1-1.27.1">REQ27: Specify the format of (newly generated) individual keying material for group members or of the information to derive such keying material, as well as the corresponding CBOR map key that has to be registered in the "ACE Groupcomm Parameters" registry: see <a href="#sec-new-key" class="auto internal xref">Section 9.2</a>.<a href="#appendix-A.1-1.27.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.28">
            <p id="appendix-A.1-1.28.1">REQ28: Specify which CBOR tag is used for identifying the semantics of binary scopes, or register a new CBOR tag if a suitable one does not exist already: see <a href="#ssec-auth-resp" class="auto internal xref">Section 5.2</a>.<a href="#appendix-A.1-1.28.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.29">
            <p id="appendix-A.1-1.29.1">REQ29: Categorize newly defined parameters according to the same criteria of <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>: see <a href="#ace-groupcomm-params" class="auto internal xref">Section 12</a>.<a href="#appendix-A.1-1.29.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-1.30">
            <p id="appendix-A.1-1.30.1">REQ30: Define whether Clients must, should, or may support the conditional parameters defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-8" class="relref">Section 8</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> and under which circumstances: see <a href="#ace-groupcomm-params" class="auto internal xref">Section 12</a>.<a href="#appendix-A.1-1.30.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="optional-to-address-requirements">
<section id="appendix-A.2">
        <h3 id="name-optional-to-address-require">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-optional-to-address-require" class="section-name selfRef">Optional-to-Address Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">
            <p id="appendix-A.2-1.1.1">OPT1: Optionally, if the textual format of scope is used, specify CBOR values to use for abbreviating the role identifiers in the group: not applicable.<a href="#appendix-A.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.2">
            <p id="appendix-A.2-1.2.1">OPT2: Optionally, specify the additional parameters used in the exchange of Token Transfer Request and Response:<a href="#appendix-A.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.2.2.1">
                <p id="appendix-A.2-1.2.2.1.1">'ecdh_info', to negotiate the ECDH algorithm, ECDH algorithm parameters, ECDH key parameters, and exact format of authentication credentials used in the group, in case the joining node supports the pairwise mode of Group OSCORE (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>).<a href="#appendix-A.2-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-A.2-1.2.2.2">
                <p id="appendix-A.2-1.2.2.2.1">'kdc_dh_creds', to ask for and retrieve the Group Manager's Diffie-Hellman authentication credentials, in case the joining node supports the pairwise mode of Group OSCORE and the access token authorizes to join pairwise-only groups (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a>).<a href="#appendix-A.2-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-A.2-1.3">
            <p id="appendix-A.2-1.3.1">OPT3: Optionally, specify the negotiation of parameter values for signature algorithm and signature keys, if the 'sign_info' parameter is not used: possible early discovery by using the approach based on the CoRE Resource Directory described in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#appendix-A.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.4">
            <p id="appendix-A.2-1.4.1">OPT4: Optionally, specify possible or required payload formats for specific error cases: send a 4.00 (Bad Request) error response to a Join Request (see <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>).<a href="#appendix-A.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.5">
            <p id="appendix-A.2-1.5.1">OPT5: Optionally, specify additional identifiers of error types as values of the 'error-id' field within the Custom Problem Detail entry 'ace-groupcomm-error': see <a href="#iana-ace-groupcomm-errors" class="auto internal xref">Section 16.11</a>.<a href="#appendix-A.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.6">
            <p id="appendix-A.2-1.6.1">OPT6: Optionally, specify the encoding of the 'creds_repo' parameter if the default one is not used: no.<a href="#appendix-A.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.7">
            <p id="appendix-A.2-1.7.1">OPT7: Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_uri' parameter, including the encoding of exchanged messages and other details: see <a href="#sec-leaving" class="auto internal xref">Section 10</a> for the eviction of a group member; see <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a> for the group rekeying process.<a href="#appendix-A.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.8">
            <p id="appendix-A.2-1.8.1">OPT8: Optionally, specify the behavior of the POST handler of group-membership resources, for the case when it fails to retrieve an authentication credential for the specific Client: send a 4.00 (Bad Request) error response to a Join Request (see <a href="#ssec-join-req-processing" class="auto internal xref">Section 6.2</a>).<a href="#appendix-A.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.9">
            <p id="appendix-A.2-1.9.1">OPT9: Optionally, define a default group rekeying scheme to refer to in case the 'rekeying_scheme' parameter is not included in the Join Response: the "Point-to-Point" rekeying scheme registered in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-11.13" class="relref">Section 11.13</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>, whose detailed use for this profile is defined in <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a> of this document.<a href="#appendix-A.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.10">
            <p id="appendix-A.2-1.10.1">OPT10: Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_group_uri' parameter, including the encoding of exchanged messages and other details: see <a href="#sec-leaving" class="auto internal xref">Section 10</a> for the eviction of multiple group members.<a href="#appendix-A.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.11">
            <p id="appendix-A.2-1.11.1">OPT11: Optionally, specify policies that instruct Clients to retain messages and for how long, if those are unsuccessfully decrypted: no.<a href="#appendix-A.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.12">
            <p id="appendix-A.2-1.12.1">OPT12: Optionally, specify for the KDC to perform a group rekeying when receiving a Key Renewal Request, together with or instead of renewing individual keying material: the Group Manager <span class="bcp14">SHOULD NOT</span> perform a group rekeying, unless already scheduled to occur shortly (see <a href="#sec-new-key" class="auto internal xref">Section 9.2</a>).<a href="#appendix-A.2-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.13">
            <p id="appendix-A.2-1.13.1">OPT13: Optionally, specify how the identifier of a group member's authentication credential is included in requests sent to other group members: no.<a href="#appendix-A.2-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.14">
            <p id="appendix-A.2-1.14.1">OPT14: Optionally, specify additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-6" class="relref">Section 6</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>): see <a href="#sending-rekeying-msg" class="auto internal xref">Section 11.1</a>.<a href="#appendix-A.2-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-future-cose-algs">
<section id="appendix-B">
      <h2 id="name-extensibility-for-future-co">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-extensibility-for-future-co" class="section-name selfRef">Extensibility for Future COSE Algorithms</a>
      </h2>
<p id="appendix-B-1">As defined in <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, future algorithms can be registered in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> as specifying none or multiple COSE capabilities.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">To enable the seamless use of such future registered algorithms, this section defines a general, agile format for:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1">Each 'ecdh_info_entry' of the 'ecdh_info' parameter in the Token Transfer Response; see <a href="#ecdh-info" class="auto internal xref">Section 5.3.1</a>).<a href="#appendix-B-3.1.1" class="pilcrow">¶</a></p>
<p id="appendix-B-3.1.2"><span><a href="https://rfc-editor.org/rfc/rfc9594#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span> describes the analogous general format for each 'sign_info_entry' of the 'sign_info' parameter in the Token Transfer Response (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a> of this document).<a href="#appendix-B-3.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1">The 'sign_params' and 'ecdh_params' parameters within the 'key' parameter (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>), as part of the response payloads used in <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>, <a href="#ssec-updated-key-only" class="auto internal xref">Section 9.1.1</a>, <a href="#ssec-updated-and-individual-key" class="auto internal xref">Section 9.1.2</a>, and <a href="#sec-group-rekeying-process" class="auto internal xref">Section 11</a>.<a href="#appendix-B-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">If any of the currently registered COSE algorithms is considered, using this general format yields the same structure defined in this document for the items above, thus ensuring backward compatibility.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div id="sec-future-cose-algs-ecdh-info-entry">
<section id="appendix-B.1">
        <h3 id="name-format-of-ecdh_info_entry">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-format-of-ecdh_info_entry" class="section-name selfRef">Format of 'ecdh_info_entry'</a>
        </h3>
<p id="appendix-B.1-1">The format of each 'ecdh_info_entry' (see <a href="#ssec-token-post" class="auto internal xref">Section 5.3</a> and <a href="#ecdh-info" class="auto internal xref">Section 5.3.1</a>) is generalized as follows.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">
            <p id="appendix-B.1-2.1.1">'ecdh_parameters' includes N &gt;= 0 elements, each of which is a COSE capability of the ECDH algorithm indicated in 'ecdh_alg'.<a href="#appendix-B.1-2.1.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.1.2">
In particular, 'ecdh_parameters' has the same format and value of the COSE capabilities array for the ECDH algorithm indicated in 'ecdh_alg', as specified for that algorithm in the 'Capabilities' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#appendix-B.1-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.2">
            <p id="appendix-B.1-2.2.1">'ecdh_key_parameters' is replaced by N elements 'ecdh_capab', each of which is a CBOR array.<a href="#appendix-B.1-2.2.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.2">
The i-th 'ecdh_capab' array (i = 0, ..., N-1) is the array of COSE capabilities for the algorithm capability specified in 'ecdh_parameters'[i].<a href="#appendix-B.1-2.2.2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.3">
In particular, each 'ecdh_capab' array has the same format and value of the COSE capabilities array for the algorithm capability specified in 'ecdh_parameters'[i].<a href="#appendix-B.1-2.2.3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.4">
Such a COSE capabilities array is currently defined for the algorithm capability COSE key type, in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#appendix-B.1-2.2.4" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.1-3">The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the 'ecdh_info_entry' parameter is given below.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<span id="name-ecdh_info_entry-with-genera"></span><div id="fig-ecdh-info-entry-general">
<figure id="figure-11">
          <div class="lang-CDDL sourcecode" id="appendix-B.1-4.1">
<pre>
ecdh_info_entry =
[
    id: gname / [+ gname],
    ecdh_alg: int / tstr,
    ecdh_parameters : [* ecdh_capab: any],
  * ecdh_capab: [* capab: any],
    cred_fmt: int / null
]

gname = tstr
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-ecdh_info_entry-with-genera" class="selfRef">'ecdh_info_entry' with general format</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-future-cose-algs-key">
<section id="appendix-B.2">
        <h3 id="name-format-of-key">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-format-of-key" class="section-name selfRef">Format of 'key'</a>
        </h3>
<p id="appendix-B.2-1">The format of 'key' (see <a href="#ssec-join-resp" class="auto internal xref">Section 6.3</a>) is generalized as follows.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">The 'sign_params' array includes N+1 elements, whose exact structure and value depend on the value of the signature algorithm specified in 'sign_alg'.<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1.2.1">
                <p id="appendix-B.2-2.1.2.1.1">The first element, i.e., 'sign_params'[0], is the array of the N COSE capabilities for the signature algorithm, as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> (see <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>).<a href="#appendix-B.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-2.1.2.2">
                <p id="appendix-B.2-2.1.2.2.1">Each following element 'sign_params'[i], i.e., with index i &gt; 0, is the array of COSE capabilities for the algorithm capability specified in 'sign_params'[0][i-1].<a href="#appendix-B.2-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-B.2-2.1.3">
For example, if 'sign_params'[0][0] specifies the key type as capability of the algorithm, then 'sign_params'[1] is the array of COSE capabilities for the COSE key type associated with the signature algorithm, as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span> (see <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>).<a href="#appendix-B.2-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">The 'ecdh_params' array includes M+1 elements, whose exact structure and value depend on the value of the ECDH algorithm specified in 'ecdh_alg'.<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.2.2.1">
                <p id="appendix-B.2-2.2.2.1.1">The first element, i.e., 'ecdh_params'[0], is the array of the M COSE capabilities for the ECDH algorithm, as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> (see <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>).<a href="#appendix-B.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-2.2.2.2">
                <p id="appendix-B.2-2.2.2.2.1">Each following element 'ecdh_params'[i], i.e., with index i &gt; 0, is the array of COSE capabilities for the algorithm capability specified in 'ecdh_params'[0][i-1].<a href="#appendix-B.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-B.2-2.2.3">
For example, if 'ecdh_params'[0][0] specifies the key type as capability of the algorithm, then 'ecdh_params'[1] is the array of COSE capabilities for the COSE key type associated with the ECDH algorithm, as specified for that key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span> (see <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>).<a href="#appendix-B.2-2.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-cddl-model">
<section id="appendix-C">
      <h2 id="name-cddl-model">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-cddl-model" class="section-name selfRef">CDDL Model</a>
      </h2>
<p id="appendix-C-1">This section is to be removed before publishing as an RFC.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<span id="name-cddl-model-2"></span><div id="fig-cddl-model">
<figure id="figure-12">
        <div class="alignLeft art-CDDL art-text artwork" id="appendix-C-2.1">
<pre>
; ACE Groupcomm Parameters
sign_enc_key = 21

; ACE Groupcomm Key Types
group_oscore_input_material_obj = 1

; ACE Groupcomm Profiles
coap_group_oscore_app = 1

; OSCORE Security Context Parameters
cred_fmt = 8
gp_enc_alg = 9
sign_alg = 10
sign_params = 11
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-cddl-model-2" class="selfRef">CDDL model</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-D">
      <h2 id="name-document-updates">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-D-1">This section is to be removed before publishing as an RFC.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="sec-16-17">
<section id="appendix-D.1">
        <h3 id="name-version-16-to-17">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-version-16-to-17" class="section-name selfRef">Version -16 to -17</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.1">
            <p id="appendix-D.1-1.1.1">CBOR diagnostic notation uses placeholders from a CDDL model.<a href="#appendix-D.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.2">
            <p id="appendix-D.1-1.2.1">Fixes in the CDDL definitions.<a href="#appendix-D.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.3">
            <p id="appendix-D.1-1.3.1">Fixes in the examples in CBOR diagnostic notation.<a href="#appendix-D.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.4">
            <p id="appendix-D.1-1.4.1">Updated author list.<a href="#appendix-D.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.5">
            <p id="appendix-D.1-1.5.1">Updated references and section numbers of referred documents.<a href="#appendix-D.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.6">
            <p id="appendix-D.1-1.6.1">Use actual tables.<a href="#appendix-D.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.7">
            <p id="appendix-D.1-1.7.1">Add high-level recap of the concept of scope.<a href="#appendix-D.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.8">
            <p id="appendix-D.1-1.8.1">Fixed name of the error with error code 4.<a href="#appendix-D.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.9">
            <p id="appendix-D.1-1.9.1">Renamed parameters to align with RFC 9594<a href="#appendix-D.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.9.2.1">
                <p id="appendix-D.1-1.9.2.1.1">"Group Encryption Key" becomes "Signature Encryption Key"<a href="#appendix-D.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-D.1-1.9.2.2">
                <p id="appendix-D.1-1.9.2.2.1">'group_enc_key' becomes 'sign_enc_key'<a href="#appendix-D.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-D.1-1.9.2.3">
                <p id="appendix-D.1-1.9.2.3.1">"Signature Encryption Algorithm" becomes "Group Encryption Algorithm"<a href="#appendix-D.1-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-D.1-1.9.2.4">
                <p id="appendix-D.1-1.9.2.4.1">'sign_enc_alg' becomes 'gp_enc_alg'<a href="#appendix-D.1-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-D.1-1.10">
            <p id="appendix-D.1-1.10.1">Added CBOR integer abbreviations for ACE Groupcomm Parameters.<a href="#appendix-D.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.11">
            <p id="appendix-D.1-1.11.1">Considerations on authentication credentials consistent with RFC 9594.<a href="#appendix-D.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.12">
            <p id="appendix-D.1-1.12.1">Revised alternative computing of N_S challenge when DTLS is used.<a href="#appendix-D.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.13">
            <p id="appendix-D.1-1.13.1">Generalized definition of ecdh_info.<a href="#appendix-D.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.14">
            <p id="appendix-D.1-1.14.1">Generalized definition of kdc_dh_creds.<a href="#appendix-D.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.15">
            <p id="appendix-D.1-1.15.1">Clarified maximum size of the OSCORE Sender ID.<a href="#appendix-D.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.16">
            <p id="appendix-D.1-1.16.1">Clarified parameters left "not set" in the Security Context.<a href="#appendix-D.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.17">
            <p id="appendix-D.1-1.17.1">Clarified meaning of 'cred_fmt'.<a href="#appendix-D.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.18">
            <p id="appendix-D.1-1.18.1">Consistent mandatory use of 'cnonce'.<a href="#appendix-D.1-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.19">
            <p id="appendix-D.1-1.19.1">Relation between 'cred_fmt' and Authentication Credential Format.<a href="#appendix-D.1-1.19.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.20">
            <p id="appendix-D.1-1.20.1">Implicit PoP evidence of the Client's authentication credential.<a href="#appendix-D.1-1.20.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.21">
            <p id="appendix-D.1-1.21.1">Process of 'client_cred' and 'client_cred_verify' consistent with RFC 9594.<a href="#appendix-D.1-1.21.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.22">
            <p id="appendix-D.1-1.22.1">GET to ace-group/GROUPNAME/kdc-cred only for group members.<a href="#appendix-D.1-1.22.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.23">
            <p id="appendix-D.1-1.23.1">Added FETCH handler for /ace-group/GROUPNAME/kdc-cred.<a href="#appendix-D.1-1.23.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.24">
            <p id="appendix-D.1-1.24.1">PUT becomes POST for ace-group/GROUPNAME/nodes/NODENAME.<a href="#appendix-D.1-1.24.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.25">
            <p id="appendix-D.1-1.25.1">Fixed error response code from /ace-group/GROUPNAME/nodes/NODENAME.<a href="#appendix-D.1-1.25.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.26">
            <p id="appendix-D.1-1.26.1">Consistent use of the 'exi' ACE Groupcomm Parameter.<a href="#appendix-D.1-1.26.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.27">
            <p id="appendix-D.1-1.27.1">Use concise problem details (RFC9290) for error responses.<a href="#appendix-D.1-1.27.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.28">
            <p id="appendix-D.1-1.28.1">Revised default values on group configuration parameters.<a href="#appendix-D.1-1.28.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.29">
            <p id="appendix-D.1-1.29.1">Revised future-ready generalization of 'ecdh_info_entry'.<a href="#appendix-D.1-1.29.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.30">
            <p id="appendix-D.1-1.30.1">CCS is used as default format of authentication credential.<a href="#appendix-D.1-1.30.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.31">
            <p id="appendix-D.1-1.31.1">Updated name of TLS exporter label.<a href="#appendix-D.1-1.31.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.32">
            <p id="appendix-D.1-1.32.1">Revised IANA considerations.<a href="#appendix-D.1-1.32.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.33">
            <p id="appendix-D.1-1.33.1">Aligned requirement formulation with that in RFC 9594.<a href="#appendix-D.1-1.33.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.34">
            <p id="appendix-D.1-1.34.1">Use of AASVG in message diagrams.<a href="#appendix-D.1-1.34.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.35">
            <p id="appendix-D.1-1.35.1">Clarifications and editorial fixes.<a href="#appendix-D.1-1.35.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-15-16">
<section id="appendix-D.2">
        <h3 id="name-version-15-to-16">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-version-15-to-16" class="section-name selfRef">Version -15 to -16</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.1">
            <p id="appendix-D.2-1.1.1">Early mentioning of invalid combinations of roles.<a href="#appendix-D.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.2">
            <p id="appendix-D.2-1.2.1">Revised presentation of handling of stale Sender IDs.<a href="#appendix-D.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.3">
            <p id="appendix-D.2-1.3.1">Fixed CDDL notation.<a href="#appendix-D.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.4">
            <p id="appendix-D.2-1.4.1">Fixed diagnostic notation in examples.<a href="#appendix-D.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.5">
            <p id="appendix-D.2-1.5.1">Possible reason to deviate from default parameter values.<a href="#appendix-D.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.6">
            <p id="appendix-D.2-1.6.1">Clarifications and editorial fixes.<a href="#appendix-D.2-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-14-15">
<section id="appendix-D.3">
        <h3 id="name-version-14-to-15">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-version-14-to-15" class="section-name selfRef">Version -14 to -15</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.3-1.1">
            <p id="appendix-D.3-1.1.1">Alignment with renaming in draft-ietf-ace-key-groupcomm.<a href="#appendix-D.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.2">
            <p id="appendix-D.3-1.2.1">Updated signaling of semantics for binary encoded scopes.<a href="#appendix-D.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.3">
            <p id="appendix-D.3-1.3.1">Considered the upload of access tokens in the DTLS 1.3 Handshake.<a href="#appendix-D.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.4">
            <p id="appendix-D.3-1.4.1">Fixes in IANA registrations.<a href="#appendix-D.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.5">
            <p id="appendix-D.3-1.5.1">Editorial fixes.<a href="#appendix-D.3-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-13-14">
<section id="appendix-D.4">
        <h3 id="name-version-13-to-14">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-version-13-to-14" class="section-name selfRef">Version -13 to -14</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.4-1.1">
            <p id="appendix-D.4-1.1.1">Major reordering of the document sections.<a href="#appendix-D.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.2">
            <p id="appendix-D.4-1.2.1">The HKDF Algorithm is specified by the HMAC Algorithm.<a href="#appendix-D.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.3">
            <p id="appendix-D.4-1.3.1">Group communication does not necessarily use IP multicast.<a href="#appendix-D.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.4">
            <p id="appendix-D.4-1.4.1">Generalized AIF data model, also for draft-ace-oscore-gm-admin.<a href="#appendix-D.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.5">
            <p id="appendix-D.4-1.5.1">Clarifications and editorial improvements.<a href="#appendix-D.4-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-12-13">
<section id="appendix-D.5">
        <h3 id="name-version-12-to-13">
<a href="#appendix-D.5" class="section-number selfRef">D.5. </a><a href="#name-version-12-to-13" class="section-name selfRef">Version -12 to -13</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.5-1.1">
            <p id="appendix-D.5-1.1.1">Renamed parameters about authentication credentials.<a href="#appendix-D.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.2">
            <p id="appendix-D.5-1.2.1">It is optional for the Group Manager to reassign Gids by tracking "Birth Gids".<a href="#appendix-D.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.3">
            <p id="appendix-D.5-1.3.1">Distinction between authentication credentials and public keys.<a href="#appendix-D.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.4">
            <p id="appendix-D.5-1.4.1">Updated IANA considerations related to AIF.<a href="#appendix-D.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.5">
            <p id="appendix-D.5-1.5.1">Updated textual description of registered ACE Scope Semantics value.<a href="#appendix-D.5-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-11-12">
<section id="appendix-D.6">
        <h3 id="name-version-11-to-12">
<a href="#appendix-D.6" class="section-number selfRef">D.6. </a><a href="#name-version-11-to-12" class="section-name selfRef">Version -11 to -12</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.6-1.1">
            <p id="appendix-D.6-1.1.1">Clarified semantics of 'ecdh_info' and 'kdc_dh_creds'.<a href="#appendix-D.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.2">
            <p id="appendix-D.6-1.2.1">Definition of /ace-group/GROUPNAME/kdc-pub-key moved to draft-ietf-ace-key-groupcomm.<a href="#appendix-D.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.3">
            <p id="appendix-D.6-1.3.1">/ace-group accessible also to non-members that are not Verifiers.<a href="#appendix-D.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.4">
            <p id="appendix-D.6-1.4.1">Clarified what resources are accessible to Verifiers.<a href="#appendix-D.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.5">
            <p id="appendix-D.6-1.5.1">Revised error handling for the newly defined resources.<a href="#appendix-D.6-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.6">
            <p id="appendix-D.6-1.6.1">Revised use of CoAP error codes.<a href="#appendix-D.6-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.7">
            <p id="appendix-D.6-1.7.1">Use of "Token Transfer Request" and "Token Transfer Response".<a href="#appendix-D.6-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.8">
            <p id="appendix-D.6-1.8.1">New parameter 'rekeying_scheme'.<a href="#appendix-D.6-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.9">
            <p id="appendix-D.6-1.9.1">Categorization of new parameters and inherited conditional parameters.<a href="#appendix-D.6-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.10">
            <p id="appendix-D.6-1.10.1">Clarifications on what to do in case of enhanced error responses.<a href="#appendix-D.6-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.11">
            <p id="appendix-D.6-1.11.1">Changed UCCS to CCS.<a href="#appendix-D.6-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.12">
            <p id="appendix-D.6-1.12.1">Authentication credentials of just joined Clients can be in rekeying messages.<a href="#appendix-D.6-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.13">
            <p id="appendix-D.6-1.13.1">Revised names of new IANA registries.<a href="#appendix-D.6-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.14">
            <p id="appendix-D.6-1.14.1">Clarified meaning of registered CoRE resource type.<a href="#appendix-D.6-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.15">
            <p id="appendix-D.6-1.15.1">Alignment to new requirements from draft-ietf-ace-key-groupcomm.<a href="#appendix-D.6-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.16">
            <p id="appendix-D.6-1.16.1">Fixes and editorial improvements.<a href="#appendix-D.6-1.16.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-10-11">
<section id="appendix-D.7">
        <h3 id="name-version-10-to-11">
<a href="#appendix-D.7" class="section-number selfRef">D.7. </a><a href="#name-version-10-to-11" class="section-name selfRef">Version -10 to -11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.7-1.1">
            <p id="appendix-D.7-1.1.1">Removed redundancy of key type capabilities, from 'sign_info', 'ecdh_info' and 'key'.<a href="#appendix-D.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.2">
            <p id="appendix-D.7-1.2.1">New resource to retrieve the Group Manager's authentication credential.<a href="#appendix-D.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.3">
            <p id="appendix-D.7-1.3.1">New resource to retrieve material for Signature Verifiers.<a href="#appendix-D.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.4">
            <p id="appendix-D.7-1.4.1">New parameter 'gp_enc_alg' related to the group mode.<a href="#appendix-D.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.5">
            <p id="appendix-D.7-1.5.1">'cred_fmt' takes value from the COSE Header Parameters registry.<a href="#appendix-D.7-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.6">
            <p id="appendix-D.7-1.6.1">Improved alignment of the Join Response payload with the Group OSCORE Security Context parameters.<a href="#appendix-D.7-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.7">
            <p id="appendix-D.7-1.7.1">Recycling Group IDs by tracking "Birth GIDs".<a href="#appendix-D.7-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.8">
            <p id="appendix-D.7-1.8.1">Error handling in case of non available Sender IDs upon joining.<a href="#appendix-D.7-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.9">
            <p id="appendix-D.7-1.9.1">Error handling in case EdDSA public keys with invalid Y coordinate when the pairwise mode of Group OSCORE is supported.<a href="#appendix-D.7-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.10">
            <p id="appendix-D.7-1.10.1">Generalized proof-of-possession (PoP) for the joining node's private key; defined Diffie-Hellman based PoP for OSCORE groups using only the pairwise mode.<a href="#appendix-D.7-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.11">
            <p id="appendix-D.7-1.11.1">Proof-of-possession of the Group Manager's private key in the Join Response.<a href="#appendix-D.7-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.12">
            <p id="appendix-D.7-1.12.1">Always use 'peer_identifiers' to convey Sender IDs as node identifiers.<a href="#appendix-D.7-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.13">
            <p id="appendix-D.7-1.13.1">Stale Sender IDs provided when rekeying the group.<a href="#appendix-D.7-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.14">
            <p id="appendix-D.7-1.14.1">New resource for late retrieval of stale Sender IDs.<a href="#appendix-D.7-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.15">
            <p id="appendix-D.7-1.15.1">Added examples of message exchanges.<a href="#appendix-D.7-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.16">
            <p id="appendix-D.7-1.16.1">Revised default values of group configuration parameters.<a href="#appendix-D.7-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.17">
            <p id="appendix-D.7-1.17.1">Fixes to IANA registrations.<a href="#appendix-D.7-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.18">
            <p id="appendix-D.7-1.18.1">General format of parameters related to COSE capabilities, supporting future registered COSE algorithms (new Appendix).<a href="#appendix-D.7-1.18.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-09-10">
<section id="appendix-D.8">
        <h3 id="name-version-09-to-10">
<a href="#appendix-D.8" class="section-number selfRef">D.8. </a><a href="#name-version-09-to-10" class="section-name selfRef">Version -09 to -10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.8-1.1">
            <p id="appendix-D.8-1.1.1">Updated non-recycling policy of Sender IDs.<a href="#appendix-D.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.2">
            <p id="appendix-D.8-1.2.1">Removed policies about Sender Sequence Number synchronization.<a href="#appendix-D.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.3">
            <p id="appendix-D.8-1.3.1">'control_path' renamed to 'control_uri'.<a href="#appendix-D.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.4">
            <p id="appendix-D.8-1.4.1">Format of 'get_pub_keys' aligned with draft-ietf-ace-key-groupcomm.<a href="#appendix-D.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.5">
            <p id="appendix-D.8-1.5.1">Additional way to inform of group eviction.<a href="#appendix-D.8-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.6">
            <p id="appendix-D.8-1.6.1">Registered semantics identifier for extended scope format.<a href="#appendix-D.8-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.7">
            <p id="appendix-D.8-1.7.1">Extended error handling, with error type specified in some error responses.<a href="#appendix-D.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.8">
            <p id="appendix-D.8-1.8.1">Renumbered requirements.<a href="#appendix-D.8-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-08-09">
<section id="appendix-D.9">
        <h3 id="name-version-08-to-09">
<a href="#appendix-D.9" class="section-number selfRef">D.9. </a><a href="#name-version-08-to-09" class="section-name selfRef">Version -08 to -09</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.9-1.1">
            <p id="appendix-D.9-1.1.1">The url-path "ace-group" is used.<a href="#appendix-D.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.2">
            <p id="appendix-D.9-1.2.1">Added overview of admitted methods on the Group Manager resources.<a href="#appendix-D.9-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.3">
            <p id="appendix-D.9-1.3.1">Added exchange of parameters relevant for the pairwise mode of Group OSCORE.<a href="#appendix-D.9-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.4">
            <p id="appendix-D.9-1.4.1">The signed value for 'client_cred_verify' includes also the scope.<a href="#appendix-D.9-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.5">
            <p id="appendix-D.9-1.5.1">Renamed the key material object as Group_OSCORE_Input_Material object.<a href="#appendix-D.9-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.6">
            <p id="appendix-D.9-1.6.1">Replaced 'clientId' with 'group_SenderId'.<a href="#appendix-D.9-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.7">
            <p id="appendix-D.9-1.7.1">Added message exchange for Group Names request-response.<a href="#appendix-D.9-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.8">
            <p id="appendix-D.9-1.8.1">No reassignment of Sender ID and Gid in the same OSCORE group.<a href="#appendix-D.9-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.9">
            <p id="appendix-D.9-1.9.1">Updates on group rekeying contextual with request of new Sender ID.<a href="#appendix-D.9-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.10">
            <p id="appendix-D.9-1.10.1">Signature verifiers can also retrieve Group Names and URIs.<a href="#appendix-D.9-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.11">
            <p id="appendix-D.9-1.11.1">Removed group policy about supporting Group OSCORE in pairwise mode.<a href="#appendix-D.9-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.12">
            <p id="appendix-D.9-1.12.1">Registration of the resource type rt="core.osc.gm".<a href="#appendix-D.9-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.13">
            <p id="appendix-D.9-1.13.1">Update list of requirements.<a href="#appendix-D.9-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.9-1.14">
            <p id="appendix-D.9-1.14.1">Clarifications and editorial revision.<a href="#appendix-D.9-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-07-08">
<section id="appendix-D.10">
        <h3 id="name-version-07-to-08">
<a href="#appendix-D.10" class="section-number selfRef">D.10. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.10-1.1">
            <p id="appendix-D.10-1.1.1">AIF data model to express scope entries.<a href="#appendix-D.10-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.2">
            <p id="appendix-D.10-1.2.1">A set of roles is checked as valid when processing the Join Request.<a href="#appendix-D.10-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.3">
            <p id="appendix-D.10-1.3.1">Updated format of 'get_pub_keys' in the Join Request.<a href="#appendix-D.10-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.4">
            <p id="appendix-D.10-1.4.1">Payload format and default values of group policies in the Join Response.<a href="#appendix-D.10-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.5">
            <p id="appendix-D.10-1.5.1">Updated payload format of the FETCH request to retrieve authentication credentials.<a href="#appendix-D.10-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.6">
            <p id="appendix-D.10-1.6.1">Default values for group configuration parameters.<a href="#appendix-D.10-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.10-1.7">
            <p id="appendix-D.10-1.7.1">IANA registrations to support the AIF data model.<a href="#appendix-D.10-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-D.11">
        <h3 id="name-version-06-to-07">
<a href="#appendix-D.11" class="section-number selfRef">D.11. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.11-1.1">
            <p id="appendix-D.11-1.1.1">Alignments with draft-ietf-core-oscore-groupcomm.<a href="#appendix-D.11-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.11-1.2">
            <p id="appendix-D.11-1.2.1">New format of 'sign_info', using the COSE capabilities.<a href="#appendix-D.11-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.11-1.3">
            <p id="appendix-D.11-1.3.1">New format of Join Response parameters, using the COSE capabilities.<a href="#appendix-D.11-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.11-1.4">
            <p id="appendix-D.11-1.4.1">Considerations on group rekeying.<a href="#appendix-D.11-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.11-1.5">
            <p id="appendix-D.11-1.5.1">Editorial revision.<a href="#appendix-D.11-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-D.12">
        <h3 id="name-version-05-to-06">
<a href="#appendix-D.12" class="section-number selfRef">D.12. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.12-1.1">
            <p id="appendix-D.12-1.1.1">Added role of external signature verifier.<a href="#appendix-D.12-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.2">
            <p id="appendix-D.12-1.2.1">Parameter 'rsnonce' renamed to 'kdcchallenge'.<a href="#appendix-D.12-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.3">
            <p id="appendix-D.12-1.3.1">Parameter 'kdcchallenge' may be omitted in some cases.<a href="#appendix-D.12-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.4">
            <p id="appendix-D.12-1.4.1">Clarified difference between group name and OSCORE Gid.<a href="#appendix-D.12-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.5">
            <p id="appendix-D.12-1.5.1">Removed the role combination ["requester", "monitor"].<a href="#appendix-D.12-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.6">
            <p id="appendix-D.12-1.6.1">Admit implicit scope and audience in the Authorization Request.<a href="#appendix-D.12-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.7">
            <p id="appendix-D.12-1.7.1">New format for the 'sign_info' parameter.<a href="#appendix-D.12-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.8">
            <p id="appendix-D.12-1.8.1">Scope not mandatory to include in the Join Request.<a href="#appendix-D.12-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.9">
            <p id="appendix-D.12-1.9.1">Group policy about supporting Group OSCORE in pairwise mode.<a href="#appendix-D.12-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.10">
            <p id="appendix-D.12-1.10.1">Possible individual rekeying of a single requesting node combined with a group rekeying.<a href="#appendix-D.12-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.11">
            <p id="appendix-D.12-1.11.1">Security considerations on reusage of signature challenges.<a href="#appendix-D.12-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.12">
            <p id="appendix-D.12-1.12.1">Addressing optional requirement OPT12 from draft-ietf-ace-key-groupcomm<a href="#appendix-D.12-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.12-1.13">
            <p id="appendix-D.12-1.13.1">Editorial improvements.<a href="#appendix-D.12-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-D.13">
        <h3 id="name-version-04-to-05">
<a href="#appendix-D.13" class="section-number selfRef">D.13. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.13-1.1">
            <p id="appendix-D.13-1.1.1">Nonce N_S also in error responses to the Join Requests.<a href="#appendix-D.13-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.2">
            <p id="appendix-D.13-1.2.1">Supporting single access token for multiple groups/topics.<a href="#appendix-D.13-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.3">
            <p id="appendix-D.13-1.3.1">Supporting legal requesters/responders using the 'peer_roles' parameter.<a href="#appendix-D.13-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.4">
            <p id="appendix-D.13-1.4.1">Registered and used dedicated label for TLS Exporter.<a href="#appendix-D.13-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.5">
            <p id="appendix-D.13-1.5.1">Added method for uploading a new authentication credential to the Group Manager.<a href="#appendix-D.13-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.6">
            <p id="appendix-D.13-1.6.1">Added resource and method for retrieving the current group status.<a href="#appendix-D.13-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.7">
            <p id="appendix-D.13-1.7.1">Fixed inconsistency in retrieving group keying material only.<a href="#appendix-D.13-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.8">
            <p id="appendix-D.13-1.8.1">Clarified retrieval of keying material for monitor-only members.<a href="#appendix-D.13-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.9">
            <p id="appendix-D.13-1.9.1">Clarification on incrementing version number when rekeying the group.<a href="#appendix-D.13-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.10">
            <p id="appendix-D.13-1.10.1">Clarification on what is re-distributed with the group rekeying.<a href="#appendix-D.13-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.11">
            <p id="appendix-D.13-1.11.1">Security considerations on the size of the nonces used for the signature challenge.<a href="#appendix-D.13-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.13-1.12">
            <p id="appendix-D.13-1.12.1">Added CBOR values to abbreviate role identifiers in the group.<a href="#appendix-D.13-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-D.14">
        <h3 id="name-version-03-to-04">
<a href="#appendix-D.14" class="section-number selfRef">D.14. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.14-1.1">
            <p id="appendix-D.14-1.1.1">New abstract.<a href="#appendix-D.14-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.2">
            <p id="appendix-D.14-1.2.1">Moved general content to draft-ietf-ace-key-groupcomm<a href="#appendix-D.14-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.3">
            <p id="appendix-D.14-1.3.1">Terminology: node name; node resource.<a href="#appendix-D.14-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.4">
            <p id="appendix-D.14-1.4.1">Creation and pointing at node resource.<a href="#appendix-D.14-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.5">
            <p id="appendix-D.14-1.5.1">Updated Group Manager API (REST methods and offered services).<a href="#appendix-D.14-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.6">
            <p id="appendix-D.14-1.6.1">Size of challenges 'cnonce' and 'rsnonce'.<a href="#appendix-D.14-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.7">
            <p id="appendix-D.14-1.7.1">Value of 'rsnonce' for reused or non-traditionally-posted tokens.<a href="#appendix-D.14-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.8">
            <p id="appendix-D.14-1.8.1">Removed reference to RFC 7390.<a href="#appendix-D.14-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.9">
            <p id="appendix-D.14-1.9.1">New requirements from draft-ietf-ace-key-groupcomm<a href="#appendix-D.14-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.14-1.10">
            <p id="appendix-D.14-1.10.1">Editorial improvements.<a href="#appendix-D.14-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-D.15">
        <h3 id="name-version-02-to-03">
<a href="#appendix-D.15" class="section-number selfRef">D.15. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.15-1.1">
            <p id="appendix-D.15-1.1.1">New sections, aligned with the interface of ace-key-groupcomm .<a href="#appendix-D.15-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.2">
            <p id="appendix-D.15-1.2.1">Exchange of information on the signature algorithm and related parameters, during the Token POST (Section 4.1).<a href="#appendix-D.15-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.3">
            <p id="appendix-D.15-1.3.1">Nonce 'rsnonce' from the Group Manager to the Client (Section 4.1).<a href="#appendix-D.15-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.4">
            <p id="appendix-D.15-1.4.1">Client PoP signature in the Key Distribution Request upon joining (Section 4.2).<a href="#appendix-D.15-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.5">
            <p id="appendix-D.15-1.5.1">Local actions on the Group Manager, upon a new node's joining (Section 4.2).<a href="#appendix-D.15-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.6">
            <p id="appendix-D.15-1.6.1">Local actions on the Group Manager, upon a node's leaving (Section 12).<a href="#appendix-D.15-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.7">
            <p id="appendix-D.15-1.7.1">IANA registration in ACE Groupcomm Parameters registry.<a href="#appendix-D.15-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.15-1.8">
            <p id="appendix-D.15-1.8.1">More fulfilled profile requirements (Appendix A).<a href="#appendix-D.15-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-D.16">
        <h3 id="name-version-01-to-02">
<a href="#appendix-D.16" class="section-number selfRef">D.16. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.16-1.1">
            <p id="appendix-D.16-1.1.1">Editorial fixes.<a href="#appendix-D.16-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.2">
            <p id="appendix-D.16-1.2.1">Changed: "listener" to "responder"; "pure listener" to "monitor".<a href="#appendix-D.16-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.3">
            <p id="appendix-D.16-1.3.1">Changed profile name to "coap_group_oscore_app", to reflect it is an application profile.<a href="#appendix-D.16-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.4">
            <p id="appendix-D.16-1.4.1">Added the 'type' parameter for all requests to a Join Resource.<a href="#appendix-D.16-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.5">
            <p id="appendix-D.16-1.5.1">Added parameters to indicate the encoding of authentication credentials.<a href="#appendix-D.16-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.6">
            <p id="appendix-D.16-1.6.1">Challenge-response for proof-of-possession of signature keys (Section 4).<a href="#appendix-D.16-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.7">
            <p id="appendix-D.16-1.7.1">Renamed 'key_info' parameter to 'sign_info'; updated its format; extended to include also parameters of the signature key (Section 4.1).<a href="#appendix-D.16-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.8">
            <p id="appendix-D.16-1.8.1">Code 4.00 (Bad request), in responses to joining nodes providing an invalid authentication credential (Section 4.3).<a href="#appendix-D.16-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.9">
            <p id="appendix-D.16-1.9.1">Clarifications on provisioning and checking of authentication credentials (Sections 4 and 6).<a href="#appendix-D.16-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.10">
            <p id="appendix-D.16-1.10.1">Extended discussion on group rekeying and possible different approaches (Section 7).<a href="#appendix-D.16-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.11">
            <p id="appendix-D.16-1.11.1">Extended security considerations: proof-of-possession of signature keys; collision of OSCORE Group Identifiers (Section 8).<a href="#appendix-D.16-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.12">
            <p id="appendix-D.16-1.12.1">Registered three entries in the IANA registry "Sequence Number Synchronization Method" (Section 9).<a href="#appendix-D.16-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.16-1.13">
            <p id="appendix-D.16-1.13.1">Registered one public key encoding in the "ACE Public Key Encoding" IANA registry (Section 9).<a href="#appendix-D.16-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-D.17">
        <h3 id="name-version-00-to-01">
<a href="#appendix-D.17" class="section-number selfRef">D.17. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.17-1.1">
            <p id="appendix-D.17-1.1.1">Changed name of 'req_aud' to 'audience' in the Authorization Request (Section 3.1).<a href="#appendix-D.17-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.17-1.2">
            <p id="appendix-D.17-1.2.1">Added negotiation of signature algorithm/parameters between Client and Group Manager (Section 4).<a href="#appendix-D.17-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.17-1.3">
            <p id="appendix-D.17-1.3.1">Updated format of the Key Distribution Response as a whole (Section 4.3).<a href="#appendix-D.17-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.17-1.4">
            <p id="appendix-D.17-1.4.1">Added parameter 'cs_params' in the 'key' parameter of the Key Distribution Response (Section 4.3).<a href="#appendix-D.17-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.17-1.5">
            <p id="appendix-D.17-1.5.1">New IANA registrations in the "ACE Authorization Server Request Creation Hints" registry, "ACE Groupcomm Key" registry, "OSCORE Security Context Parameters" registry and "ACE Groupcomm Profile" registry (Section 9).<a href="#appendix-D.17-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-acknowledgments">
<section id="appendix-E">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-E-1">Jiye Park contributed as a co-author of initial versions of this document.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">The authors sincerely thank <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Santiago Aragón</span>, <span class="contact-name">Stefan Beck</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Martin Gunnarsson</span>, <span class="contact-name">Rikard Höglund</span>, <span class="contact-name">Watson Ladd</span>, <span class="contact-name">Daniel Migault</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Ludwig Seitz</span>, <span class="contact-name">Göran Selander</span>, and <span class="contact-name">Peter van der Stok</span> for their comments and feedback.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">The work on this document has been partly supported by the Sweden's Innovation Agency VINNOVA and the Celtic-Next projects CRITISEC and CYPRESS; by the H2020 project SIFIS-Home (Grant agreement 952652); and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#appendix-E-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 29 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
